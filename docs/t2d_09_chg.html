<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.592">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Francois Collin">
<meta name="dcterms.date" content="2022-07-01">
<title>T2D: Exercise and Genetic Expression Profile - 3&nbsp; Anthropometrics Changes From Baseline</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./t2d_06_rna.html" rel="next">
<link href="./t2d_08_dmg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="site_libs/tabwid-1.0.0/scrool.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Anthropometrics Changes From Baseline</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">T2D: Exercise and Genetic Expression Profile</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/FCACollin/t2d" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preamble</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_03_bds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Missingness in adlb and advs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_08_dmg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Demographics and Baseline Anthropometrics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_09_chg.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Anthropometrics Changes From Baseline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_06_rna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_07_mir.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_11_wcn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">WGCNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">3.1</span> Introduction</a></li>
  <li><a href="#settings" id="toc-settings" class="nav-link" data-scroll-target="#settings"> <span class="header-section-number">3.2</span> Settings</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"> <span class="header-section-number">3.3</span> Data</a></li>
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions"> <span class="header-section-number">3.4</span> Helper functions</a></li>
  <li><a href="#tab-09-01---ancova---anthropometrics-changes-from-baseline-by-diabetes-group" id="toc-tab-09-01---ancova---anthropometrics-changes-from-baseline-by-diabetes-group" class="nav-link" data-scroll-target="#tab-09-01---ancova---anthropometrics-changes-from-baseline-by-diabetes-group"> <span class="header-section-number">3.5</span> Tab 09 01 - Ancova - Anthropometrics Changes from Baseline by Diabetes Group</a></li>
  <li><a href="#example-glucose-120---fig-09-01" id="toc-example-glucose-120---fig-09-01" class="nav-link" data-scroll-target="#example-glucose-120---fig-09-01"> <span class="header-section-number">3.6</span> Example: Glucose 120 - Fig 09 01</a></li>
  <li><a href="#session-informations" id="toc-session-informations" class="nav-link" data-scroll-target="#session-informations"> <span class="header-section-number">3.7</span> Session Informations</a></li>
  <li><a href="#untidied-information-about-analysis-of-change-from-baseline" id="toc-untidied-information-about-analysis-of-change-from-baseline" class="nav-link" data-scroll-target="#untidied-information-about-analysis-of-change-from-baseline"> <span class="header-section-number">3.8</span> Untidied information about analysis of change from baseline</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/FCACollin/t2d/edit/main/t2d_09_chg.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Anthropometrics Changes From Baseline</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Program 09</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Francois Collin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 1, 2022</p>
    </div>
  </div>
    
  </div>
  

</header><section id="introduction" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">3.1</span> Introduction</h2>
<p>Diabetes group estimations in anthropometrics changes from baseline were obtained and tested by analysis of covariance models (Ancova), relying once more on the Fisher test; to increase accuracy and statistical power, estimations were adjusted for baseline values <span class="citation" data-cites="Vickers2001 VanBreukelen2006 CHMP2015 OConnell2017">(<a href="references.html#ref-Vickers2001" role="doc-biblioref">Vickers 2001</a>; <a href="references.html#ref-VanBreukelen2006" role="doc-biblioref">Van Breukelen 2006</a>; <a href="references.html#ref-CHMP2015" role="doc-biblioref">Committee for Medicinal Products for Human Use (CHMP) 2015</a>; <a href="references.html#ref-OConnell2017" role="doc-biblioref">O’Connell et al. 2017</a>)</span>.</p>
<p>The analysis was realized with R <span class="citation" data-cites="RCT2022">(v4.2.0, <a href="references.html#ref-RCT2022" role="doc-biblioref">R Core Team 2022</a>)</span>. Note the use of the additional packages downloaded from the RStudio package manager repository (freeze date 2022-05-04, <a href="https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU">repos</a>):</p>
<ul>
<li>
<code>car</code> for regression model test <span class="citation" data-cites="Fox2019">(version 3.0-13, <a href="references.html#ref-Fox2019" role="doc-biblioref">Fox and Weisberg 2019</a>)</span>
</li>
<li>
<code>emmeans</code> for least-Squares Means (LSM) estimations <span class="citation" data-cites="Lenth2022">(version 1.7.3, <a href="references.html#ref-Lenth2022" role="doc-biblioref">Lenth 2022</a>)</span>
</li>
<li>
<code>flextable</code> for output table formatting <span class="citation" data-cites="Gohel2022">(version 0.7.0, <a href="references.html#ref-Gohel2022" role="doc-biblioref">Gohel 2022</a>)</span>
</li>
<li>
<code>tidyr</code> for data wrangling <span class="citation" data-cites="Wickham2022">(version 1.2.0, <a href="references.html#ref-Wickham2022" role="doc-biblioref">Wickham and Girlich 2022</a>)</span>.</li>
</ul></section><section id="settings" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="settings">
<span class="header-section-number">3.2</span> Settings</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">cfg_prog</span> <span class="op">&lt;-</span> <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html">read_yaml</a></span><span class="op">(</span><span class="st">"_prog.yml"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/dbs.data"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading dbs.data</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/latarnia.utils"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading latarnia.utils</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: shiny</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/inches.R"</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>results <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">knitr</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="data">
<span class="header-section-number">3.3</span> Data</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adsl</span>
<span class="va">advs</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">advs</span>
<span class="va">adlb</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adlb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ads</span> <span class="op">&lt;-</span> <span class="va">adlb</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">advs</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">basetype</span> <span class="op">==</span> <span class="st">""</span> <span class="op">&amp;</span> <span class="va">avisit</span> <span class="op">!=</span> <span class="st">"Baseline"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">subjid</span>, <span class="va">paramcd</span>, <span class="va">avisit</span>, <span class="va">base</span>, <span class="va">chg</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">adsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"subjid"</span>, <span class="st">"diabcd"</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">x</span>, by <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span>, <span class="va">fct</span> <span class="op">=</span> <span class="st">"diabcd"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">fct</span>, <span class="st">"_n"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">factor_n</span><span class="op">(</span><span class="va">df</span>, <span class="va">fct</span>, id <span class="op">=</span> <span class="st">"subjid"</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>
    <span class="va">df</span>
  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ads</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="helper-functions" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="helper-functions">
<span class="header-section-number">3.4</span> Helper functions</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">format_pval</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
    test <span class="op">=</span> <span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.0001</span>,
    yes <span class="op">=</span> <span class="st">"&lt;0.0001"</span>,
    no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
      test <span class="op">=</span> <span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.001</span>,
      yes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
      no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
        test <span class="op">=</span> <span class="va">p</span> <span class="op">&lt;</span> <span class="fl">0.01</span>,
        yes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
        no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span>, nsmall <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">lm_by_paramcd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,
                          <span class="va">dep_var</span> <span class="op">=</span> <span class="st">"aval"</span>,
                          <span class="va">indep_var</span> <span class="op">=</span> <span class="st">"diabcd_n"</span>,
                          <span class="va">covariate</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>
    <span class="va">dep_var</span>, <span class="st">"~"</span>, 
    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">covariate</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">covariate</span>, <span class="st">"+"</span><span class="op">)</span>,
    <span class="va">indep_var</span>
  <span class="op">)</span>
  <span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">x</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span>, lm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">make_specs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">var</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"~"</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span>
<span class="va">lsm_by_param</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">indep_var</span> <span class="op">=</span> <span class="st">"diabcd_n"</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="va">x</span>,
    \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">mod_em</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/emmeans/man/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">lm</span>, specs <span class="op">=</span> <span class="fu">make_specs</span><span class="op">(</span><span class="va">indep_var</span><span class="op">)</span><span class="op">)</span>
      <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">mod_em</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
        paramcd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">paramcd</span><span class="op">)</span>,
        <span class="va">y</span>,
        diabcd_f <span class="op">=</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">lm</span><span class="op">)</span><span class="op">[</span><span class="va">indep_var</span>, <span class="st">"Pr(&gt;F)"</span><span class="op">]</span>
      <span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="tab-09-01---ancova---anthropometrics-changes-from-baseline-by-diabetes-group" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="tab-09-01---ancova---anthropometrics-changes-from-baseline-by-diabetes-group">
<span class="header-section-number">3.5</span> Tab 09 01 - Ancova - Anthropometrics Changes from Baseline by Diabetes Group</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">tab_09_01_raw</span> <span class="op">&lt;-</span> <span class="va">ads</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">x</span>, f <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">paramcd</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">lm_by_paramcd</span><span class="op">(</span>dep_var <span class="op">=</span> <span class="st">"chg"</span>, covariate <span class="op">=</span> <span class="st">"base"</span>, indep_var <span class="op">=</span> <span class="st">"diabcd_n"</span><span class="op">)</span> |&gt;
  <span class="fu">lsm_by_param</span><span class="op">(</span>indep_var <span class="op">=</span> <span class="st">"diabcd_n"</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span>

<span class="va">tab_09_01</span> <span class="op">&lt;-</span> <span class="va">tab_09_01_raw</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diabcd_n</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">emmean</span>, <span class="fl">3</span><span class="op">)</span>,
      <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">lower.CL</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">upper.CL</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">")"</span>
    <span class="op">)</span>
    <span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu">format_pval</span><span class="op">(</span><span class="va">diabcd_f</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> |&gt;
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>
    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"paramcd"</span>, <span class="st">"pval"</span>, <span class="st">"diabcd_f"</span><span class="op">)</span>,
    values_from <span class="op">=</span> <span class="st">"val"</span>,
    names_from <span class="op">=</span> <span class="st">"diabcd_n"</span>
  <span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">diabcd_f</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span>
<span class="va">tab_09_01</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/flextable-book/">flextable</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'flextable'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:latarnia.utils':

    add_footer, add_header</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">wrap_line</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span><span class="va">x</span>, width <span class="op">=</span> <span class="fl">80</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>
<span class="va">tab_09_01_ft</span> <span class="op">&lt;-</span> <span class="va">tab_09_01</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="va">diabcd_f</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/autofit.html">autofit</a></span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/footnote.html">footnote</a></span><span class="op">(</span>
    part <span class="op">=</span> <span class="st">"header"</span>,
    i <span class="op">=</span> <span class="fl">1</span>, j <span class="op">=</span> <span class="fl">2</span>,
    value <span class="op">=</span> <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/as_paragraph.html">as_paragraph</a></span><span class="op">(</span>
      <span class="st">"Note: pval, p value of diabetes group effect test by F test."</span>
    <span class="op">)</span>,
    ref_symbols <span class="op">=</span> <span class="st">"a"</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_footer_lines.html">add_footer_lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fu">wrap_line</span><span class="op">(</span><span class="st">"Source: Full Analysis Set, observed cases at baseline and post
    intervention."</span><span class="op">)</span>,
    <span class="st">"Note: rows are ordered by increasing p values, most significant on top."</span>
  <span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header_lines.html">add_header_lines</a></span><span class="op">(</span><span class="st">"Analysis Set: Full Analysis Set - Observed Cases"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/set_caption.html">set_caption</a></span><span class="op">(</span>
    caption <span class="op">=</span>  <span class="fu">wrap_long_lines</span><span class="op">(</span>
      <span class="st">"Tab 09 01 - Analysis of Covariance / Least Means Square estimations of
      Anthropometrics Changes from Baseline by Diagnosis Group at
      Month 3 (95% Confidence Interval) Adjusted for Baseline"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/theme_booktabs.html">theme_booktabs</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tab_09_01_ft</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">bnm</span> <span class="op">&lt;-</span> <span class="st">"tab_09_01"</span>
<span class="va">dir_tab</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">tab</span>
<span class="va">dir_dta</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">dta</span>

<span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_tab</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">bnm</span>, <span class="st">"_ft.RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"[output] Table saved as "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">tab_09_01_ft</span>, file <span class="op">=</span> <span class="va">.</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[output] Table saved as ../tlg/tables/tab_09_01_ft.RData</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_dta</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">bnm</span>, <span class="st">".RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"[output] Table saved as "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">tab_09_01</span>, file <span class="op">=</span> <span class="va">.</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[output] Table saved as ../data/tab_09_01.RData</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_tab</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">bnm</span>, sep <span class="op">=</span> <span class="st">"."</span>, <span class="st">"docx"</span><span class="op">)</span><span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"[output] Table saved as "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/save_as_docx.html">save_as_docx</a></span><span class="op">(</span><span class="va">tab_09_01_ft</span>, path <span class="op">=</span> <span class="va">.</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[output] Table saved as ../tlg/tables/tab_09_01.docx</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_tab</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">bnm</span>, sep <span class="op">=</span> <span class="st">"."</span>, <span class="st">"html"</span><span class="op">)</span><span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"[output] Table saved as "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/save_as_html.html">save_as_html</a></span><span class="op">(</span><span class="va">tab_09_01_ft</span>, path <span class="op">=</span> <span class="va">.</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[output] Table saved as ../tlg/tables/tab_09_01.html</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">dir_dta</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">bnm</span>, sep <span class="op">=</span> <span class="st">"."</span>, <span class="st">"csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">%T&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"[output] Table saved as "</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">tab_09_01</span>, file <span class="op">=</span> <span class="va">.</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[output] Table saved as ../data/tab_09_01.csv</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/detach.html">detach</a></span><span class="op">(</span><span class="va">package</span><span class="op">:</span><span class="va">flextable</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="example-glucose-120---fig-09-01" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="example-glucose-120---fig-09-01">
<span class="header-section-number">3.6</span> Example: Glucose 120 - Fig 09 01</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adlb</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>
    <span class="va">paramcd</span> <span class="op">==</span> <span class="st">"GLU120"</span> <span class="op">&amp;</span>
      <span class="va">dtype</span> <span class="op">==</span> <span class="st">""</span> <span class="op">&amp;</span>
      <span class="va">avisit</span> <span class="op">==</span> <span class="st">"Month 3"</span> <span class="op">&amp;</span>
      <span class="va">basetype</span> <span class="op">==</span> <span class="st">""</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">adsl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"subjid"</span>, <span class="st">"diabcd"</span><span class="op">)</span><span class="op">]</span>, y <span class="op">=</span> _, by <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span>

<span class="va">dta</span><span class="op">$</span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">aval</span> <span class="op">~</span> <span class="va">base</span>, data <span class="op">=</span> <span class="va">dta</span><span class="op">)</span><span class="op">)</span>
<span class="va">lim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dta</span><span class="op">$</span><span class="va">aval</span>, <span class="va">dta</span><span class="op">$</span><span class="va">base</span><span class="op">)</span><span class="op">)</span>

<span class="va">gg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">base</span>, <span class="va">aval</span>, color <span class="op">=</span> <span class="va">diabcd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Post exercise intervention"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Baseline"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="va">base</span>, yend <span class="op">=</span> <span class="va">lm_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">.1</span>, end <span class="op">=</span> <span class="fl">.9</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lim</span>, ylim <span class="op">=</span> <span class="va">lim</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span>

<span class="va">gg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dta</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">base</span>, fill <span class="op">=</span> <span class="va">diabcd</span>, color <span class="op">=</span> <span class="va">diabcd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="va">lim</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"diabcd"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">.1</span>, end <span class="op">=</span> <span class="fl">.9</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">.1</span>, end <span class="op">=</span> <span class="fl">.9</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    legend.position <span class="op">=</span> <span class="st">"top"</span>,
    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>
  <span class="va">gg1</span>, <span class="va">gg2</span>,
  nrow <span class="op">=</span> <span class="fl">2</span>,
  align <span class="op">=</span> <span class="st">"v"</span>,
  rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.15</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header.html">add_header</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 9.1"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Scatter plot - Glucose 120 at Month 3 in relation to Baseline by
        treatment group"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set - Observed Cases"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">5.5</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">4.5</span><span class="op">)</span><span class="op">)</span>|&gt;
  <span class="fu">add_note</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"Note: the table prog 08 output 01 focuses on the x-axis and check for
     differences at baseline, the boxplots gives an overview of these
     baseline variation."</span>,
    <span class="st">"Note: the table tab prog 09 output 01 shows the effect of exercise in
     each group. The p.values is provided and accounts for the diagnostic group
     effect, while taking into account the fact that the higher the value at
     baseline, the higher after the exercise intervention. Actually, 
     the analysis of covariance model focus on how much above or below the
     general regression (black line) is positionned a diagnosis group.
     E.g., +20 for T2D indicates that the result after exercise is 20 units
     higher than expected if there were no diagnostic group effect; ... however,
     the confidence interval extend from -13.5 and +53.8 which means that
     i) if we repeated the study, 100 times, it would result 95 times from
     -13.5 to 53.8
     ii) the interval includes 0 so we can't conclude to a significant
     increase or decrease in Glucose 120 due to the exercise intervention."</span>
  <span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_footer.html">add_footer</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_09_chg / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span>

<span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_09_01.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_09_01_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_09_01.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_09_01_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="session-informations" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="session-informations">
<span class="header-section-number">3.7</span> Session Informations</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="untidied-information-about-analysis-of-change-from-baseline" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="untidied-information-about-analysis-of-change-from-baseline">
<span class="header-section-number">3.8</span> Untidied information about analysis of change from baseline</h2>
<p><em>Questions: for the analysis of a post-treatment values, should we analyse the change from baseline or percentage change from baseline? Should we adjust for the baseline?</em></p>
<p>Back to 2003, in the context of randomized clinical trial, the European Medicines Agency <span class="citation" data-cites="CPMP2003">(<a href="references.html#ref-CPMP2003" role="doc-biblioref">COMMITTEE FOR PROPRIETARY MEDICINAL PRODUCTS 2003</a>)</span>, when the endpoint is studied as a change from baseline, the adjustment for baseline improves the accuracy in comparison to non-baseline adjustment; estimates becomes also equivalent to the standard linear model, the choice of change from baseline analysis or raw value is then only a question of interpretability. They renewed the recommendation in 2015 <span class="citation" data-cites="CHMP2015">(<a href="references.html#ref-CHMP2015" role="doc-biblioref">Committee for Medicinal Products for Human Use (CHMP) 2015</a>)</span>.</p>
<p>From the academic side, the topic was repeatedly studied:</p>
<ul>
<li><p><span class="citation" data-cites="VanBreukelen2006">Van Breukelen (<a href="references.html#ref-VanBreukelen2006" role="doc-biblioref">2006</a>)</span>: &gt; <em>“In randomized studies both methods [Anova, no BL adjustment vs Ancova] &gt; are unbiased, but ANCOVA has more power”</em></p></li>
<li><p><span class="citation" data-cites="Liu2009">Liu et al. (<a href="references.html#ref-Liu2009" role="doc-biblioref">2009</a>)</span> also highlighted the benefits of adjustment for baseline as a covariate.</p></li>
<li><p>this was later confirmed by <span class="citation" data-cites="Zhang2014">Zhang et al. (<a href="references.html#ref-Zhang2014" role="doc-biblioref">2014</a>)</span>.</p></li>
<li><p>More recently <span class="citation" data-cites="OConnell2017">O’Connell et al. (<a href="references.html#ref-OConnell2017" role="doc-biblioref">2017</a>)</span> also defended the superiority of the Ancova-change: <span class="math inline">\(y_i = \beta_0 + \beta_1 X_i + \beta_2 Y_{0i,=BL} + \varepsilon_i\)</span></p></li>
</ul>
<blockquote class="blockquote">
<p>_“Consistent with existing literature, our results demonstrate that each method leads to unbiased treatment effect estimates, and based on precision of estimates, 95% coverage probability, and power, ANCOVA modeling of either change scores or post-treatment score as the outcome, prove to be the most effective._”</p>
</blockquote>
<p>Most of the authors above are specifically working on randomized trial, <span class="citation" data-cites="Vickers2001">Vickers (<a href="references.html#ref-Vickers2001" role="doc-biblioref">2001</a>)</span> also brought some light on the topic, and highlighted in addition that: working with percentage change is generally a bad idea. The extended to a theoretical works also indicated that the percentage change from baseline <em>“will also fail to protect from bias in the case of baseline imbalance and will lead to an excess of trials with non-normally distributed outcome data”</em>.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-CHMP2015" class="csl-entry" role="doc-biblioentry">
Committee for Medicinal Products for Human Use (CHMP). 2015. <span>“Guideline on Adjustment for Baseline Covariates in Clinical Trials.”</span> European Medicines Agency. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-adjustment-baseline-covariates-clinical-trials_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-adjustment-baseline-covariates-clinical-trials_en.pdf</a>.
</div>
<div id="ref-CPMP2003" class="csl-entry" role="doc-biblioentry">
COMMITTEE FOR PROPRIETARY MEDICINAL PRODUCTS. 2003. <span>“POINTS TO CONSIDER ON ADJUSTMENT FOR BASELINE COVARIATES.”</span> The European Agency for the Evaluation of Medicinal Products Evaluation of Medicines for Human Use. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/points-consider-adjustment-baseline-covariates_en.pdf">https://www.ema.europa.eu/en/documents/scientific-guideline/points-consider-adjustment-baseline-covariates_en.pdf</a>.
</div>
<div id="ref-Fox2019" class="csl-entry" role="doc-biblioentry">
Fox, John, and Sanford Weisberg. 2019. <em>An <span>R</span> Companion to Applied Regression</em>. Third. Thousand Oaks <span>CA</span>: Sage. <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/">https://socialsciences.mcmaster.ca/jfox/Books/Companion/</a>.
</div>
<div id="ref-Gohel2022" class="csl-entry" role="doc-biblioentry">
Gohel, David. 2022. <em>Flextable: Functions for Tabular Reporting</em>.
</div>
<div id="ref-Lenth2022" class="csl-entry" role="doc-biblioentry">
Lenth, Russell V. 2022. <em>Emmeans: Estimated Marginal Means, Aka Least-Squares Means</em>. <a href="https://github.com/rvlenth/emmeans">https://github.com/rvlenth/emmeans</a>.
</div>
<div id="ref-Liu2009" class="csl-entry" role="doc-biblioentry">
Liu, Guanghan F, Kaifeng Lu, Robin Mogg, Madhuja Mallick, and Devan V Mehrotra. 2009. <span>“Should Baseline Be a Covariate or Dependent Variable in Analyses of Change from Baseline in Clinical Trials?”</span> <em>Statistics in Medicine</em> 28 (20): 2509–30. <a href="https://doi.org/10.1002/sim.3639">https://doi.org/10.1002/sim.3639</a>.
</div>
<div id="ref-OConnell2017" class="csl-entry" role="doc-biblioentry">
O’Connell, Nathaniel S, Lin Dai, Yunyun Jiang, Jaime L Speiser, Ralph Ward, Wei Wei, Rachel Carroll, and Mulugeta Gebregziabher. 2017. <span>“Methods for Analysis of Pre-Post Data in Clinical Research: A Comparison of Five Common Methods.”</span> <em>Journal of Biometrics &amp; Biostatistics</em> 8 (1): 1. <a href="https://doi.org/10.4172/2155-6180.1000334">https://doi.org/10.4172/2155-6180.1000334</a>.
</div>
<div id="ref-RCT2022" class="csl-entry" role="doc-biblioentry">
R Core Team. 2022. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-VanBreukelen2006" class="csl-entry" role="doc-biblioentry">
Van Breukelen, G. 2006. <span>“ANCOVA Versus Change from Baseline: More Power Inrandomized Studies, More Bias in Nonrandomized Studies.”</span> <em>Journal of ClinicalEpidemiology</em>, 59–920. <a href="https://doi.org/10.1016/j.jclinepi.2006.02.007">https://doi.org/10.1016/j.jclinepi.2006.02.007</a>.
</div>
<div id="ref-Vickers2001" class="csl-entry" role="doc-biblioentry">
Vickers, Andrew J. 2001. <span>“The Use of Percentage Change from Baseline as an Outcome in a Controlled Trial Is Statistically Inefficient: A Simulation Study.”</span> <em>BMC Medical Research Methodology</em> 1 (1): 1–4. <a href="https://doi.org/10.1186/1471-2288-1-6">https://doi.org/10.1186/1471-2288-1-6</a>.
</div>
<div id="ref-Wickham2022" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley, and Maximilian Girlich. 2022. <em>Tidyr: Tidy Messy Dataversion</em>.
</div>
<div id="ref-Zhang2014" class="csl-entry" role="doc-biblioentry">
Zhang, Shiyuan, James Paul, Manyat Nantha-Aree, Norman Buckley, Uswa Shahzad, Ji Cheng, Justin DeBeer, et al. 2014. <span>“Empirical Comparison of Four Baseline Covariate Adjustment Methods in Analysis of Continuous Outcomes in Randomized Controlled Trials.”</span> <em>Clinical Epidemiology</em> 6: 227. <a href="https://doi.org/10.2147/clep.s56554">https://doi.org/10.2147/clep.s56554</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./t2d_08_dmg.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Demographics and Baseline Anthropometrics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./t2d_06_rna.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Anthropometrics Changes From Baseline"</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Program 09</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Francois Collin"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%Y-%m-%d')`"</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>Diabetes group estimations in anthropometrics changes from baseline were</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>obtained and tested by analysis of covariance models (Ancova), relying once</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>more on the Fisher test; to increase accuracy and statistical power,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>estimations were adjusted for baseline values</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@Vickers2001; @VanBreukelen2006; @CHMP2015; @OConnell2017</span><span class="co">]</span>.</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>The analysis was realized with R <span class="co">[</span><span class="ot">v4.2.0, @RCT2022</span><span class="co">]</span>. Note the</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>use of the additional packages downloaded from the RStudio package manager</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>repository (freeze date 2022-05-04, <span class="co">[</span><span class="ot">repos</span><span class="co">]</span>(</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU)):</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`car`</span> for regression model test <span class="co">[</span><span class="ot">version 3.0-13, @Fox2019</span><span class="co">]</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`emmeans`</span> for least-Squares Means (LSM) estimations <span class="co">[</span><span class="ot">version 1.7.3, @Lenth2022</span><span class="co">]</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`flextable`</span> for output table formatting <span class="co">[</span><span class="ot">version 0.7.0, @Gohel2022</span><span class="co">]</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`tidyr`</span> for data wrangling <span class="co">[</span><span class="ot">version 1.2.0, @Wickham2022</span><span class="co">]</span>.</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Settings</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, settings}</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>cfg_prog <span class="ot">&lt;-</span> yaml<span class="sc">::</span><span class="fu">read_yaml</span>(<span class="st">"_prog.yml"</span>)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/dbs.data"</span>)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/latarnia.utils"</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/inches.R"</span>)</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">results =</span> cfg_prog<span class="sc">$</span>knitr<span class="sc">$</span>results)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, adam}</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adsl</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>advs <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>advs</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>adlb <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adlb</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, ads}</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>ads <span class="ot">&lt;-</span> adlb <span class="sc">|&gt;</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(advs) <span class="sc">|&gt;</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(basetype <span class="sc">==</span> <span class="st">""</span> <span class="sc">&amp;</span> avisit <span class="sc">!=</span> <span class="st">"Baseline"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(subjid, paramcd, avisit, base, chg)) <span class="sc">|&gt;</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>  (\(x) <span class="fu">merge</span>(<span class="at">x =</span> adsl[<span class="fu">c</span>(<span class="st">"subjid"</span>, <span class="st">"diabcd"</span>)], <span class="at">y =</span> x, <span class="at">by =</span> <span class="st">"subjid"</span>))() <span class="sc">|&gt;</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  (\(df, <span class="at">fct =</span> <span class="st">"diabcd"</span>) {</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>    df[<span class="fu">paste0</span>(fct, <span class="st">"_n"</span>)] <span class="ot">&lt;-</span> <span class="fu">factor_n</span>(df, fct, <span class="at">id =</span> <span class="st">"subjid"</span>, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>  })()</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ads)</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## Helper functions</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, extra_functions}</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>format_pval <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">round</span>(x, <span class="dv">5</span>)</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> p <span class="sc">&lt;</span> <span class="fl">0.0001</span>,</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">yes =</span> <span class="st">"&lt;0.0001"</span>,</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">no =</span> <span class="fu">ifelse</span>(</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">test =</span> p <span class="sc">&lt;</span> <span class="fl">0.001</span>,</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">yes =</span> <span class="fu">format</span>(<span class="fu">round</span>(p, <span class="dv">4</span>), <span class="at">nsmall =</span> <span class="dv">4</span>),</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">no =</span> <span class="fu">ifelse</span>(</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> p <span class="sc">&lt;</span> <span class="fl">0.01</span>,</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">yes =</span> <span class="fu">format</span>(<span class="fu">round</span>(p, <span class="dv">3</span>), <span class="at">nsmall =</span> <span class="dv">3</span>),</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>        <span class="at">no =</span> <span class="fu">format</span>(<span class="fu">round</span>(p, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>)</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>lm_by_paramcd <span class="ot">&lt;-</span> <span class="cf">function</span>(x,</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dep_var =</span> <span class="st">"aval"</span>,</span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>                          <span class="at">indep_var =</span> <span class="st">"diabcd_n"</span>,</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>                          <span class="at">covariate =</span> <span class="cn">NULL</span>) {</span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>    dep_var, <span class="st">"~"</span>, </span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(covariate)) <span class="fu">paste</span>(covariate, <span class="st">"+"</span>),</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>    indep_var</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(formula)</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(x, \(x) <span class="fu">list</span>(<span class="at">data =</span> x, <span class="at">lm =</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> x)))</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>make_specs <span class="ot">&lt;-</span> <span class="cf">function</span>(var) <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, var))</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>lsm_by_param <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">indep_var =</span> <span class="st">"diabcd_n"</span>) {</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(</span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>    \(x) {</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>      mod_em <span class="ot">&lt;-</span> emmeans<span class="sc">::</span><span class="fu">emmeans</span>(x<span class="sc">$</span>lm, <span class="at">specs =</span> <span class="fu">make_specs</span>(indep_var))</span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod_em)</span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cbind</span>(</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>        <span class="at">paramcd =</span> <span class="fu">unique</span>(x<span class="sc">$</span>data<span class="sc">$</span>paramcd),</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>        y,</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">diabcd_f =</span> car<span class="sc">::</span><span class="fu">Anova</span>(x<span class="sc">$</span>lm)[indep_var, <span class="st">"Pr(&gt;F)"</span>]</span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tab 09 01 - Ancova - Anthropometrics Changes from Baseline by Diabetes Group</span></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>tab_09_01_raw <span class="ot">&lt;-</span> ads <span class="sc">|&gt;</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>  (\(x) <span class="fu">split</span>(x, <span class="at">f =</span> x<span class="sc">$</span>paramcd))() <span class="sc">|&gt;</span></span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm_by_paramcd</span>(<span class="at">dep_var =</span> <span class="st">"chg"</span>, <span class="at">covariate =</span> <span class="st">"base"</span>, <span class="at">indep_var =</span> <span class="st">"diabcd_n"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lsm_by_param</span>(<span class="at">indep_var =</span> <span class="st">"diabcd_n"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a>  (\(x) <span class="fu">Reduce</span>(rbind, x))()</span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a>tab_09_01 <span class="ot">&lt;-</span> tab_09_01_raw <span class="sc">|&gt;</span></span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a>  (\(df) df[<span class="fu">order</span>(df<span class="sc">$</span>diabcd_n), ])() <span class="sc">|&gt;</span></span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a>      <span class="fu">signif</span>(emmean, <span class="dv">3</span>),</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a>      <span class="st">" ("</span>, <span class="fu">signif</span>(lower.CL, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">signif</span>(upper.CL, <span class="dv">3</span>), <span class="st">")"</span></span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a>    pval <span class="ot">&lt;-</span> <span class="fu">format_pval</span>(diabcd_f)</span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a>  }) <span class="sc">|&gt;</span></span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">"paramcd"</span>, <span class="st">"pval"</span>, <span class="st">"diabcd_f"</span>),</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">"val"</span>,</span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">"diabcd_n"</span></span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a>  (\(x) x[<span class="fu">order</span>(x<span class="sc">$</span>diabcd_f), ])()</span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a>tab_09_01</span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a>wrap_line <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">paste</span>(<span class="fu">strwrap</span>(x, <span class="at">width =</span> <span class="dv">80</span>), <span class="at">collapse =</span> <span class="st">" "</span>)</span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a>tab_09_01_ft <span class="ot">&lt;-</span> tab_09_01 <span class="sc">|&gt;</span></span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>diabcd_f) <span class="sc">|&gt;</span></span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(</span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">part =</span> <span class="st">"header"</span>,</span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span>, <span class="at">j =</span> <span class="dv">2</span>,</span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">as_paragraph</span>(</span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Note: pval, p value of diabetes group effect test by F test."</span></span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref_symbols =</span> <span class="st">"a"</span></span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_lines</span>(<span class="fu">c</span>(</span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wrap_line</span>(<span class="st">"Source: Full Analysis Set, observed cases at baseline and post</span></span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a><span class="st">    intervention."</span>),</span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Note: rows are ordered by increasing p values, most significant on top."</span></span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_lines</span>(<span class="st">"Analysis Set: Full Analysis Set - Observed Cases"</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(</span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span>  <span class="fu">wrap_long_lines</span>(</span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Tab 09 01 - Analysis of Covariance / Least Means Square estimations of</span></span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a><span class="st">      Anthropometrics Changes from Baseline by Diagnosis Group at</span></span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a><span class="st">      Month 3 (95% Confidence Interval) Adjusted for Baseline"</span></span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>()</span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a>tab_09_01_ft</span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a>bnm <span class="ot">&lt;-</span> <span class="st">"tab_09_01"</span></span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a>dir_tab <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>tab</span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a>dir_dta <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>dta</span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(dir_tab, <span class="fu">paste0</span>(bnm, <span class="st">"_ft.RData"</span>)) <span class="sc">%T&gt;%</span></span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"[output] Table saved as "</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(tab_09_01_ft, <span class="at">file =</span> .)</span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(dir_dta, <span class="fu">paste0</span>(bnm, <span class="st">".RData"</span>)) <span class="sc">%T&gt;%</span></span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"[output] Table saved as "</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save</span>(tab_09_01, <span class="at">file =</span> .)</span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(dir_tab, <span class="fu">paste</span>(bnm, <span class="at">sep =</span> <span class="st">"."</span>, <span class="st">"docx"</span>)) <span class="sc">%T&gt;%</span></span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"[output] Table saved as "</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save_as_docx</span>(tab_09_01_ft, <span class="at">path =</span> .)</span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(dir_tab, <span class="fu">paste</span>(bnm, <span class="at">sep =</span> <span class="st">"."</span>, <span class="st">"html"</span>)) <span class="sc">%T&gt;%</span></span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"[output] Table saved as "</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">save_as_html</span>(tab_09_01_ft, <span class="at">path =</span> .)</span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a><span class="fu">file.path</span>(dir_dta, <span class="fu">paste</span>(bnm, <span class="at">sep =</span> <span class="st">"."</span>, <span class="st">"csv"</span>)) <span class="sc">%T&gt;%</span></span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"[output] Table saved as "</span>, .) <span class="sc">%&gt;%</span></span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(tab_09_01, <span class="at">file =</span> ., <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>flextable)</span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example: Glucose 120 - Fig 09 01</span></span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f09_01}</span></span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adlb <span class="sc">|&gt;</span></span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(</span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a>    paramcd <span class="sc">==</span> <span class="st">"GLU120"</span> <span class="sc">&amp;</span></span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a>      dtype <span class="sc">==</span> <span class="st">""</span> <span class="sc">&amp;</span></span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a>      avisit <span class="sc">==</span> <span class="st">"Month 3"</span> <span class="sc">&amp;</span></span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>      basetype <span class="sc">==</span> <span class="st">""</span></span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(<span class="at">x =</span> adsl[<span class="fu">c</span>(<span class="st">"subjid"</span>, <span class="st">"diabcd"</span>)], <span class="at">y =</span> _, <span class="at">by =</span> <span class="st">"subjid"</span>)</span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a>dta<span class="sc">$</span>lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(aval <span class="sc">~</span> base, <span class="at">data =</span> dta))</span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a>lim <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(dta<span class="sc">$</span>aval, dta<span class="sc">$</span>base))</span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dta, <span class="fu">aes</span>(base, aval, <span class="at">color =</span> diabcd)) <span class="sc">+</span></span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Post exercise intervention"</span>) <span class="sc">+</span></span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Baseline"</span>) <span class="sc">+</span></span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> base, <span class="at">yend =</span> lm_pred)) <span class="sc">+</span> </span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">begin =</span> .<span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> lim, <span class="at">ylim =</span> lim) <span class="sc">+</span></span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a>gg2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dta, <span class="fu">aes</span>(base, <span class="at">fill =</span> diabcd, <span class="at">color =</span> diabcd)) <span class="sc">+</span></span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> lim) <span class="sc">+</span></span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"diabcd"</span>) <span class="sc">+</span></span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">begin =</span> .<span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> .<span class="dv">1</span>, <span class="at">end =</span> .<span class="dv">9</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>  gg1, gg2,</span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"v"</span>,</span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">15</span>)</span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 9.1"</span>,</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Scatter plot - Glucose 120 at Month 3 in relation to Baseline by</span></span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a><span class="st">        treatment group"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set - Observed Cases"</span></span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="fl">5.5</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="fl">4.5</span>))<span class="sc">|&gt;</span></span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_note</span>(<span class="fu">c</span>(</span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Note: the table prog 08 output 01 focuses on the x-axis and check for</span></span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a><span class="st">     differences at baseline, the boxplots gives an overview of these</span></span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a><span class="st">     baseline variation."</span>,</span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Note: the table tab prog 09 output 01 shows the effect of exercise in</span></span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a><span class="st">     each group. The p.values is provided and accounts for the diagnostic group</span></span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a><span class="st">     effect, while taking into account the fact that the higher the value at</span></span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a><span class="st">     baseline, the higher after the exercise intervention. Actually, </span></span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a><span class="st">     the analysis of covariance model focus on how much above or below the</span></span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a><span class="st">     general regression (black line) is positionned a diagnosis group.</span></span>
<span id="cb34-280"><a href="#cb34-280" aria-hidden="true" tabindex="-1"></a><span class="st">     E.g., +20 for T2D indicates that the result after exercise is 20 units</span></span>
<span id="cb34-281"><a href="#cb34-281" aria-hidden="true" tabindex="-1"></a><span class="st">     higher than expected if there were no diagnostic group effect; ... however,</span></span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a><span class="st">     the confidence interval extend from -13.5 and +53.8 which means that</span></span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a><span class="st">     i) if we repeated the study, 100 times, it would result 95 times from</span></span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a><span class="st">     -13.5 to 53.8</span></span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a><span class="st">     ii) the interval includes 0 so we can't conclude to a significant</span></span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a><span class="st">     increase or decrease in Glucose 120 due to the exercise intervention."</span></span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_09_chg / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_09_01.pdf"</span>),</span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_09_01_af.pdf"</span>)</span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f09_01_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-309"><a href="#cb34-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-310"><a href="#cb34-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Informations</span></span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a><span class="fu">## Untidied information about analysis of change from baseline</span></span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a>_Questions:</span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a>for the analysis of a post-treatment values, should we analyse the change</span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a>from baseline or percentage change from baseline? Should we adjust for the</span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a>baseline?_</span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a>Back to 2003, in the context of randomized clinical trial, </span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a>the European Medicines Agency <span class="co">[</span><span class="ot">@CPMP2003</span><span class="co">]</span>,</span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a>when the endpoint is studied as a change from</span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a>baseline, the adjustment for baseline improves the accuracy in comparison</span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a>to non-baseline adjustment; estimates becomes also equivalent to the standard</span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a>linear model, the choice of change from baseline analysis or raw value is then</span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a>only a question of interpretability. </span>
<span id="cb34-332"><a href="#cb34-332" aria-hidden="true" tabindex="-1"></a>They renewed the recommendation in 2015 <span class="co">[</span><span class="ot">@CHMP2015</span><span class="co">]</span>.</span>
<span id="cb34-333"><a href="#cb34-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a>From the academic side, the topic was repeatedly studied:</span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@VanBreukelen2006:</span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; _"In randomized studies both methods </span><span class="co">[</span><span class="ot">Anova, no BL adjustment vs Ancova</span><span class="co">]</span></span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; are unbiased, but ANCOVA has more power"_</span></span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@Liu2009 also highlighted the benefits of adjustment for baseline as a</span>
<span id="cb34-341"><a href="#cb34-341" aria-hidden="true" tabindex="-1"></a>covariate.</span>
<span id="cb34-342"><a href="#cb34-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>this was later confirmed by @Zhang2014.</span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>More recently @OConnell2017 also defended the superiority of the</span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a>Ancova-change:</span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a>$y_i = \beta_0 + \beta_1 X_i + \beta_2 Y_{0i,=BL} + \varepsilon_i$</span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; _"Consistent with existing literature, our results demonstrate that each</span></span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; method leads to unbiased treatment effect estimates, and based on precision</span></span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; of estimates, 95% coverage probability, and power, ANCOVA modeling of either</span></span>
<span id="cb34-350"><a href="#cb34-350" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; change scores or post-treatment score as the outcome, prove to be the most</span></span>
<span id="cb34-351"><a href="#cb34-351" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; effective._"</span></span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a>Most of the authors above are specifically working on randomized trial,</span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a>@Vickers2001 also brought some light on the topic, and highlighted in addition</span>
<span id="cb34-355"><a href="#cb34-355" aria-hidden="true" tabindex="-1"></a>that: working with percentage change is generally a bad idea. The extended</span>
<span id="cb34-356"><a href="#cb34-356" aria-hidden="true" tabindex="-1"></a>to a theoretical works also indicated that the percentage change from</span>
<span id="cb34-357"><a href="#cb34-357" aria-hidden="true" tabindex="-1"></a>baseline _"will also fail to protect from bias in the case of baseline imbalance</span>
<span id="cb34-358"><a href="#cb34-358" aria-hidden="true" tabindex="-1"></a>and will lead to an excess of trials with non-normally distributed outcome</span>
<span id="cb34-359"><a href="#cb34-359" aria-hidden="true" tabindex="-1"></a>data"_.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, FCA Collin, Ph.D.</div>
  </div>
</footer>


</body></html>