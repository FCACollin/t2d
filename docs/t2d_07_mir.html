<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.592">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Francois Collin">
<meta name="dcterms.date" content="2022-07-01">
<title>T2D: Exercise and Genetic Expression Profile - 5&nbsp; mRNA / micro RNA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./t2d_11_wcn.html" rel="next">
<link href="./t2d_06_rna.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">T2D: Exercise and Genetic Expression Profile</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/FCACollin/t2d" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preamble</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_03_bds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Missingness in adlb and advs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_08_dmg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Demographics and Baseline Anthropometrics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_09_chg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Anthropometrics Changes From Baseline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_06_rna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_07_mir.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_11_wcn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">WGCNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#mirna-seq---differential-expression-analysis" id="toc-mirna-seq---differential-expression-analysis" class="nav-link active" data-scroll-target="#mirna-seq---differential-expression-analysis"> <span class="header-section-number">5.1</span> miRNA Seq - Differential expression analysis</a>
  <ul class="collapse">
<li><a href="#materials-and-methods" id="toc-materials-and-methods" class="nav-link" data-scroll-target="#materials-and-methods"> <span class="header-section-number">5.1.1</span> Materials and Methods</a></li>
  </ul>
</li>
  <li><a href="#sample-depth-threshold-determination" id="toc-sample-depth-threshold-determination" class="nav-link" data-scroll-target="#sample-depth-threshold-determination"> <span class="header-section-number">5.2</span> Sample depth threshold determination</a></li>
  <li>
<a href="#dds_1---de-baseline-all-micro-rna" id="toc-dds_1---de-baseline-all-micro-rna" class="nav-link" data-scroll-target="#dds_1---de-baseline-all-micro-rna"> <span class="header-section-number">5.3</span> <code>dds_1</code> - DE: Baseline, all micro RNA</a>
  <ul class="collapse">
<li><a href="#fig-07-01" id="toc-fig-07-01" class="nav-link" data-scroll-target="#fig-07-01"> <span class="header-section-number">5.3.1</span> Fig 07 01</a></li>
  <li><a href="#fig-07-02" id="toc-fig-07-02" class="nav-link" data-scroll-target="#fig-07-02"> <span class="header-section-number">5.3.2</span> Fig 07 02</a></li>
  </ul>
</li>
  <li>
<a href="#dds_2---de-baseline-mrna" id="toc-dds_2---de-baseline-mrna" class="nav-link" data-scroll-target="#dds_2---de-baseline-mrna"> <span class="header-section-number">5.4</span> <code>dds_2</code> - DE: Baseline, mRNA</a>
  <ul class="collapse">
<li><a href="#fig-07-03" id="toc-fig-07-03" class="nav-link" data-scroll-target="#fig-07-03"> <span class="header-section-number">5.4.1</span> Fig 07 03</a></li>
  <li><a href="#fig-07-04" id="toc-fig-07-04" class="nav-link" data-scroll-target="#fig-07-04"> <span class="header-section-number">5.4.2</span> Fig 07 04</a></li>
  </ul>
</li>
  <li>
<a href="#dds_3---de-month-3-all-micro-rna" id="toc-dds_3---de-month-3-all-micro-rna" class="nav-link" data-scroll-target="#dds_3---de-month-3-all-micro-rna"> <span class="header-section-number">5.5</span> <code>dds_3</code> - DE: Month 3, all micro RNA</a>
  <ul class="collapse">
<li><a href="#fig-07-05" id="toc-fig-07-05" class="nav-link" data-scroll-target="#fig-07-05"> <span class="header-section-number">5.5.1</span> Fig 07 05</a></li>
  <li><a href="#fig-07-06" id="toc-fig-07-06" class="nav-link" data-scroll-target="#fig-07-06"> <span class="header-section-number">5.5.2</span> Fig 07 06</a></li>
  </ul>
</li>
  <li>
<a href="#dds_4---de-month-3-mrna" id="toc-dds_4---de-month-3-mrna" class="nav-link" data-scroll-target="#dds_4---de-month-3-mrna"> <span class="header-section-number">5.6</span> <code>dds_4</code> - DE: Month 3, mRNA</a>
  <ul class="collapse">
<li><a href="#fig-07-07" id="toc-fig-07-07" class="nav-link" data-scroll-target="#fig-07-07"> <span class="header-section-number">5.6.1</span> Fig 07 07</a></li>
  <li><a href="#fig-07-08" id="toc-fig-07-08" class="nav-link" data-scroll-target="#fig-07-08"> <span class="header-section-number">5.6.2</span> Fig 07 08</a></li>
  </ul>
</li>
  <li><a href="#session-informations" id="toc-session-informations" class="nav-link" data-scroll-target="#session-informations"> <span class="header-section-number">5.7</span> Session Informations</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/FCACollin/t2d/edit/main/t2d_07_mir.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Program 07</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Francois Collin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 1, 2022</p>
    </div>
  </div>
    
  </div>
  

</header><section id="mirna-seq---differential-expression-analysis" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="mirna-seq---differential-expression-analysis">
<span class="header-section-number">5.1</span> miRNA Seq - Differential expression analysis</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">cfg_prog</span> <span class="op">&lt;-</span> <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html">read_yaml</a></span><span class="op">(</span><span class="st">"_prog.yml"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The variation in messenger RNA (mRNA) and micro-RNA (miRNA) abundance measured by RNA-Seq associated either with the dysglycemia and/or the 3-month exercise intervention were investigated by a Differential Expression analysis (DE). At baseline, the DE model included only the effect of the dysglycemia-constrast group, consistently with the Anova model applied for demographics and baseline anthropometrics. To do so, genetic features which were never found expressed were discarded. Then RNA-Seq libraries were included if reaching a read depth threshold (total number of reads per sample) fixed by visual examination of the association between sample gene diversity and sample depth. For the remaining libraries, genetic features were included if the count per million reads (CPM) was greater than 2 in at least 50% of the samples. The DE analysis implementation proposed by <span class="citation" data-cites="Love2014">Love, Huber, and Anders (<a href="references.html#ref-Love2014" role="doc-biblioref">2014</a>)</span> with the R package <code>DESeq2</code> was used to fit the models; it is based on a negative binomial distribution accounting for read variability, dispersion corrected after trends seen across all samples and genes <span class="citation" data-cites="Duendar2018">(<a href="references.html#ref-Duendar2018" role="doc-biblioref">Dündar, Skrabanek, and Zumbo 2018</a>)</span>. In addition, the number of tested genes being high, raw p.values were therefore adjusted according to Benjamini and Hochberg’s method also called False-Discovery Rate (FDR).</p>
<p>The analysis was realized with R <span class="citation" data-cites="RCT2022">(v4.2.0, <a href="references.html#ref-RCT2022" role="doc-biblioref">R Core Team 2022</a>)</span>. Note the use of the additional packages downloaded from the RStudio package manager repository (freeze date 2022-05-04, <a href="https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU">repos</a>):</p>
<ul>
<li>
<code>DESeq2</code> for differential expression analysis and variance stabilizing transformation <span class="citation" data-cites="Love2014">(version 1.36.0, <a href="references.html#ref-Love2014" role="doc-biblioref">Love, Huber, and Anders 2014</a>)</span>
</li>
<li>
<code>ggplot2</code> for graphics <span class="citation" data-cites="Wickham2016">(version 3.3.6, <a href="references.html#ref-Wickham2016" role="doc-biblioref">Wickham 2016</a>)</span>
</li>
<li>
<code>MultiAssayExperiment</code> for management of multi-omics experiment objects <span class="citation" data-cites="Ramos2017">(version 1.22.0, <a href="references.html#ref-Ramos2017" role="doc-biblioref">Ramos et al. 2017</a>)</span>.</li>
</ul>
<p>Target:</p>
<ul class="task-list">
<li>
<input type="checkbox" disabled="" checked="">
miRNA DE at baseline without confounding factors.</li>
</ul>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/dbs.data"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading dbs.data</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/latarnia.utils"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading latarnia.utils</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: grid</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: shiny</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>results <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">knitr</span><span class="op">$</span><span class="va">results</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">assertthat</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/ngs.R"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/inches.R"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="materials-and-methods" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="materials-and-methods">
<span class="header-section-number">5.1.1</span> Materials and Methods</h3>
<section id="helper-functions" class="level4" data-number="5.1.1.1"><h4 data-number="5.1.1.1" class="anchored" data-anchor-id="helper-functions">
<span class="header-section-number">5.1.1.1</span> Helper functions</h4>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># Help for data pre-processing</span>
<span class="va">filter_for_depth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">assay</span>, <span class="va">depth_threshold</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">mae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">depth_threshold</span>, <span class="op">]</span>
<span class="op">}</span>

<span class="va">filter_for_visit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">visit</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">mae</span><span class="op">[</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span> <span class="op">==</span> <span class="va">visit</span>, <span class="op">]</span>
<span class="op">}</span>

<span class="va">filter_for_low_expr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">assay</span>, <span class="va">cpm_threshold</span>,
                                <span class="va">frac_cols</span> <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">$</span><span class="va">fraccol</span>
<span class="op">)</span> <span class="op">{</span>
  <span class="co"># Genes expressed at least cpm_threshold in frac_cols columns</span>
  <span class="va">mae</span><span class="op">[</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">cpm</span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">cpm_threshold</span><span class="op">)</span> <span class="op">&gt;</span>
      <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">frac_cols</span>,
    ,
  <span class="op">]</span>
<span class="op">}</span>

<span class="co"># Differential expression helper functions:</span>
<span class="va">de_by_ctrs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>,
                       <span class="va">ctrs</span>,
                       <span class="va">adj_meth</span> <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="va">ctrs</span>,
    fit <span class="op">=</span> <span class="va">df</span>,
    adj_meth <span class="op">=</span> <span class="va">adj_meth</span>,
    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">fit</span>, <span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html">results</a></span><span class="op">(</span><span class="va">fit</span>, contrast <span class="op">=</span> <span class="va">x</span>, pAdjustMethod <span class="op">=</span> <span class="va">adj_meth</span><span class="op">)</span>
      <span class="va">y</span><span class="op">$</span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
      <span class="va">y</span><span class="op">$</span><span class="va">log_padj</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span>
      <span class="va">y</span><span class="op">$</span><span class="va">ctrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"test"</span><span class="op">]</span>, <span class="st">"vs"</span>, <span class="va">x</span><span class="op">[</span><span class="st">"ref"</span><span class="op">]</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data-preparation" class="level4" data-number="5.1.1.2"><h4 data-number="5.1.1.2" class="anchored" data-anchor-id="data-preparation">
<span class="header-section-number">5.1.1.2</span> Data preparation</h4>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adsl</span>
<span class="va">advs</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">advs</span>
<span class="va">adlb</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adlb</span>

<span class="co">#' Subjid and Visit to Sample</span>
<span class="co">#' </span>
<span class="va">subjvis_to_spl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">subjid</span>, <span class="st">"v"</span>, <span class="va">df</span><span class="op">$</span><span class="va">avisitn</span><span class="op">)</span>

<span class="va">ads</span> <span class="op">&lt;-</span> <span class="va">adlb</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">advs</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ct</span>, <span class="va">dtype</span>, <span class="va">param</span>, <span class="va">base</span>, <span class="va">basetype</span>, <span class="va">chg</span>, <span class="va">pchg</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"paramcd"</span>, values_from <span class="op">=</span> <span class="st">"aval"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">adsl</span>, y <span class="op">=</span> _, by <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html">DataFrame</a></span><span class="op">(</span><span class="va">df</span>, row.names <span class="op">=</span> <span class="fu">subjvis_to_spl</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">subjid</span>, <span class="va">diabcd</span>, <span class="va">diab</span>, <span class="va">avisitn</span>, <span class="va">avisit</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu">assertthat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu">subjvis_to_spl</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="va">df</span>
  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span>

<span class="va">ads</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  mrna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">mrna_raw</span>,
  premirna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">premirna_raw</span>,
  mirna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">mirna_raw</span>
<span class="op">)</span>

<span class="va">rna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"premirna"</span>, <span class="st">"mirna"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="va">rna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"premirna"</span>, <span class="st">"mirna"</span><span class="op">)</span><span class="op">]</span>,
  FUN <span class="op">=</span> <span class="va">format_mirna</span>
<span class="op">)</span>

<span class="co"># Rows represent genes</span>
<span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span><span class="op">)</span>
<span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, <span class="va">as.matrix</span><span class="op">)</span>
<span class="fu">assertthat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">premirna</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">mirna</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">rna</span><span class="op">$</span><span class="va">allmirna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">premirna</span>, <span class="va">rna</span><span class="op">$</span><span class="va">mirna</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org">testthat</a></span><span class="op">)</span>
<span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html">test_that</a></span><span class="op">(</span><span class="st">"rna features discriminated in noexpr, expr"</span>, <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_true</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://waldronlab.io/MultiAssayExperiment/">MultiAssayExperiment</a></span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: SummarizedExperiment</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MatrixGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: matrixStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MatrixGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, append, as.data.frame, basename, cbind, colnames,
    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Biobase'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatrixGenerics':

    rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    anyMissing, rowMedians</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">#' (Sample-)Map Arrays</span>
<span class="co">#'</span>
<span class="co">#' Use the column names of `x` to deduce the `primary` and `colnames`.</span>
<span class="co">#' This is used to generate the sample mapping between colData and Experiments.</span>
<span class="co">#'</span>
<span class="co">#' @param x (`dataframe`).</span>
<span class="co">#'</span>
<span class="co">#' @note In our case, primary and colnames are equivalent, colnames could</span>
<span class="co">#' be different from primary names when a biological sample has different</span>
<span class="co">#' names in the biological assays (e.g. machine constraint, technical</span>
<span class="co">#' repetitions).</span>
<span class="co">#'</span>
<span class="co">#' @seealso [MultiAssayExperiment::listToMap()]</span>
<span class="co">#' @examples</span>
<span class="co">#' \dontrun{</span>
<span class="co">#'   lapply(rna, map_arrays)</span>
<span class="co">#'   MultiAssayExperiment::listToMap(lapply(rna, map_arrays))</span>
<span class="co">#' }</span>
<span class="co">#'</span>
<span class="va">map_arrays</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>colname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
  <span class="va">y</span><span class="op">$</span><span class="va">primary</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="va">colname</span>
  <span class="va">y</span>
<span class="op">}</span>

<span class="va">besd_mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment.html">MultiAssayExperiment</a></span><span class="op">(</span>
  experiments <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/ExperimentList.html">ExperimentList</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span>,
  colData <span class="op">=</span> <span class="va">ads</span>,
  sampleMap <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/mapToList.html">listToMap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">rna</span>, <span class="va">map_arrays</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">besd_mae</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="sample-depth-threshold-determination" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sample-depth-threshold-determination">
<span class="header-section-number">5.2</span> Sample depth threshold determination</h2>
<p>A scatter plot representing sample gene diversity in relationship with sample depth evidenced a threshold for miRNA reads at 5e+06 reads for which approximately a million read increase was associated with more than a 2-fold increase in gene diversity. The depth threshold for mRNA was fixed at , although with a less important but still substantial drop in gene variety below that threshold.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">miRNA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">mRNA</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Static figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Interactive figure</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">vline</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,
  depth  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dtaplot</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">depth</span>, y <span class="op">=</span> <span class="va">n_gene</span>, colour <span class="op">=</span> <span class="va">diab</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">vline</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sample depth"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Gene diversity (number of genes with reads)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Static figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Interactive figure</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">vline</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span>
<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,
  depth  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  <span class="va">dtaplot</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">dtaplot</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">depth</span>, y <span class="op">=</span> <span class="va">n_gene</span>, colour <span class="op">=</span> <span class="va">diab</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">vline</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sample depth"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Gene diversity (number of genes with reads)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="dds_1---de-baseline-all-micro-rna" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="dds_1---de-baseline-all-micro-rna">
<span class="header-section-number">5.3</span> <code>dds_1</code> - DE: Baseline, all micro RNA</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span>
<span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span>

<span class="va">dds_1_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_visit</span><span class="op">(</span><span class="st">"Baseline"</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span>
    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,
    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,
    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span>
    parallel <span class="op">=</span> <span class="cn">TRUE</span>,
    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,
    fitType <span class="op">=</span> <span class="st">"local"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_1_est</span> <span class="op">&lt;-</span>
  <span class="va">dds_1_fit</span> |&gt;
  <span class="fu">de_by_ctrs</span><span class="op">(</span>
    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> _<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-01" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="fig-07-01">
<span class="header-section-number">5.3.1</span> Fig 07 01</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dds_1_gg</span> <span class="op">&lt;-</span>
  <span class="va">dds_1_est</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.1"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_1_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_01.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_01_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_01.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_01_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="fig-07-02" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="fig-07-02">
<span class="header-section-number">5.3.2</span> Fig 07 02</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_1_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>
  <span class="st">"hsa-(mir|miR|let)-"</span>,
  <span class="va">dds_1_est</span><span class="op">$</span><span class="va">feature</span>,
  replacement <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span>
<span class="va">dds_1_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">)</span>

<span class="va">dds_1_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">dds_1_est</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_1_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1</span>,
    shape <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_1_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
    size <span class="op">=</span> <span class="fl">2</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.2"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_1_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span>

<span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_02.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_02_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_02.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_02_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_2---de-baseline-mrna" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="dds_2---de-baseline-mrna">
<span class="header-section-number">5.4</span> <code>dds_2</code> - DE: Baseline, mRNA</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span>
<span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span>

<span class="va">dds_2_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_visit</span><span class="op">(</span><span class="st">"Baseline"</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span>
    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,
    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,
    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span>
    parallel <span class="op">=</span> <span class="cn">TRUE</span>,
    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_2_est</span> <span class="op">&lt;-</span>
  <span class="va">dds_2_fit</span> |&gt;
  <span class="fu">de_by_ctrs</span><span class="op">(</span>
    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> _<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-03" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="fig-07-03">
<span class="header-section-number">5.4.1</span> Fig 07 03</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_2_gg</span> <span class="op">&lt;-</span>
  <span class="va">dds_2_est</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.3"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_2_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_03.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_03_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_03.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_03_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="fig-07-04" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="fig-07-04">
<span class="header-section-number">5.4.2</span> Fig 07 04</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_2_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ENSG0+"</span>, <span class="st">""</span>, <span class="va">dds_2_est</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">)</span>

<span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_2_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dds_2_est</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1</span>,
    shape <span class="op">=</span> <span class="fl">3</span>,
    color <span class="op">=</span> <span class="st">"royalblue"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
    size <span class="op">=</span> <span class="fl">2</span>,
    color <span class="op">=</span> <span class="st">"royalblue"</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.4"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_2_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span>

<span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_04.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_04_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_04.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_04_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_3---de-month-3-all-micro-rna" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="dds_3---de-month-3-all-micro-rna">
<span class="header-section-number">5.5</span> <code>dds_3</code> - DE: Month 3, all micro RNA</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span>
<span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span>

<span class="va">dds_3_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_visit</span><span class="op">(</span><span class="st">"Month 3"</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span>
    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,
    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,
    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span>
    parallel <span class="op">=</span> <span class="cn">TRUE</span>,
    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,
    fitType <span class="op">=</span> <span class="st">"local"</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_3_est</span> <span class="op">&lt;-</span>
  <span class="va">dds_3_fit</span> |&gt;
  <span class="fu">de_by_ctrs</span><span class="op">(</span>
    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> _<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-05" class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="fig-07-05">
<span class="header-section-number">5.5.1</span> Fig 07 05</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">dds_3_gg</span> <span class="op">&lt;-</span>
  <span class="va">dds_3_est</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.5"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_3_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 350 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_05.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_05_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_05.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_05_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="fig-07-06" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="fig-07-06">
<span class="header-section-number">5.5.2</span> Fig 07 06</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_3_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>
  <span class="st">"hsa-(mir|miR|let)-"</span>,
  <span class="va">dds_3_est</span><span class="op">$</span><span class="va">feature</span>,
  replacement <span class="op">=</span> <span class="st">""</span>
<span class="op">)</span>
<span class="va">dds_3_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">)</span>

<span class="va">dds_3_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">dds_3_est</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_3_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1</span>,
    shape <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_3_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
    size <span class="op">=</span> <span class="fl">2</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.6"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all miRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_3_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 350 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_06.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_06_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_06.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_06_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_4---de-month-3-mrna" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="dds_4---de-month-3-mrna">
<span class="header-section-number">5.6</span> <code>dds_4</code> - DE: Month 3, mRNA</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span>
<span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span>

<span class="va">dds_4_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_visit</span><span class="op">(</span><span class="st">"Month 3"</span><span class="op">)</span> |&gt;
  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span>
    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,
    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,
    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span>
    parallel <span class="op">=</span> <span class="cn">TRUE</span>,
    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 21 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_4_est</span> <span class="op">&lt;-</span>
  <span class="va">dds_4_fit</span> |&gt;
  <span class="fu">de_by_ctrs</span><span class="op">(</span>
    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> _<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-07" class="level3" data-number="5.6.1"><h3 data-number="5.6.1" class="anchored" data-anchor-id="fig-07-07">
<span class="header-section-number">5.6.1</span> Fig 07 07</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_4_gg</span> <span class="op">&lt;-</span>
  <span class="va">dds_4_est</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.7"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among all mRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_4_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span>

<span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_07.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_07_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_07.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_07_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="fig-07-08" class="level3" data-number="5.6.2"><h3 data-number="5.6.2" class="anchored" data-anchor-id="fig-07-08">
<span class="header-section-number">5.6.2</span> Fig 07 08</h3>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dds_4_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ENSG0+"</span>, <span class="st">""</span>, <span class="va">dds_4_est</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">)</span>

<span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span>
<span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span>
<span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">dds_4_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dds_4_est</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_4_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,
    size <span class="op">=</span> <span class="fl">1</span>,
    shape <span class="op">=</span> <span class="fl">3</span>,
    color <span class="op">=</span> <span class="st">"royalblue"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/subsetBy.html">subset</a></span><span class="op">(</span><span class="va">dds_4_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,
    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,
    size <span class="op">=</span> <span class="fl">2</span>,
    color <span class="op">=</span> <span class="st">"royalblue"</span>,
    show.legend <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,
    legend.text.align <span class="op">=</span> <span class="fl">0</span>,
    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_title</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Figure 7.8"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span>
        <span class="st">"Volcano plot - Response Size and Significance of Differential
        Expression among mRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span>
      <span class="op">)</span>,
      <span class="st">"Analysis Set: Full Analysis Set"</span>
    <span class="op">)</span>
  <span class="op">)</span> |&gt;
  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_4_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">add_footer</span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span>
  <span class="op">)</span>

<span class="fu">export_as</span><span class="op">(</span>
  <span class="va">p</span>,
  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_08.pdf"</span><span class="op">)</span>,
  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_08_af.pdf"</span><span class="op">)</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_08.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_08_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="session-informations" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="session-informations">
<span class="header-section-number">5.7</span> Session Informations</h2>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Duendar2018" class="csl-entry" role="doc-biblioentry">
Dündar, Friederike, Luce Skrabanek, and Paul Zumbo. 2018. <span>“Introduction to Differential Gene Expression Analysis Using RNA-Seq.”</span> Internet.
</div>
<div id="ref-Love2014" class="csl-entry" role="doc-biblioentry">
Love, Michael I., Wolfgang Huber, and Simon Anders. 2014. <span>“Moderated Estimation of Fold Change and Dispersion for RNA-Seq Data with DESeq2.”</span> <em>Genome Biology</em> 15: 550. <a href="https://doi.org/10.1186/s13059-014-0550-8">https://doi.org/10.1186/s13059-014-0550-8</a>.
</div>
<div id="ref-RCT2022" class="csl-entry" role="doc-biblioentry">
R Core Team. 2022. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Ramos2017" class="csl-entry" role="doc-biblioentry">
Ramos, Marcel, Lucas Schiffer, Angela Re, Rimsha Azhar, Azfar Basunia, Carmen Rodriguez Cabrera, Tiffany Chan, et al. 2017. <span>“Software for the Integration of Multi-Omics Experiments in Bioconductor.”</span> <em>Cancer Research</em> 77(21); e39-42.
</div>
<div id="ref-Wickham2016" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./t2d_06_rna.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./t2d_11_wcn.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">WGCNA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb130" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "mRNA / micro RNA"</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Program 07</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Francois Collin"</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%Y-%m-%d')`"</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="an">always_allow_html:</span><span class="co"> true</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## miRNA Seq - Differential expression analysis</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, cfg_prog}</span></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>cfg_prog <span class="ot">&lt;-</span> yaml<span class="sc">::</span><span class="fu">read_yaml</span>(<span class="st">"_prog.yml"</span>)</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>The variation in messenger RNA (mRNA) and micro-RNA (miRNA) abundance measured</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>by RNA-Seq associated</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>either with the dysglycemia and/or the 3-month exercise intervention were</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>investigated by a Differential Expression analysis (DE). At baseline,</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>the DE model included only the effect of the dysglycemia-constrast group,</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>consistently with the Anova model applied for demographics and baseline</span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>anthropometrics.</span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>To do so, genetic features which were never found expressed were discarded.</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>Then RNA-Seq libraries were included if reaching a</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>read depth threshold (total number of reads per sample) fixed by visual</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>examination of the association between sample gene diversity and sample depth.</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>For the remaining libraries, genetic features were included if the count per</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>million reads (CPM) was greater than <span class="in">`r cfg_prog$rna$cpm_threshold$allmirna`</span></span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>in at least <span class="in">`r cfg_prog$rna$cpm_threshold$fraccol * 100`</span>% of the samples. </span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>The DE analysis implementation proposed by @Love2014 with the R package</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a><span class="in">`DESeq2`</span> was used to fit the models; it is based on a negative binomial</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>distribution accounting for read variability, dispersion corrected after trends</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>seen across all samples and genes <span class="co">[</span><span class="ot">@Duendar2018</span><span class="co">]</span>.</span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>In addition, the number of tested genes being high, raw p.values were</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>therefore adjusted according to Benjamini and Hochberg's method also called</span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a>False-Discovery Rate (FDR).</span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>The analysis was realized with R <span class="co">[</span><span class="ot">v4.2.0, @RCT2022</span><span class="co">]</span>. Note the</span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a>use of the additional packages downloaded from the RStudio package manager</span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>repository (freeze date 2022-05-04, <span class="co">[</span><span class="ot">repos</span><span class="co">]</span>(</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a>https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU)):</span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DESeq2`</span> for differential expression analysis and</span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>variance stabilizing transformation <span class="co">[</span><span class="ot">version 1.36.0, @Love2014</span><span class="co">]</span></span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ggplot2`</span> for graphics <span class="co">[</span><span class="ot">version 3.3.6, @Wickham2016</span><span class="co">]</span></span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`MultiAssayExperiment`</span> for management of multi-omics experiment objects</span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">version 1.22.0, @Ramos2017</span><span class="co">]</span>.</span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>Target:</span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> miRNA DE at baseline without confounding factors.</span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, settings}</span></span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/dbs.data"</span>)</span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/latarnia.utils"</span>)</span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">results =</span> cfg_prog<span class="sc">$</span>knitr<span class="sc">$</span>results)</span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(assertthat)</span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/ngs.R"</span>)</span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/inches.R"</span>)</span>
<span id="cb130-62"><a href="#cb130-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-63"><a href="#cb130-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a><span class="fu">### Materials and Methods</span></span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Helper functions</span></span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Help for data pre-processing</span></span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a>filter_for_depth <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, assay, depth_threshold) {</span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a>  mae[, <span class="fu">colSums</span>(mae[[ngs_assay]]) <span class="sc">&gt;</span> depth_threshold, ]</span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a>filter_for_visit <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, visit) {</span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a>  mae[, <span class="fu">colData</span>(mae)<span class="sc">$</span>avisit <span class="sc">==</span> visit, ]</span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a>filter_for_low_expr <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, assay, cpm_threshold,</span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a>                                <span class="at">frac_cols =</span> cfg_prog<span class="sc">$</span>rna<span class="sc">$</span>cpm_threshold<span class="sc">$</span>fraccol</span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Genes expressed at least cpm_threshold in frac_cols columns</span></span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a>  mae[</span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowSums</span>(<span class="fu">cpm</span>(mae[[assay]]) <span class="sc">&gt;</span> cpm_threshold) <span class="sc">&gt;</span></span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ncol</span>(mae[[assay]]) <span class="sc">*</span> frac_cols,</span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Differential expression helper functions:</span></span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a>de_by_ctrs <span class="ot">&lt;-</span> <span class="cf">function</span>(df,</span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a>                       ctrs,</span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adj_meth =</span> ctrl<span class="sc">$</span>adj_meth) {</span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(</span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a>    ctrs,</span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> df,</span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_meth =</span> adj_meth,</span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> <span class="cf">function</span>(x, fit, adj_meth) {</span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> DESeq2<span class="sc">::</span><span class="fu">results</span>(fit, <span class="at">contrast =</span> x, <span class="at">pAdjustMethod =</span> adj_meth)</span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(y)</span>
<span id="cb130-102"><a href="#cb130-102" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>log_padj <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(y<span class="sc">$</span>padj)</span>
<span id="cb130-103"><a href="#cb130-103" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>ctrs <span class="ot">&lt;-</span> <span class="fu">paste</span>(x[<span class="st">"test"</span>], <span class="st">"vs"</span>, x[<span class="st">"ref"</span>])</span>
<span id="cb130-104"><a href="#cb130-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(y)</span>
<span id="cb130-105"><a href="#cb130-105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb130-106"><a href="#cb130-106" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-107"><a href="#cb130-107" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-108"><a href="#cb130-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-109"><a href="#cb130-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-110"><a href="#cb130-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data preparation</span></span>
<span id="cb130-111"><a href="#cb130-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-112"><a href="#cb130-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, ads}</span></span>
<span id="cb130-113"><a href="#cb130-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb130-114"><a href="#cb130-114" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adsl</span>
<span id="cb130-115"><a href="#cb130-115" aria-hidden="true" tabindex="-1"></a>advs <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>advs</span>
<span id="cb130-116"><a href="#cb130-116" aria-hidden="true" tabindex="-1"></a>adlb <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adlb</span>
<span id="cb130-117"><a href="#cb130-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-118"><a href="#cb130-118" aria-hidden="true" tabindex="-1"></a><span class="co">#' Subjid and Visit to Sample</span></span>
<span id="cb130-119"><a href="#cb130-119" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb130-120"><a href="#cb130-120" aria-hidden="true" tabindex="-1"></a>subjvis_to_spl <span class="ot">&lt;-</span> <span class="cf">function</span>(df) <span class="fu">paste0</span>(df<span class="sc">$</span>subjid, <span class="st">"v"</span>, df<span class="sc">$</span>avisitn)</span>
<span id="cb130-121"><a href="#cb130-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-122"><a href="#cb130-122" aria-hidden="true" tabindex="-1"></a>ads <span class="ot">&lt;-</span> adlb <span class="sc">|&gt;</span></span>
<span id="cb130-123"><a href="#cb130-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(advs) <span class="sc">|&gt;</span></span>
<span id="cb130-124"><a href="#cb130-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ct, dtype, param, base, basetype, chg, pchg)) <span class="sc">|&gt;</span></span>
<span id="cb130-125"><a href="#cb130-125" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"paramcd"</span>, <span class="at">values_from =</span> <span class="st">"aval"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-126"><a href="#cb130-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(adsl, <span class="at">y =</span> _, <span class="at">by =</span> <span class="st">"subjid"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-127"><a href="#cb130-127" aria-hidden="true" tabindex="-1"></a>  (\(df) S4Vectors<span class="sc">::</span><span class="fu">DataFrame</span>(df, <span class="at">row.names =</span> <span class="fu">subjvis_to_spl</span>(df)))() <span class="sc">|&gt;</span></span>
<span id="cb130-128"><a href="#cb130-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(subjid, diabcd, diab, avisitn, avisit)) <span class="sc">|&gt;</span></span>
<span id="cb130-129"><a href="#cb130-129" aria-hidden="true" tabindex="-1"></a>  (\(df) {</span>
<span id="cb130-130"><a href="#cb130-130" aria-hidden="true" tabindex="-1"></a>    assertthat<span class="sc">::</span><span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">table</span>(<span class="fu">subjvis_to_spl</span>(df)) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb130-131"><a href="#cb130-131" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb130-132"><a href="#cb130-132" aria-hidden="true" tabindex="-1"></a>  })()</span>
<span id="cb130-133"><a href="#cb130-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-134"><a href="#cb130-134" aria-hidden="true" tabindex="-1"></a>ads</span>
<span id="cb130-135"><a href="#cb130-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-136"><a href="#cb130-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-137"><a href="#cb130-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-138"><a href="#cb130-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, rna}</span></span>
<span id="cb130-139"><a href="#cb130-139" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb130-140"><a href="#cb130-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrna =</span> dbs.data<span class="sc">::</span>mrna_raw,</span>
<span id="cb130-141"><a href="#cb130-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">premirna =</span> dbs.data<span class="sc">::</span>premirna_raw,</span>
<span id="cb130-142"><a href="#cb130-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">mirna =</span> dbs.data<span class="sc">::</span>mirna_raw</span>
<span id="cb130-143"><a href="#cb130-143" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-144"><a href="#cb130-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-145"><a href="#cb130-145" aria-hidden="true" tabindex="-1"></a>rna[<span class="fu">c</span>(<span class="st">"premirna"</span>, <span class="st">"mirna"</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb130-146"><a href="#cb130-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> rna[<span class="fu">c</span>(<span class="st">"premirna"</span>, <span class="st">"mirna"</span>)],</span>
<span id="cb130-147"><a href="#cb130-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> format_mirna</span>
<span id="cb130-148"><a href="#cb130-148" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-149"><a href="#cb130-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-150"><a href="#cb130-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows represent genes</span></span>
<span id="cb130-151"><a href="#cb130-151" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> rna, <span class="at">FUN =</span> <span class="cf">function</span>(x) y <span class="ot">&lt;-</span> x[<span class="fu">rowSums</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>, ])</span>
<span id="cb130-152"><a href="#cb130-152" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> rna, as.matrix)</span>
<span id="cb130-153"><a href="#cb130-153" aria-hidden="true" tabindex="-1"></a>assertthat<span class="sc">::</span><span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(rna<span class="sc">$</span>premirna) <span class="sc">==</span> <span class="fu">colnames</span>(rna<span class="sc">$</span>mirna)))</span>
<span id="cb130-154"><a href="#cb130-154" aria-hidden="true" tabindex="-1"></a>rna<span class="sc">$</span>allmirna <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rna<span class="sc">$</span>premirna, rna<span class="sc">$</span>mirna)</span>
<span id="cb130-155"><a href="#cb130-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-156"><a href="#cb130-156" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb130-157"><a href="#cb130-157" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"rna features discriminated in noexpr, expr"</span>, {</span>
<span id="cb130-158"><a href="#cb130-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="at">X =</span> rna, <span class="at">FUN =</span> \(x) <span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">rowSums</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>)))</span>
<span id="cb130-159"><a href="#cb130-159" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb130-160"><a href="#cb130-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-161"><a href="#cb130-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-162"><a href="#cb130-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, mae}</span></span>
<span id="cb130-163"><a href="#cb130-163" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MultiAssayExperiment)</span>
<span id="cb130-164"><a href="#cb130-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-165"><a href="#cb130-165" aria-hidden="true" tabindex="-1"></a><span class="co">#' (Sample-)Map Arrays</span></span>
<span id="cb130-166"><a href="#cb130-166" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb130-167"><a href="#cb130-167" aria-hidden="true" tabindex="-1"></a><span class="co">#' Use the column names of `x` to deduce the `primary` and `colnames`.</span></span>
<span id="cb130-168"><a href="#cb130-168" aria-hidden="true" tabindex="-1"></a><span class="co">#' This is used to generate the sample mapping between colData and Experiments.</span></span>
<span id="cb130-169"><a href="#cb130-169" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb130-170"><a href="#cb130-170" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x (`dataframe`).</span></span>
<span id="cb130-171"><a href="#cb130-171" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb130-172"><a href="#cb130-172" aria-hidden="true" tabindex="-1"></a><span class="co">#' @note In our case, primary and colnames are equivalent, colnames could</span></span>
<span id="cb130-173"><a href="#cb130-173" aria-hidden="true" tabindex="-1"></a><span class="co">#' be different from primary names when a biological sample has different</span></span>
<span id="cb130-174"><a href="#cb130-174" aria-hidden="true" tabindex="-1"></a><span class="co">#' names in the biological assays (e.g. machine constraint, technical</span></span>
<span id="cb130-175"><a href="#cb130-175" aria-hidden="true" tabindex="-1"></a><span class="co">#' repetitions).</span></span>
<span id="cb130-176"><a href="#cb130-176" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb130-177"><a href="#cb130-177" aria-hidden="true" tabindex="-1"></a><span class="co">#' @seealso [MultiAssayExperiment::listToMap()]</span></span>
<span id="cb130-178"><a href="#cb130-178" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb130-179"><a href="#cb130-179" aria-hidden="true" tabindex="-1"></a><span class="co">#' \dontrun{</span></span>
<span id="cb130-180"><a href="#cb130-180" aria-hidden="true" tabindex="-1"></a><span class="co">#'   lapply(rna, map_arrays)</span></span>
<span id="cb130-181"><a href="#cb130-181" aria-hidden="true" tabindex="-1"></a><span class="co">#'   MultiAssayExperiment::listToMap(lapply(rna, map_arrays))</span></span>
<span id="cb130-182"><a href="#cb130-182" aria-hidden="true" tabindex="-1"></a><span class="co">#' }</span></span>
<span id="cb130-183"><a href="#cb130-183" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb130-184"><a href="#cb130-184" aria-hidden="true" tabindex="-1"></a>map_arrays <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb130-185"><a href="#cb130-185" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">colname =</span> <span class="fu">colnames</span>(x))</span>
<span id="cb130-186"><a href="#cb130-186" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>primary <span class="ot">&lt;-</span> y<span class="sc">$</span>colname</span>
<span id="cb130-187"><a href="#cb130-187" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb130-188"><a href="#cb130-188" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-189"><a href="#cb130-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-190"><a href="#cb130-190" aria-hidden="true" tabindex="-1"></a>besd_mae <span class="ot">&lt;-</span> <span class="fu">MultiAssayExperiment</span>(</span>
<span id="cb130-191"><a href="#cb130-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">experiments =</span> <span class="fu">ExperimentList</span>(rna),</span>
<span id="cb130-192"><a href="#cb130-192" aria-hidden="true" tabindex="-1"></a>  <span class="at">colData =</span> ads,</span>
<span id="cb130-193"><a href="#cb130-193" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampleMap =</span> <span class="fu">listToMap</span>(<span class="fu">lapply</span>(rna, map_arrays))</span>
<span id="cb130-194"><a href="#cb130-194" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-195"><a href="#cb130-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-196"><a href="#cb130-196" aria-hidden="true" tabindex="-1"></a>besd_mae</span>
<span id="cb130-197"><a href="#cb130-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-198"><a href="#cb130-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-199"><a href="#cb130-199" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample depth threshold determination</span></span>
<span id="cb130-200"><a href="#cb130-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-201"><a href="#cb130-201" aria-hidden="true" tabindex="-1"></a>A scatter plot representing sample gene diversity in relationship with sample</span>
<span id="cb130-202"><a href="#cb130-202" aria-hidden="true" tabindex="-1"></a>depth evidenced a threshold for miRNA reads at</span>
<span id="cb130-203"><a href="#cb130-203" aria-hidden="true" tabindex="-1"></a><span class="in">`r formatC(cfg_prog$rna$depth_threshold$allmirna, format = "e", digits = 0)`</span></span>
<span id="cb130-204"><a href="#cb130-204" aria-hidden="true" tabindex="-1"></a>reads for which approximately a million read increase was associated with more</span>
<span id="cb130-205"><a href="#cb130-205" aria-hidden="true" tabindex="-1"></a>than a 2-fold increase in gene diversity. The depth threshold for mRNA was</span>
<span id="cb130-206"><a href="#cb130-206" aria-hidden="true" tabindex="-1"></a>fixed at </span>
<span id="cb130-207"><a href="#cb130-207" aria-hidden="true" tabindex="-1"></a><span class="in">`r formatC(cfg_prog$rna$depth_threshold$allmrna, format = "e", digits = 0)`</span>,</span>
<span id="cb130-208"><a href="#cb130-208" aria-hidden="true" tabindex="-1"></a>although with a less important but still substantial drop in gene variety</span>
<span id="cb130-209"><a href="#cb130-209" aria-hidden="true" tabindex="-1"></a>below that threshold.</span>
<span id="cb130-210"><a href="#cb130-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-211"><a href="#cb130-211" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb130-212"><a href="#cb130-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-213"><a href="#cb130-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_gg, eval=FALSE, echo=FALSE}</span></span>
<span id="cb130-214"><a href="#cb130-214" aria-hidden="true" tabindex="-1"></a>vline <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna<span class="sc">$</span>depth_threshold[[assay]]</span>
<span id="cb130-215"><a href="#cb130-215" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">assays</span>(besd_mae)[[assay]]</span>
<span id="cb130-216"><a href="#cb130-216" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb130-217"><a href="#cb130-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_gene =</span> <span class="fu">colSums</span>(dtaplot <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb130-218"><a href="#cb130-218" aria-hidden="true" tabindex="-1"></a>  <span class="at">depth  =</span> <span class="fu">colSums</span>(dtaplot)</span>
<span id="cb130-219"><a href="#cb130-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-220"><a href="#cb130-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-221"><a href="#cb130-221" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb130-222"><a href="#cb130-222" aria-hidden="true" tabindex="-1"></a>  dtaplot,</span>
<span id="cb130-223"><a href="#cb130-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">colData</span>(besd_mae)[<span class="fu">rownames</span>(dtaplot),])</span>
<span id="cb130-224"><a href="#cb130-224" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-225"><a href="#cb130-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-226"><a href="#cb130-226" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb130-227"><a href="#cb130-227" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dtaplot,</span>
<span id="cb130-228"><a href="#cb130-228" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> depth, <span class="at">y =</span> n_gene, <span class="at">colour =</span> diab)</span>
<span id="cb130-229"><a href="#cb130-229" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb130-230"><a href="#cb130-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb130-231"><a href="#cb130-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> vline) <span class="sc">+</span></span>
<span id="cb130-232"><a href="#cb130-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample depth"</span>) <span class="sc">+</span></span>
<span id="cb130-233"><a href="#cb130-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Gene diversity (number of genes with reads)"</span>) <span class="sc">+</span></span>
<span id="cb130-234"><a href="#cb130-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb130-235"><a href="#cb130-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-236"><a href="#cb130-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb130-237"><a href="#cb130-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-238"><a href="#cb130-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-239"><a href="#cb130-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_plotly, eval=FALSE, echo=FALSE}</span></span>
<span id="cb130-240"><a href="#cb130-240" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(gg)</span>
<span id="cb130-241"><a href="#cb130-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-242"><a href="#cb130-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-243"><a href="#cb130-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-244"><a href="#cb130-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### miRNA</span></span>
<span id="cb130-245"><a href="#cb130-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-246"><a href="#cb130-246" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb130-247"><a href="#cb130-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-248"><a href="#cb130-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Static figure</span></span>
<span id="cb130-249"><a href="#cb130-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-250"><a href="#cb130-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_mirna}</span></span>
<span id="cb130-251"><a href="#cb130-251" aria-hidden="true" tabindex="-1"></a>assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb130-252"><a href="#cb130-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-253"><a href="#cb130-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-254"><a href="#cb130-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_gg, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-255"><a href="#cb130-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-256"><a href="#cb130-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-257"><a href="#cb130-257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interactive figure</span></span>
<span id="cb130-258"><a href="#cb130-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-259"><a href="#cb130-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_plotly, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-260"><a href="#cb130-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-261"><a href="#cb130-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-262"><a href="#cb130-262" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-263"><a href="#cb130-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-264"><a href="#cb130-264" aria-hidden="true" tabindex="-1"></a><span class="fu">### mRNA</span></span>
<span id="cb130-265"><a href="#cb130-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-266"><a href="#cb130-266" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb130-267"><a href="#cb130-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-268"><a href="#cb130-268" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Static figure</span></span>
<span id="cb130-269"><a href="#cb130-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-270"><a href="#cb130-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_mrna}</span></span>
<span id="cb130-271"><a href="#cb130-271" aria-hidden="true" tabindex="-1"></a>assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb130-272"><a href="#cb130-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-273"><a href="#cb130-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-274"><a href="#cb130-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_gg, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-275"><a href="#cb130-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-276"><a href="#cb130-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-277"><a href="#cb130-277" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interactive figure</span></span>
<span id="cb130-278"><a href="#cb130-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-279"><a href="#cb130-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_plotly, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-280"><a href="#cb130-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-281"><a href="#cb130-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-282"><a href="#cb130-282" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-283"><a href="#cb130-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-284"><a href="#cb130-284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-285"><a href="#cb130-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-286"><a href="#cb130-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_1` - DE: Baseline, all micro RNA</span></span>
<span id="cb130-287"><a href="#cb130-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-288"><a href="#cb130-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_dta}</span></span>
<span id="cb130-289"><a href="#cb130-289" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb130-290"><a href="#cb130-290" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb130-291"><a href="#cb130-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-292"><a href="#cb130-292" aria-hidden="true" tabindex="-1"></a>dds_1_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb130-293"><a href="#cb130-293" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb130-294"><a href="#cb130-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-295"><a href="#cb130-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_visit</span>(<span class="st">"Baseline"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-296"><a href="#cb130-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-297"><a href="#cb130-297" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb130-298"><a href="#cb130-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb130-299"><a href="#cb130-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb130-300"><a href="#cb130-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb130-301"><a href="#cb130-301" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb130-302"><a href="#cb130-302" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb130-303"><a href="#cb130-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-304"><a href="#cb130-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb130-305"><a href="#cb130-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span></span>
<span id="cb130-306"><a href="#cb130-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-307"><a href="#cb130-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-308"><a href="#cb130-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-309"><a href="#cb130-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-310"><a href="#cb130-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_est}</span></span>
<span id="cb130-311"><a href="#cb130-311" aria-hidden="true" tabindex="-1"></a>dds_1_est <span class="ot">&lt;-</span></span>
<span id="cb130-312"><a href="#cb130-312" aria-hidden="true" tabindex="-1"></a>  dds_1_fit <span class="sc">|&gt;</span></span>
<span id="cb130-313"><a href="#cb130-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb130-314"><a href="#cb130-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb130-315"><a href="#cb130-315" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb130-316"><a href="#cb130-316" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb130-317"><a href="#cb130-317" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb130-318"><a href="#cb130-318" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-319"><a href="#cb130-319" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-320"><a href="#cb130-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _)</span>
<span id="cb130-321"><a href="#cb130-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-322"><a href="#cb130-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-323"><a href="#cb130-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 01</span></span>
<span id="cb130-324"><a href="#cb130-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-325"><a href="#cb130-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_gg}</span></span>
<span id="cb130-326"><a href="#cb130-326" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-327"><a href="#cb130-327" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_1_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-328"><a href="#cb130-328" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-329"><a href="#cb130-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-330"><a href="#cb130-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-331"><a href="#cb130-331" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-332"><a href="#cb130-332" aria-hidden="true" tabindex="-1"></a>dds_1_gg <span class="ot">&lt;-</span></span>
<span id="cb130-333"><a href="#cb130-333" aria-hidden="true" tabindex="-1"></a>  dds_1_est <span class="sc">|&gt;</span></span>
<span id="cb130-334"><a href="#cb130-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb130-335"><a href="#cb130-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-336"><a href="#cb130-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-337"><a href="#cb130-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-338"><a href="#cb130-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb130-339"><a href="#cb130-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-340"><a href="#cb130-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-341"><a href="#cb130-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb130-342"><a href="#cb130-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-343"><a href="#cb130-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-344"><a href="#cb130-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-345"><a href="#cb130-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-346"><a href="#cb130-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-347"><a href="#cb130-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-348"><a href="#cb130-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-349"><a href="#cb130-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-350"><a href="#cb130-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-351"><a href="#cb130-351" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-352"><a href="#cb130-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-353"><a href="#cb130-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-354"><a href="#cb130-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_an}</span></span>
<span id="cb130-355"><a href="#cb130-355" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-356"><a href="#cb130-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-357"><a href="#cb130-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-358"><a href="#cb130-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-359"><a href="#cb130-359" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.1"</span>,</span>
<span id="cb130-360"><a href="#cb130-360" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-361"><a href="#cb130-361" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-362"><a href="#cb130-362" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-363"><a href="#cb130-363" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-364"><a href="#cb130-364" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-365"><a href="#cb130-365" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-366"><a href="#cb130-366" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-367"><a href="#cb130-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_1_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-368"><a href="#cb130-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-369"><a href="#cb130-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-370"><a href="#cb130-370" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-371"><a href="#cb130-371" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-372"><a href="#cb130-372" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-373"><a href="#cb130-373" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-374"><a href="#cb130-374" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-375"><a href="#cb130-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-376"><a href="#cb130-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-377"><a href="#cb130-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_xp}</span></span>
<span id="cb130-378"><a href="#cb130-378" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-379"><a href="#cb130-379" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-380"><a href="#cb130-380" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_01.pdf"</span>),</span>
<span id="cb130-381"><a href="#cb130-381" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_01_af.pdf"</span>)</span>
<span id="cb130-382"><a href="#cb130-382" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-383"><a href="#cb130-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-384"><a href="#cb130-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-385"><a href="#cb130-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_01_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-386"><a href="#cb130-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-387"><a href="#cb130-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-388"><a href="#cb130-388" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-389"><a href="#cb130-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-390"><a href="#cb130-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-391"><a href="#cb130-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-392"><a href="#cb130-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 02</span></span>
<span id="cb130-393"><a href="#cb130-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-394"><a href="#cb130-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_02}</span></span>
<span id="cb130-395"><a href="#cb130-395" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-396"><a href="#cb130-396" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_1_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-397"><a href="#cb130-397" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-398"><a href="#cb130-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-399"><a href="#cb130-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-400"><a href="#cb130-400" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-401"><a href="#cb130-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-402"><a href="#cb130-402" aria-hidden="true" tabindex="-1"></a>dds_1_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb130-403"><a href="#cb130-403" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span id="cb130-404"><a href="#cb130-404" aria-hidden="true" tabindex="-1"></a>  dds_1_est<span class="sc">$</span>feature,</span>
<span id="cb130-405"><a href="#cb130-405" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">""</span></span>
<span id="cb130-406"><a href="#cb130-406" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-407"><a href="#cb130-407" aria-hidden="true" tabindex="-1"></a>dds_1_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_1_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb130-408"><a href="#cb130-408" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_1_est)</span>
<span id="cb130-409"><a href="#cb130-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-410"><a href="#cb130-410" aria-hidden="true" tabindex="-1"></a>dds_1_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb130-411"><a href="#cb130-411" aria-hidden="true" tabindex="-1"></a>  dds_1_est,</span>
<span id="cb130-412"><a href="#cb130-412" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb130-413"><a href="#cb130-413" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb130-414"><a href="#cb130-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-415"><a href="#cb130-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-416"><a href="#cb130-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-417"><a href="#cb130-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb130-418"><a href="#cb130-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb130-419"><a href="#cb130-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_1_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb130-420"><a href="#cb130-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb130-421"><a href="#cb130-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span></span>
<span id="cb130-422"><a href="#cb130-422" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-423"><a href="#cb130-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb130-424"><a href="#cb130-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_1_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb130-425"><a href="#cb130-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb130-426"><a href="#cb130-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb130-427"><a href="#cb130-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb130-428"><a href="#cb130-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb130-429"><a href="#cb130-429" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-430"><a href="#cb130-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-431"><a href="#cb130-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb130-432"><a href="#cb130-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-433"><a href="#cb130-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb130-434"><a href="#cb130-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-435"><a href="#cb130-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-436"><a href="#cb130-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-437"><a href="#cb130-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-438"><a href="#cb130-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-439"><a href="#cb130-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-440"><a href="#cb130-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-441"><a href="#cb130-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-442"><a href="#cb130-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-443"><a href="#cb130-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-444"><a href="#cb130-444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-445"><a href="#cb130-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-446"><a href="#cb130-446" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-447"><a href="#cb130-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-448"><a href="#cb130-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-449"><a href="#cb130-449" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-450"><a href="#cb130-450" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.2"</span>,</span>
<span id="cb130-451"><a href="#cb130-451" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-452"><a href="#cb130-452" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-453"><a href="#cb130-453" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-454"><a href="#cb130-454" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-455"><a href="#cb130-455" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-456"><a href="#cb130-456" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-457"><a href="#cb130-457" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-458"><a href="#cb130-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_1_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-459"><a href="#cb130-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-460"><a href="#cb130-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-461"><a href="#cb130-461" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-462"><a href="#cb130-462" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-463"><a href="#cb130-463" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-464"><a href="#cb130-464" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-465"><a href="#cb130-465" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-466"><a href="#cb130-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-467"><a href="#cb130-467" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-468"><a href="#cb130-468" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-469"><a href="#cb130-469" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_02.pdf"</span>),</span>
<span id="cb130-470"><a href="#cb130-470" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_02_af.pdf"</span>)</span>
<span id="cb130-471"><a href="#cb130-471" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-472"><a href="#cb130-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-473"><a href="#cb130-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-474"><a href="#cb130-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-475"><a href="#cb130-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_02_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-476"><a href="#cb130-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-477"><a href="#cb130-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-478"><a href="#cb130-478" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-479"><a href="#cb130-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-480"><a href="#cb130-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-481"><a href="#cb130-481" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_2` - DE: Baseline, mRNA</span></span>
<span id="cb130-482"><a href="#cb130-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-483"><a href="#cb130-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_dta}</span></span>
<span id="cb130-484"><a href="#cb130-484" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb130-485"><a href="#cb130-485" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb130-486"><a href="#cb130-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-487"><a href="#cb130-487" aria-hidden="true" tabindex="-1"></a>dds_2_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb130-488"><a href="#cb130-488" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb130-489"><a href="#cb130-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-490"><a href="#cb130-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_visit</span>(<span class="st">"Baseline"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-491"><a href="#cb130-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-492"><a href="#cb130-492" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb130-493"><a href="#cb130-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb130-494"><a href="#cb130-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb130-495"><a href="#cb130-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb130-496"><a href="#cb130-496" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb130-497"><a href="#cb130-497" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb130-498"><a href="#cb130-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-499"><a href="#cb130-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>()</span>
<span id="cb130-500"><a href="#cb130-500" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-501"><a href="#cb130-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-502"><a href="#cb130-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-503"><a href="#cb130-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_est}</span></span>
<span id="cb130-504"><a href="#cb130-504" aria-hidden="true" tabindex="-1"></a>dds_2_est <span class="ot">&lt;-</span></span>
<span id="cb130-505"><a href="#cb130-505" aria-hidden="true" tabindex="-1"></a>  dds_2_fit <span class="sc">|&gt;</span></span>
<span id="cb130-506"><a href="#cb130-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb130-507"><a href="#cb130-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb130-508"><a href="#cb130-508" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb130-509"><a href="#cb130-509" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb130-510"><a href="#cb130-510" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb130-511"><a href="#cb130-511" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-512"><a href="#cb130-512" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-513"><a href="#cb130-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _)</span>
<span id="cb130-514"><a href="#cb130-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-515"><a href="#cb130-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-516"><a href="#cb130-516" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 03</span></span>
<span id="cb130-517"><a href="#cb130-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-518"><a href="#cb130-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_gg}</span></span>
<span id="cb130-519"><a href="#cb130-519" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-520"><a href="#cb130-520" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_2_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-521"><a href="#cb130-521" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-522"><a href="#cb130-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-523"><a href="#cb130-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-524"><a href="#cb130-524" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-525"><a href="#cb130-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-526"><a href="#cb130-526" aria-hidden="true" tabindex="-1"></a>dds_2_gg <span class="ot">&lt;-</span></span>
<span id="cb130-527"><a href="#cb130-527" aria-hidden="true" tabindex="-1"></a>  dds_2_est <span class="sc">|&gt;</span></span>
<span id="cb130-528"><a href="#cb130-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb130-529"><a href="#cb130-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-530"><a href="#cb130-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-531"><a href="#cb130-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-532"><a href="#cb130-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb130-533"><a href="#cb130-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-534"><a href="#cb130-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-535"><a href="#cb130-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb130-536"><a href="#cb130-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-537"><a href="#cb130-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-538"><a href="#cb130-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-539"><a href="#cb130-539" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-540"><a href="#cb130-540" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-541"><a href="#cb130-541" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-542"><a href="#cb130-542" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-543"><a href="#cb130-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-544"><a href="#cb130-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-545"><a href="#cb130-545" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-546"><a href="#cb130-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-547"><a href="#cb130-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-548"><a href="#cb130-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_an}</span></span>
<span id="cb130-549"><a href="#cb130-549" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-550"><a href="#cb130-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-551"><a href="#cb130-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-552"><a href="#cb130-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-553"><a href="#cb130-553" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.3"</span>,</span>
<span id="cb130-554"><a href="#cb130-554" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-555"><a href="#cb130-555" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-556"><a href="#cb130-556" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-557"><a href="#cb130-557" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-558"><a href="#cb130-558" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-559"><a href="#cb130-559" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-560"><a href="#cb130-560" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-561"><a href="#cb130-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_2_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-562"><a href="#cb130-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-563"><a href="#cb130-563" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-564"><a href="#cb130-564" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-565"><a href="#cb130-565" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-566"><a href="#cb130-566" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-567"><a href="#cb130-567" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-568"><a href="#cb130-568" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-569"><a href="#cb130-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-570"><a href="#cb130-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-571"><a href="#cb130-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_xp}</span></span>
<span id="cb130-572"><a href="#cb130-572" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-573"><a href="#cb130-573" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-574"><a href="#cb130-574" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_03.pdf"</span>),</span>
<span id="cb130-575"><a href="#cb130-575" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_03_af.pdf"</span>)</span>
<span id="cb130-576"><a href="#cb130-576" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-577"><a href="#cb130-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-578"><a href="#cb130-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-579"><a href="#cb130-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_03_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-580"><a href="#cb130-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-581"><a href="#cb130-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-582"><a href="#cb130-582" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-583"><a href="#cb130-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-584"><a href="#cb130-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-585"><a href="#cb130-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-586"><a href="#cb130-586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 04</span></span>
<span id="cb130-587"><a href="#cb130-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-588"><a href="#cb130-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_04}</span></span>
<span id="cb130-589"><a href="#cb130-589" aria-hidden="true" tabindex="-1"></a>dds_2_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENSG0+"</span>, <span class="st">""</span>, dds_2_est<span class="sc">$</span>feature)</span>
<span id="cb130-590"><a href="#cb130-590" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_2_est)</span>
<span id="cb130-591"><a href="#cb130-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-592"><a href="#cb130-592" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-593"><a href="#cb130-593" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_2_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-594"><a href="#cb130-594" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-595"><a href="#cb130-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-596"><a href="#cb130-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-597"><a href="#cb130-597" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-598"><a href="#cb130-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-599"><a href="#cb130-599" aria-hidden="true" tabindex="-1"></a>dds_2_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dds_2_est, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj)) <span class="sc">+</span></span>
<span id="cb130-600"><a href="#cb130-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-601"><a href="#cb130-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-602"><a href="#cb130-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-603"><a href="#cb130-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb130-604"><a href="#cb130-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb130-605"><a href="#cb130-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_2_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb130-606"><a href="#cb130-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb130-607"><a href="#cb130-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span>,</span>
<span id="cb130-608"><a href="#cb130-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span></span>
<span id="cb130-609"><a href="#cb130-609" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-610"><a href="#cb130-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb130-611"><a href="#cb130-611" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_2_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb130-612"><a href="#cb130-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb130-613"><a href="#cb130-613" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb130-614"><a href="#cb130-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb130-615"><a href="#cb130-615" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb130-616"><a href="#cb130-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb130-617"><a href="#cb130-617" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-618"><a href="#cb130-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-619"><a href="#cb130-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb130-620"><a href="#cb130-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-621"><a href="#cb130-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb130-622"><a href="#cb130-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-623"><a href="#cb130-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-624"><a href="#cb130-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-625"><a href="#cb130-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-626"><a href="#cb130-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-627"><a href="#cb130-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-628"><a href="#cb130-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-629"><a href="#cb130-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-630"><a href="#cb130-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-631"><a href="#cb130-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-632"><a href="#cb130-632" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-633"><a href="#cb130-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-634"><a href="#cb130-634" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-635"><a href="#cb130-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-636"><a href="#cb130-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-637"><a href="#cb130-637" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-638"><a href="#cb130-638" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.4"</span>,</span>
<span id="cb130-639"><a href="#cb130-639" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-640"><a href="#cb130-640" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-641"><a href="#cb130-641" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-642"><a href="#cb130-642" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-643"><a href="#cb130-643" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-644"><a href="#cb130-644" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-645"><a href="#cb130-645" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-646"><a href="#cb130-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_2_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-647"><a href="#cb130-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-648"><a href="#cb130-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-649"><a href="#cb130-649" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-650"><a href="#cb130-650" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-651"><a href="#cb130-651" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-652"><a href="#cb130-652" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-653"><a href="#cb130-653" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-654"><a href="#cb130-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-655"><a href="#cb130-655" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-656"><a href="#cb130-656" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-657"><a href="#cb130-657" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_04.pdf"</span>),</span>
<span id="cb130-658"><a href="#cb130-658" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_04_af.pdf"</span>)</span>
<span id="cb130-659"><a href="#cb130-659" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-660"><a href="#cb130-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-661"><a href="#cb130-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-662"><a href="#cb130-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-663"><a href="#cb130-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_04_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-664"><a href="#cb130-664" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-665"><a href="#cb130-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-666"><a href="#cb130-666" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-667"><a href="#cb130-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-668"><a href="#cb130-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-669"><a href="#cb130-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-670"><a href="#cb130-670" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_3` - DE: Month 3, all micro RNA</span></span>
<span id="cb130-671"><a href="#cb130-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-672"><a href="#cb130-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_3_dta}</span></span>
<span id="cb130-673"><a href="#cb130-673" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb130-674"><a href="#cb130-674" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb130-675"><a href="#cb130-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-676"><a href="#cb130-676" aria-hidden="true" tabindex="-1"></a>dds_3_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb130-677"><a href="#cb130-677" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb130-678"><a href="#cb130-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-679"><a href="#cb130-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_visit</span>(<span class="st">"Month 3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-680"><a href="#cb130-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-681"><a href="#cb130-681" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb130-682"><a href="#cb130-682" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb130-683"><a href="#cb130-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb130-684"><a href="#cb130-684" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb130-685"><a href="#cb130-685" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb130-686"><a href="#cb130-686" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb130-687"><a href="#cb130-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-688"><a href="#cb130-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb130-689"><a href="#cb130-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span></span>
<span id="cb130-690"><a href="#cb130-690" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-691"><a href="#cb130-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-692"><a href="#cb130-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-693"><a href="#cb130-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-694"><a href="#cb130-694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_3_est}</span></span>
<span id="cb130-695"><a href="#cb130-695" aria-hidden="true" tabindex="-1"></a>dds_3_est <span class="ot">&lt;-</span></span>
<span id="cb130-696"><a href="#cb130-696" aria-hidden="true" tabindex="-1"></a>  dds_3_fit <span class="sc">|&gt;</span></span>
<span id="cb130-697"><a href="#cb130-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb130-698"><a href="#cb130-698" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb130-699"><a href="#cb130-699" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb130-700"><a href="#cb130-700" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb130-701"><a href="#cb130-701" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb130-702"><a href="#cb130-702" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-703"><a href="#cb130-703" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-704"><a href="#cb130-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _)</span>
<span id="cb130-705"><a href="#cb130-705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-706"><a href="#cb130-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-707"><a href="#cb130-707" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 05</span></span>
<span id="cb130-708"><a href="#cb130-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-709"><a href="#cb130-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_05}</span></span>
<span id="cb130-710"><a href="#cb130-710" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-711"><a href="#cb130-711" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_3_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-712"><a href="#cb130-712" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-713"><a href="#cb130-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-714"><a href="#cb130-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-715"><a href="#cb130-715" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-716"><a href="#cb130-716" aria-hidden="true" tabindex="-1"></a>dds_3_gg <span class="ot">&lt;-</span></span>
<span id="cb130-717"><a href="#cb130-717" aria-hidden="true" tabindex="-1"></a>  dds_3_est <span class="sc">|&gt;</span></span>
<span id="cb130-718"><a href="#cb130-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb130-719"><a href="#cb130-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-720"><a href="#cb130-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-721"><a href="#cb130-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-722"><a href="#cb130-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb130-723"><a href="#cb130-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-724"><a href="#cb130-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-725"><a href="#cb130-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb130-726"><a href="#cb130-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-727"><a href="#cb130-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-728"><a href="#cb130-728" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-729"><a href="#cb130-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-730"><a href="#cb130-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-731"><a href="#cb130-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-732"><a href="#cb130-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-733"><a href="#cb130-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-734"><a href="#cb130-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-735"><a href="#cb130-735" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-736"><a href="#cb130-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-737"><a href="#cb130-737" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-738"><a href="#cb130-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-739"><a href="#cb130-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-740"><a href="#cb130-740" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-741"><a href="#cb130-741" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.5"</span>,</span>
<span id="cb130-742"><a href="#cb130-742" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-743"><a href="#cb130-743" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-744"><a href="#cb130-744" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-745"><a href="#cb130-745" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-746"><a href="#cb130-746" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-747"><a href="#cb130-747" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-748"><a href="#cb130-748" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-749"><a href="#cb130-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_3_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-750"><a href="#cb130-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-751"><a href="#cb130-751" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-752"><a href="#cb130-752" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-753"><a href="#cb130-753" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-754"><a href="#cb130-754" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-755"><a href="#cb130-755" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-756"><a href="#cb130-756" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-757"><a href="#cb130-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-758"><a href="#cb130-758" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-759"><a href="#cb130-759" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-760"><a href="#cb130-760" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_05.pdf"</span>),</span>
<span id="cb130-761"><a href="#cb130-761" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_05_af.pdf"</span>)</span>
<span id="cb130-762"><a href="#cb130-762" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-763"><a href="#cb130-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-764"><a href="#cb130-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-765"><a href="#cb130-765" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_05_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-766"><a href="#cb130-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-767"><a href="#cb130-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-768"><a href="#cb130-768" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-769"><a href="#cb130-769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-770"><a href="#cb130-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-771"><a href="#cb130-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-772"><a href="#cb130-772" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 06</span></span>
<span id="cb130-773"><a href="#cb130-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-774"><a href="#cb130-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_06}</span></span>
<span id="cb130-775"><a href="#cb130-775" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-776"><a href="#cb130-776" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_3_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-777"><a href="#cb130-777" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-778"><a href="#cb130-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-779"><a href="#cb130-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-780"><a href="#cb130-780" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-781"><a href="#cb130-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-782"><a href="#cb130-782" aria-hidden="true" tabindex="-1"></a>dds_3_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb130-783"><a href="#cb130-783" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span id="cb130-784"><a href="#cb130-784" aria-hidden="true" tabindex="-1"></a>  dds_3_est<span class="sc">$</span>feature,</span>
<span id="cb130-785"><a href="#cb130-785" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">""</span></span>
<span id="cb130-786"><a href="#cb130-786" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-787"><a href="#cb130-787" aria-hidden="true" tabindex="-1"></a>dds_3_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_3_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb130-788"><a href="#cb130-788" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_3_est)</span>
<span id="cb130-789"><a href="#cb130-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-790"><a href="#cb130-790" aria-hidden="true" tabindex="-1"></a>dds_3_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb130-791"><a href="#cb130-791" aria-hidden="true" tabindex="-1"></a>  dds_3_est,</span>
<span id="cb130-792"><a href="#cb130-792" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb130-793"><a href="#cb130-793" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb130-794"><a href="#cb130-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-795"><a href="#cb130-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-796"><a href="#cb130-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-797"><a href="#cb130-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb130-798"><a href="#cb130-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb130-799"><a href="#cb130-799" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_3_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb130-800"><a href="#cb130-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb130-801"><a href="#cb130-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span></span>
<span id="cb130-802"><a href="#cb130-802" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-803"><a href="#cb130-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb130-804"><a href="#cb130-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_3_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb130-805"><a href="#cb130-805" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb130-806"><a href="#cb130-806" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb130-807"><a href="#cb130-807" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb130-808"><a href="#cb130-808" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb130-809"><a href="#cb130-809" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-810"><a href="#cb130-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-811"><a href="#cb130-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb130-812"><a href="#cb130-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-813"><a href="#cb130-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb130-814"><a href="#cb130-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-815"><a href="#cb130-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-816"><a href="#cb130-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-817"><a href="#cb130-817" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-818"><a href="#cb130-818" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-819"><a href="#cb130-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-820"><a href="#cb130-820" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-821"><a href="#cb130-821" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-822"><a href="#cb130-822" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-823"><a href="#cb130-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-824"><a href="#cb130-824" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-825"><a href="#cb130-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-826"><a href="#cb130-826" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-827"><a href="#cb130-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-828"><a href="#cb130-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-829"><a href="#cb130-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-830"><a href="#cb130-830" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.6"</span>,</span>
<span id="cb130-831"><a href="#cb130-831" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-832"><a href="#cb130-832" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-833"><a href="#cb130-833" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-834"><a href="#cb130-834" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-835"><a href="#cb130-835" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-836"><a href="#cb130-836" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-837"><a href="#cb130-837" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-838"><a href="#cb130-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_3_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-839"><a href="#cb130-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-840"><a href="#cb130-840" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-841"><a href="#cb130-841" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-842"><a href="#cb130-842" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-843"><a href="#cb130-843" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-844"><a href="#cb130-844" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-845"><a href="#cb130-845" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-846"><a href="#cb130-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-847"><a href="#cb130-847" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-848"><a href="#cb130-848" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-849"><a href="#cb130-849" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_06.pdf"</span>),</span>
<span id="cb130-850"><a href="#cb130-850" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_06_af.pdf"</span>)</span>
<span id="cb130-851"><a href="#cb130-851" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-852"><a href="#cb130-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-853"><a href="#cb130-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-854"><a href="#cb130-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-855"><a href="#cb130-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_06_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-856"><a href="#cb130-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-857"><a href="#cb130-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-858"><a href="#cb130-858" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-859"><a href="#cb130-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-860"><a href="#cb130-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-861"><a href="#cb130-861" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_4` - DE: Month 3, mRNA</span></span>
<span id="cb130-862"><a href="#cb130-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-863"><a href="#cb130-863" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_4_dta}</span></span>
<span id="cb130-864"><a href="#cb130-864" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb130-865"><a href="#cb130-865" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb130-866"><a href="#cb130-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-867"><a href="#cb130-867" aria-hidden="true" tabindex="-1"></a>dds_4_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb130-868"><a href="#cb130-868" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb130-869"><a href="#cb130-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-870"><a href="#cb130-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_visit</span>(<span class="st">"Month 3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-871"><a href="#cb130-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb130-872"><a href="#cb130-872" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb130-873"><a href="#cb130-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb130-874"><a href="#cb130-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb130-875"><a href="#cb130-875" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb130-876"><a href="#cb130-876" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb130-877"><a href="#cb130-877" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb130-878"><a href="#cb130-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb130-879"><a href="#cb130-879" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>()</span>
<span id="cb130-880"><a href="#cb130-880" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-881"><a href="#cb130-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-882"><a href="#cb130-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-883"><a href="#cb130-883" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_4_est}</span></span>
<span id="cb130-884"><a href="#cb130-884" aria-hidden="true" tabindex="-1"></a>dds_4_est <span class="ot">&lt;-</span></span>
<span id="cb130-885"><a href="#cb130-885" aria-hidden="true" tabindex="-1"></a>  dds_4_fit <span class="sc">|&gt;</span></span>
<span id="cb130-886"><a href="#cb130-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb130-887"><a href="#cb130-887" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb130-888"><a href="#cb130-888" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb130-889"><a href="#cb130-889" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb130-890"><a href="#cb130-890" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb130-891"><a href="#cb130-891" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-892"><a href="#cb130-892" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-893"><a href="#cb130-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _)</span>
<span id="cb130-894"><a href="#cb130-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-895"><a href="#cb130-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-896"><a href="#cb130-896" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 07</span></span>
<span id="cb130-897"><a href="#cb130-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-898"><a href="#cb130-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_07}</span></span>
<span id="cb130-899"><a href="#cb130-899" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-900"><a href="#cb130-900" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_4_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-901"><a href="#cb130-901" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-902"><a href="#cb130-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-903"><a href="#cb130-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-904"><a href="#cb130-904" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-905"><a href="#cb130-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-906"><a href="#cb130-906" aria-hidden="true" tabindex="-1"></a>dds_4_gg <span class="ot">&lt;-</span></span>
<span id="cb130-907"><a href="#cb130-907" aria-hidden="true" tabindex="-1"></a>  dds_4_est <span class="sc">|&gt;</span></span>
<span id="cb130-908"><a href="#cb130-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb130-909"><a href="#cb130-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-910"><a href="#cb130-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-911"><a href="#cb130-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-912"><a href="#cb130-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb130-913"><a href="#cb130-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-914"><a href="#cb130-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-915"><a href="#cb130-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb130-916"><a href="#cb130-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-917"><a href="#cb130-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-918"><a href="#cb130-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-919"><a href="#cb130-919" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-920"><a href="#cb130-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-921"><a href="#cb130-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-922"><a href="#cb130-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-923"><a href="#cb130-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-924"><a href="#cb130-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-925"><a href="#cb130-925" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-926"><a href="#cb130-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-927"><a href="#cb130-927" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-928"><a href="#cb130-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-929"><a href="#cb130-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-930"><a href="#cb130-930" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-931"><a href="#cb130-931" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.7"</span>,</span>
<span id="cb130-932"><a href="#cb130-932" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-933"><a href="#cb130-933" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-934"><a href="#cb130-934" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all mRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-935"><a href="#cb130-935" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-936"><a href="#cb130-936" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-937"><a href="#cb130-937" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-938"><a href="#cb130-938" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-939"><a href="#cb130-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_4_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-940"><a href="#cb130-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-941"><a href="#cb130-941" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-942"><a href="#cb130-942" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-943"><a href="#cb130-943" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-944"><a href="#cb130-944" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-945"><a href="#cb130-945" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-946"><a href="#cb130-946" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-947"><a href="#cb130-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-948"><a href="#cb130-948" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-949"><a href="#cb130-949" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-950"><a href="#cb130-950" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_07.pdf"</span>),</span>
<span id="cb130-951"><a href="#cb130-951" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_07_af.pdf"</span>)</span>
<span id="cb130-952"><a href="#cb130-952" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-953"><a href="#cb130-953" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-954"><a href="#cb130-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-955"><a href="#cb130-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_07_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-956"><a href="#cb130-956" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-957"><a href="#cb130-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-958"><a href="#cb130-958" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-959"><a href="#cb130-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-960"><a href="#cb130-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-961"><a href="#cb130-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-962"><a href="#cb130-962" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 08</span></span>
<span id="cb130-963"><a href="#cb130-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-964"><a href="#cb130-964" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_08}</span></span>
<span id="cb130-965"><a href="#cb130-965" aria-hidden="true" tabindex="-1"></a>dds_4_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENSG0+"</span>, <span class="st">""</span>, dds_4_est<span class="sc">$</span>feature)</span>
<span id="cb130-966"><a href="#cb130-966" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_4_est)</span>
<span id="cb130-967"><a href="#cb130-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-968"><a href="#cb130-968" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb130-969"><a href="#cb130-969" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_4_est<span class="sc">$</span>log_padj)</span>
<span id="cb130-970"><a href="#cb130-970" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb130-971"><a href="#cb130-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb130-972"><a href="#cb130-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb130-973"><a href="#cb130-973" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-974"><a href="#cb130-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-975"><a href="#cb130-975" aria-hidden="true" tabindex="-1"></a>dds_4_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dds_4_est, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj)) <span class="sc">+</span></span>
<span id="cb130-976"><a href="#cb130-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-977"><a href="#cb130-977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb130-978"><a href="#cb130-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb130-979"><a href="#cb130-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb130-980"><a href="#cb130-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb130-981"><a href="#cb130-981" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_4_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb130-982"><a href="#cb130-982" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb130-983"><a href="#cb130-983" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span>,</span>
<span id="cb130-984"><a href="#cb130-984" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span></span>
<span id="cb130-985"><a href="#cb130-985" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-986"><a href="#cb130-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb130-987"><a href="#cb130-987" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_4_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb130-988"><a href="#cb130-988" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb130-989"><a href="#cb130-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb130-990"><a href="#cb130-990" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb130-991"><a href="#cb130-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb130-992"><a href="#cb130-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb130-993"><a href="#cb130-993" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-994"><a href="#cb130-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb130-995"><a href="#cb130-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb130-996"><a href="#cb130-996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb130-997"><a href="#cb130-997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb130-998"><a href="#cb130-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-999"><a href="#cb130-999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-1000"><a href="#cb130-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb130-1001"><a href="#cb130-1001" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-1002"><a href="#cb130-1002" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb130-1003"><a href="#cb130-1003" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb130-1004"><a href="#cb130-1004" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-1005"><a href="#cb130-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb130-1006"><a href="#cb130-1006" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb130-1007"><a href="#cb130-1007" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb130-1008"><a href="#cb130-1008" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-1009"><a href="#cb130-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1010"><a href="#cb130-1010" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-1011"><a href="#cb130-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-1012"><a href="#cb130-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb130-1013"><a href="#cb130-1013" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-1014"><a href="#cb130-1014" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.8"</span>,</span>
<span id="cb130-1015"><a href="#cb130-1015" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb130-1016"><a href="#cb130-1016" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb130-1017"><a href="#cb130-1017" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among mRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb130-1018"><a href="#cb130-1018" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb130-1019"><a href="#cb130-1019" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb130-1020"><a href="#cb130-1020" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb130-1021"><a href="#cb130-1021" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb130-1022"><a href="#cb130-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_4_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb130-1023"><a href="#cb130-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb130-1024"><a href="#cb130-1024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb130-1025"><a href="#cb130-1025" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb130-1026"><a href="#cb130-1026" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb130-1027"><a href="#cb130-1027" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb130-1028"><a href="#cb130-1028" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb130-1029"><a href="#cb130-1029" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb130-1030"><a href="#cb130-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1031"><a href="#cb130-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb130-1032"><a href="#cb130-1032" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb130-1033"><a href="#cb130-1033" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_08.pdf"</span>),</span>
<span id="cb130-1034"><a href="#cb130-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_08_af.pdf"</span>)</span>
<span id="cb130-1035"><a href="#cb130-1035" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-1036"><a href="#cb130-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1037"><a href="#cb130-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1038"><a href="#cb130-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1039"><a href="#cb130-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_08_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb130-1040"><a href="#cb130-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb130-1041"><a href="#cb130-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb130-1042"><a href="#cb130-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb130-1043"><a href="#cb130-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1044"><a href="#cb130-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1045"><a href="#cb130-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1046"><a href="#cb130-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Informations</span></span>
<span id="cb130-1047"><a href="#cb130-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1050"><a href="#cb130-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1051"><a href="#cb130-1051" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb130-1052"><a href="#cb130-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, FCA Collin, Ph.D.</div>
  </div>
</footer>


</body></html>