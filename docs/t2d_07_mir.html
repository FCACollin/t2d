<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Francois Collin">
<meta name="dcterms.date" content="2022-12-12">
<title>T2D: Exercise and Genetic Expression Profile - 5&nbsp; mRNA / micro RNA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./t2d_11_wcn.html" rel="next">
<link href="./t2d_06_rna.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">T2D: Exercise and Genetic Expression Profile</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/FCACollin/t2d" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preamble</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_03_bds.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Missingness in adlb and advs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_08_dmg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Demographics and Baseline Anthropometrics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_09_chg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Anthropometrics Changes From Baseline</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_06_rna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_07_mir.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_11_wcn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">WGCNA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./t2d_13_gea.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">GSEA / DE Results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#mirna-seq---differential-expression-analysis" id="toc-mirna-seq---differential-expression-analysis" class="nav-link active" data-scroll-target="#mirna-seq---differential-expression-analysis"> <span class="header-section-number">5.1</span> miRNA Seq - Differential expression analysis</a>
  <ul class="collapse">
<li>
<a href="#materials-and-methods" id="toc-materials-and-methods" class="nav-link" data-scroll-target="#materials-and-methods"> <span class="header-section-number">5.1.1</span> Materials and Methods</a>
  <ul class="collapse">
<li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions"> <span class="header-section-number">5.1.1.1</span> Helper functions</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"> <span class="header-section-number">5.1.1.2</span> Data preparation</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#sample-depth-threshold-determination" id="toc-sample-depth-threshold-determination" class="nav-link" data-scroll-target="#sample-depth-threshold-determination"> <span class="header-section-number">5.2</span> Sample depth threshold determination</a>
  <ul class="collapse">
<li><a href="#mirna" id="toc-mirna" class="nav-link" data-scroll-target="#mirna"> <span class="header-section-number">5.2.1</span> miRNA</a></li>
  <li><a href="#mrna" id="toc-mrna" class="nav-link" data-scroll-target="#mrna"> <span class="header-section-number">5.2.2</span> mRNA</a></li>
  </ul>
</li>
  <li>
<a href="#dds_1---de-baseline-all-micro-rna" id="toc-dds_1---de-baseline-all-micro-rna" class="nav-link" data-scroll-target="#dds_1---de-baseline-all-micro-rna"> <span class="header-section-number">5.3</span> <code>dds_1</code> - DE: Baseline, all micro RNA</a>
  <ul class="collapse">
<li><a href="#fig-07-01" id="toc-fig-07-01" class="nav-link" data-scroll-target="#fig-07-01"> <span class="header-section-number">5.3.1</span> Fig 07 01</a></li>
  <li><a href="#fig-07-02" id="toc-fig-07-02" class="nav-link" data-scroll-target="#fig-07-02"> <span class="header-section-number">5.3.2</span> Fig 07 02</a></li>
  </ul>
</li>
  <li>
<a href="#dds_2---de-baseline-mrna" id="toc-dds_2---de-baseline-mrna" class="nav-link" data-scroll-target="#dds_2---de-baseline-mrna"> <span class="header-section-number">5.4</span> <code>dds_2</code> - DE: Baseline, mRNA</a>
  <ul class="collapse">
<li><a href="#fig-07-03" id="toc-fig-07-03" class="nav-link" data-scroll-target="#fig-07-03"> <span class="header-section-number">5.4.1</span> Fig 07 03</a></li>
  <li><a href="#fig-07-04" id="toc-fig-07-04" class="nav-link" data-scroll-target="#fig-07-04"> <span class="header-section-number">5.4.2</span> Fig 07 04</a></li>
  </ul>
</li>
  <li>
<a href="#dds_3---de-month-3-all-micro-rna" id="toc-dds_3---de-month-3-all-micro-rna" class="nav-link" data-scroll-target="#dds_3---de-month-3-all-micro-rna"> <span class="header-section-number">5.5</span> <code>dds_3</code> - DE: Month 3, all micro RNA</a>
  <ul class="collapse">
<li><a href="#fig-07-05" id="toc-fig-07-05" class="nav-link" data-scroll-target="#fig-07-05"> <span class="header-section-number">5.5.1</span> Fig 07 05</a></li>
  <li><a href="#fig-07-06" id="toc-fig-07-06" class="nav-link" data-scroll-target="#fig-07-06"> <span class="header-section-number">5.5.2</span> Fig 07 06</a></li>
  </ul>
</li>
  <li>
<a href="#dds_4---de-month-3-mrna" id="toc-dds_4---de-month-3-mrna" class="nav-link" data-scroll-target="#dds_4---de-month-3-mrna"> <span class="header-section-number">5.6</span> <code>dds_4</code> - DE: Month 3, mRNA</a>
  <ul class="collapse">
<li><a href="#fig-07-07" id="toc-fig-07-07" class="nav-link" data-scroll-target="#fig-07-07"> <span class="header-section-number">5.6.1</span> Fig 07 07</a></li>
  <li><a href="#fig-07-08" id="toc-fig-07-08" class="nav-link" data-scroll-target="#fig-07-08"> <span class="header-section-number">5.6.2</span> Fig 07 08</a></li>
  </ul>
</li>
  <li>
<a href="#dds_5---de-exercise-intervention-all-micro-rna" id="toc-dds_5---de-exercise-intervention-all-micro-rna" class="nav-link" data-scroll-target="#dds_5---de-exercise-intervention-all-micro-rna"> <span class="header-section-number">5.7</span> <code>dds_5</code> - DE: Exercise intervention, all micro RNA</a>
  <ul class="collapse">
<li><a href="#fig-07-09" id="toc-fig-07-09" class="nav-link" data-scroll-target="#fig-07-09"> <span class="header-section-number">5.7.1</span> Fig 07 09</a></li>
  <li><a href="#fig-07-10" id="toc-fig-07-10" class="nav-link" data-scroll-target="#fig-07-10"> <span class="header-section-number">5.7.2</span> Fig 07 10</a></li>
  </ul>
</li>
  <li>
<a href="#dds_6---de-exercise-intervention-mrna" id="toc-dds_6---de-exercise-intervention-mrna" class="nav-link" data-scroll-target="#dds_6---de-exercise-intervention-mrna"> <span class="header-section-number">5.8</span> <code>dds_6</code> - DE: Exercise intervention, mRNA</a>
  <ul class="collapse">
<li><a href="#fig-07-11" id="toc-fig-07-11" class="nav-link" data-scroll-target="#fig-07-11"> <span class="header-section-number">5.8.1</span> Fig 07 11</a></li>
  <li><a href="#fig-07-12" id="toc-fig-07-12" class="nav-link" data-scroll-target="#fig-07-12"> <span class="header-section-number">5.8.2</span> Fig 07 12</a></li>
  </ul>
</li>
  <li><a href="#session-informations" id="toc-session-informations" class="nav-link" data-scroll-target="#session-informations"> <span class="header-section-number">5.9</span> Session Informations</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/FCACollin/t2d/edit/main/t2d_07_mir.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">mRNA / micro RNA</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Program 07</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Francois Collin </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 12, 2022</p>
    </div>
  </div>
    
  </div>
  

</header><section id="mirna-seq---differential-expression-analysis" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="mirna-seq---differential-expression-analysis">
<span class="header-section-number">5.1</span> miRNA Seq - Differential expression analysis</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cfg_prog</span> <span class="op">&lt;-</span> <span class="fu">yaml</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yaml/man/read_yaml.html">read_yaml</a></span><span class="op">(</span><span class="st">"_prog.yml"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The variation in messenger RNA (mRNA) and micro-RNA (miRNA) abundance measured by RNA-Seq associated either with the dysglycemia and/or the 3-month exercise intervention were investigated by a Differential Expression analysis (DE). At baseline, the DE models included only the effect of the dysglycemia-constrast group, consistently with the Anova model applied for demographics and baseline anthropometrics. To do so, genetic features which were never found expressed were discarded. Then RNA-Seq libraries were included if reaching a read depth threshold (total number of reads per sample) fixed by visual examination of the association between sample gene diversity and sample depth. For the remaining libraries, genetic features were included if the count per million reads (CPM) was greater than 2 in at least 50% of the samples. The DE analysis implementation proposed by <span class="citation" data-cites="Love2014">Love, Huber, and Anders (<a href="references.html#ref-Love2014" role="doc-biblioref">2014</a>)</span> with the R package <code>DESeq2</code> was used to fit the models; it is based on a negative binomial distribution accounting for read variability, dispersion corrected after trends seen across all samples and genes <span class="citation" data-cites="Duendar2018">(<a href="references.html#ref-Duendar2018" role="doc-biblioref">Dündar, Skrabanek, and Zumbo 2018</a>)</span>. In addition, the number of tested genes being high, raw p.values were adjusted according to Benjamini and Hochberg’s method also known as False-Discovery Rate (FDR).</p>
<p>The analysis was realized with R <span class="citation" data-cites="RCT2022">(v4.2.0, <a href="references.html#ref-RCT2022" role="doc-biblioref">R Core Team 2022</a>)</span>. Note the use of the additional packages downloaded from the RStudio package manager repository (freeze date 2022-05-04, <a href="https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU">repos</a>):</p>
<ul>
<li>
<code>DESeq2</code> for differential expression analysis and variance stabilizing transformation <span class="citation" data-cites="Love2014">(version 1.36.0, <a href="references.html#ref-Love2014" role="doc-biblioref">Love, Huber, and Anders 2014</a>)</span>
</li>
<li>
<code>ggplot2</code> for graphics <span class="citation" data-cites="Wickham2016">(version 3.3.6, <a href="references.html#ref-Wickham2016" role="doc-biblioref">Wickham 2016</a>)</span>
</li>
<li>
<code>MultiAssayExperiment</code> for management of multi-omics experiment objects <span class="citation" data-cites="Ramos2017">(version 1.22.0, <a href="references.html#ref-Ramos2017" role="doc-biblioref">Ramos et al. 2017</a>)</span>.</li>
</ul>
<p>Target:</p>
<ul class="task-list">
<li>
<input type="checkbox" disabled="" checked="">
miRNA DE at baseline without confounding factors.</li>
<li>
<input type="checkbox" disabled="" checked="">
mRNA DE at baseline without confounding factors.</li>
<li>
<input type="checkbox" disabled="" checked="">
miRNA DE at month 3 without confounding factors.</li>
<li>
<input type="checkbox" disabled="" checked="">
mRNA DE at month 3 without confounding factors.</li>
<li>
<input type="checkbox" disabled="" checked="">
miRNA DE variation induced by the exercise intervention.</li>
<li>
<input type="checkbox" disabled="" checked="">
mRNA DE variation induced by the exercise intervention.</li>
</ul>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/dbs.data"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading dbs.data</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html">load_all</a></span><span class="op">(</span><span class="st">"src/pkg/latarnia.utils"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>ℹ Loading latarnia.utils
Loading required package: grid

Loading required package: shiny</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>results <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">knitr</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">assertthat</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/ngs.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/inches.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"R/export_xl.R"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="materials-and-methods" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="materials-and-methods">
<span class="header-section-number">5.1.1</span> Materials and Methods</h3>
<section id="helper-functions" class="level4" data-number="5.1.1.1"><h4 data-number="5.1.1.1" class="anchored" data-anchor-id="helper-functions">
<span class="header-section-number">5.1.1.1</span> Helper functions</h4>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Help for data pre-processing</span></span>
<span><span class="va">filter_for_depth</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">assay</span>, <span class="va">min_depth</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">min_depth</span>, <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">filter_for_coldata</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">col</span> <span class="op">=</span> <span class="st">"avisit"</span>, <span class="va">is</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mae</span><span class="op">[</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">is</span>, <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">filter_for_low_expr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span>, <span class="va">assay</span>, <span class="va">min_cpm</span>,</span>
<span>                                <span class="va">frac_cols</span> <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">$</span><span class="va">fraccol</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Genes expressed at least cpm_threshold in frac_cols columns</span></span>
<span>  <span class="va">mae</span><span class="op">[</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">cpm</span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">min_cpm</span><span class="op">)</span> <span class="op">&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">mae</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">frac_cols</span>,</span>
<span>    ,</span>
<span>  <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Differential expression helper functions:</span></span>
<span><span class="va">de_by_ctrs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>,</span>
<span>                       <span class="va">ctrs</span>,</span>
<span>                       <span class="va">adj_meth</span> <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">ctrs</span>,</span>
<span>    fit <span class="op">=</span> <span class="va">df</span>,</span>
<span>    adj_meth <span class="op">=</span> <span class="va">adj_meth</span>,</span>
<span>    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">fit</span>, <span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html">results</a></span><span class="op">(</span><span class="va">fit</span>, contrast <span class="op">=</span> <span class="va">x</span>, pAdjustMethod <span class="op">=</span> <span class="va">adj_meth</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">log_padj</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">ctrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"test"</span><span class="op">]</span>, <span class="st">"vs"</span>, <span class="va">x</span><span class="op">[</span><span class="st">"ref"</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data-preparation" class="level4" data-number="5.1.1.2"><h4 data-number="5.1.1.2" class="anchored" data-anchor-id="data-preparation">
<span class="header-section-number">5.1.1.2</span> Data preparation</h4>
<div class="cell">
<details open=""><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adsl</span></span>
<span><span class="va">advs</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">advs</span></span>
<span><span class="va">adlb</span> <span class="op">&lt;-</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">adlb</span></span>
<span></span>
<span><span class="co">#' Subjid and Visit to Sample</span></span>
<span><span class="co">#' </span></span>
<span><span class="va">subjvis_to_spl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">subjid</span>, <span class="st">"v"</span>, <span class="va">df</span><span class="op">$</span><span class="va">avisitn</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ads</span> <span class="op">&lt;-</span> <span class="va">adlb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">advs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ct</span>, <span class="va">dtype</span>, <span class="va">param</span>, <span class="va">base</span>, <span class="va">basetype</span>, <span class="va">chg</span>, <span class="va">pchg</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"paramcd"</span>, values_from <span class="op">=</span> <span class="st">"aval"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">adsl</span>, y <span class="op">=</span> <span class="va">_</span>, by <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="fu">S4Vectors</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html">DataFrame</a></span><span class="op">(</span><span class="va">df</span>, row.names <span class="op">=</span> <span class="fu">subjvis_to_spl</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">subjid</span>, <span class="va">diabcd</span>, <span class="va">diab</span>, <span class="va">avisitn</span>, <span class="va">avisit</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">assertthat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu">subjvis_to_spl</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">advs</span>, <span class="va">adlb</span><span class="op">)</span></span>
<span><span class="va">ads</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  mrna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">mrna_raw</span>,</span>
<span>  premirna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">premirna_raw</span>,</span>
<span>  mirna <span class="op">=</span> <span class="fu">dbs.data</span><span class="fu">::</span><span class="va">mirna_raw</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"premirna"</span>, <span class="st">"mirna"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">rna</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"premirna"</span>, <span class="st">"mirna"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">format_mirna</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rows represent genes</span></span>
<span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, <span class="va">as.matrix</span><span class="op">)</span></span>
<span><span class="fu">assertthat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">premirna</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">mirna</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rna</span><span class="op">$</span><span class="va">allmirna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">rna</span><span class="op">$</span><span class="va">premirna</span>, <span class="va">rna</span><span class="op">$</span><span class="va">mirna</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org">testthat</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_that.html">test_that</a></span><span class="op">(</span><span class="st">"rna features discriminated in noexpr, expr"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">rna</span>, FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html">expect_true</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://waldronlab.io/MultiAssayExperiment/">MultiAssayExperiment</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: SummarizedExperiment</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MatrixGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: matrixStats</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MatrixGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,
    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,
    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,
    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,
    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,
    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,
    colWeightedMeans, colWeightedMedians, colWeightedSds,
    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,
    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,
    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,
    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,
    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,
    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,
    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,
    rowWeightedSds, rowWeightedVars</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomicRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, append, as.data.frame, basename, cbind, colnames,
    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Biobase'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MatrixGenerics':

    rowMedians</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:matrixStats':

    anyMissing, rowMedians</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' (Sample-)Map Arrays</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Use the column names of `x` to deduce the `primary` and `colnames`.</span></span>
<span><span class="co">#' This is used to generate the sample mapping between colData and Experiments.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param x (`dataframe`).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @note In our case, primary and colnames are equivalent, colnames could</span></span>
<span><span class="co">#' be different from primary names when a biological sample has different</span></span>
<span><span class="co">#' names in the biological assays (e.g. machine constraint, technical</span></span>
<span><span class="co">#' repetitions).</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @seealso [MultiAssayExperiment::listToMap()]</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' \dontrun{</span></span>
<span><span class="co">#'   lapply(rna, map_arrays)</span></span>
<span><span class="co">#'   MultiAssayExperiment::listToMap(lapply(rna, map_arrays))</span></span>
<span><span class="co">#' }</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">map_arrays</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>colname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">y</span><span class="op">$</span><span class="va">primary</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="va">colname</span></span>
<span>  <span class="va">y</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">besd_mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment.html">MultiAssayExperiment</a></span><span class="op">(</span></span>
<span>  experiments <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/ExperimentList.html">ExperimentList</a></span><span class="op">(</span><span class="va">rna</span><span class="op">)</span>,</span>
<span>  colData <span class="op">=</span> <span class="va">ads</span>,</span>
<span>  sampleMap <span class="op">=</span> <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/mapToList.html">listToMap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">rna</span>, <span class="va">map_arrays</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">rna</span>, <span class="va">ads</span><span class="op">)</span></span>
<span><span class="va">besd_mae</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="sample-depth-threshold-determination" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sample-depth-threshold-determination">
<span class="header-section-number">5.2</span> Sample depth threshold determination</h2>
<p>A scatter plot representing sample gene diversity in relationship with sample depth evidenced a threshold for miRNA reads at 5e+06 reads for which approximately a million read increase was associated with more than a 2-fold increase in gene diversity. The depth threshold for mRNA was fixed at , although with a less important but still substantial drop in gene variety below that threshold.</p>
<section id="mirna" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="mirna">
<span class="header-section-number">5.2.1</span> miRNA</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Static figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Interactive figure</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vline</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  depth  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>  <span class="va">dtaplot</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dtaplot</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">depth</span>, y <span class="op">=</span> <span class="va">n_gene</span>, colour <span class="op">=</span> <span class="va">diab</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">vline</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sample depth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Gene diversity (number of genes with reads)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">vline</span>, <span class="va">dtaplot</span>, <span class="va">assay</span>, <span class="va">gg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in rm(vline, dtaplot, assay, gg): object 'vline' not found</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rm(vline, dtaplot, assay, gg): object 'dtaplot' not found</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rm(vline, dtaplot, assay, gg): object 'gg' not found</code></pre>
</div>
</div>
</section><section id="mrna" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="mrna">
<span class="header-section-number">5.2.2</span> mRNA</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Static figure</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Interactive figure</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vline</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[[</span><span class="va">assay</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  n_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  depth  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dtaplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>  <span class="va">dtaplot</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dtaplot</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dtaplot</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">depth</span>, y <span class="op">=</span> <span class="va">n_gene</span>, colour <span class="op">=</span> <span class="va">diab</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">vline</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Sample depth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Gene diversity (number of genes with reads)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>:::</p>
</section></section><section id="dds_1---de-baseline-all-micro-rna" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="dds_1---de-baseline-all-micro-rna">
<span class="header-section-number">5.3</span> <code>dds_1</code> - DE: Baseline, all micro RNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span></span>
<span></span>
<span><span class="va">dds_1_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_depth <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_coldata</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"avisit"</span>, is <span class="op">=</span> <span class="st">"Baseline"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_cpm <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    frac_cols <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">$</span><span class="va">fraccol</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fitType <span class="op">=</span> <span class="st">"local"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_1_est</span> <span class="op">&lt;-</span> <span class="va">dds_1_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_ctrs</span><span class="op">(</span></span>
<span>    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-01" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="fig-07-01">
<span class="header-section-number">5.3.1</span> Fig 07 01</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dds_1_gg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_1_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.1"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_1_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_01.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_01_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_01.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_01_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_01 <span class="op">=</span> <span class="va">dds_1_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span></span>
<span>      <span class="st">"miRNA at baseline - differential expression by diabetes group"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_01"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_01.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-02" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="fig-07-02">
<span class="header-section-number">5.3.2</span> Fig 07 02</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span></span>
<span>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span>  <span class="va">dds_1_est</span><span class="op">$</span><span class="va">feature</span>,</span>
<span>  replacement <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_1_est</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_1_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dds_1_est</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_1_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_1_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.2"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_1_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_02.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_02_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_02.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_02_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">ctrl</span>, <span class="va">ngs_assay</span>, <span class="va">dds_1_fit</span>, <span class="va">pval</span>, <span class="va">log_adj</span>, <span class="va">brk</span>, <span class="va">dds_1_gg</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_2---de-baseline-mrna" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="dds_2---de-baseline-mrna">
<span class="header-section-number">5.4</span> <code>dds_2</code> - DE: Baseline, mRNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span></span>
<span></span>
<span><span class="va">dds_2_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_depth <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_coldata</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"avisit"</span>, is <span class="op">=</span> <span class="st">"Baseline"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_cpm <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_2_est</span> <span class="op">&lt;-</span> <span class="va">dds_2_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_ctrs</span><span class="op">(</span></span>
<span>    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ndegenes</span> <span class="op">&lt;-</span> <span class="va">dds_2_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">padj</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ndegenes</span> <span class="op">/</span> <span class="va">ngenes</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">dds_2_est</span><span class="op">$</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">padj</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">pct_de_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ndegenes</span> <span class="op">/</span> <span class="va">ngenes</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">genes_nsub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">besd_mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">genes_de_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  Overall <span class="op">=</span> <span class="va">dds_2_est</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">padj</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  ,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">dds_2_est</span><span class="op">$</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">padj</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.001</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes_nsub</span></span>
<span><span class="va">genes_de_n</span></span>
<span><span class="va">genes_de_pct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">genes_de_n</span> <span class="op">/</span> <span class="va">genes_nsub</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-03" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="fig-07-03">
<span class="header-section-number">5.4.1</span> Fig 07 03</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_2_gg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_2_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.3"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among mRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_2_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_03.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_03_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_03.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_03_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_03 <span class="op">=</span> <span class="va">dds_2_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span></span>
<span>      <span class="st">"mRNA at baseline - differential expression by diabetes group"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_03"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_03.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-04" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="fig-07-04">
<span class="header-section-number">5.4.2</span> Fig 07 04</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_2_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ENSG0+"</span>, <span class="st">""</span>, <span class="va">dds_2_est</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_2_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_2_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dds_2_est</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"royalblue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_2_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"royalblue"</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.4"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all miRNA at Baseline"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_2_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_04.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_04_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_04.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_04_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_3---de-month-3-all-micro-rna" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="dds_3---de-month-3-all-micro-rna">
<span class="header-section-number">5.5</span> <code>dds_3</code> - DE: Month 3, all micro RNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span></span>
<span></span>
<span><span class="va">dds_3_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_depth <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_coldata</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"avisit"</span>, is <span class="op">=</span> <span class="st">"Month 3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_cpm <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fitType <span class="op">=</span> <span class="st">"local"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 13 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_3_est</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_3_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_ctrs</span><span class="op">(</span></span>
<span>    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-05" class="level3" data-number="5.5.1"><h3 data-number="5.5.1" class="anchored" data-anchor-id="fig-07-05">
<span class="header-section-number">5.5.1</span> Fig 07 05</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dds_3_gg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_3_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.5"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all miRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_3_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 350 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_05.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_05_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_05.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_05_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_05 <span class="op">=</span> <span class="va">dds_3_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span></span>
<span>      <span class="st">"All miRNA at month 3 - differential expression by diabetes group"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_05"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_05.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-06" class="level3" data-number="5.5.2"><h3 data-number="5.5.2" class="anchored" data-anchor-id="fig-07-06">
<span class="header-section-number">5.5.2</span> Fig 07 06</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span></span>
<span>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span>  <span class="va">dds_3_est</span><span class="op">$</span><span class="va">feature</span>,</span>
<span>  replacement <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_3_est</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_3_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dds_3_est</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_3_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_3_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.6"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all miRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_3_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 350 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_06.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_06_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_06.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_06_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_4---de-month-3-mrna" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="dds_4---de-month-3-mrna">
<span class="header-section-number">5.6</span> <code>dds_4</code> - DE: Month 3, mRNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span></span>
<span></span>
<span><span class="va">dds_4_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_depth <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_coldata</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"avisit"</span>, is <span class="op">=</span> <span class="st">"Month 3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span></span>
<span>    assay <span class="op">=</span> <span class="va">ngs_assay</span>,</span>
<span>    min_cpm <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>    countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>    design <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="op">~</span> <span class="va">diabcd</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- replacing outliers and refitting for 21 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fitting model and testing</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_4_est</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_4_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_ctrs</span><span class="op">(</span></span>
<span>    ctrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"T2D"</span>, ref <span class="op">=</span> <span class="st">"IGT"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, test <span class="op">=</span> <span class="st">"IGT"</span>, ref <span class="op">=</span> <span class="st">"NGT"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-07" class="level3" data-number="5.6.1"><h3 data-number="5.6.1" class="anchored" data-anchor-id="fig-07-07">
<span class="header-section-number">5.6.1</span> Fig 07 07</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_4_gg</span> <span class="op">&lt;-</span> <span class="va">dds_4_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># All pval close to 1 disturbe the hex-density plots</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">padj</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">ctrs</span> <span class="op">==</span> <span class="st">"IGT vs NGT"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.991</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ctrs</span> <span class="op">!=</span> <span class="st">"IGT vs NGT"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.7"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among all mRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_4_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_note</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"NOTE: all feature comparisons between IGT and NGT were characterised by</span></span>
<span><span class="st">    adjusted p.values greater than 0.99; to preserve the hexagonal-density</span></span>
<span><span class="st">    plot, this comparison was not represented."</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_07.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_07_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_07.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_07_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_07 <span class="op">=</span> <span class="va">dds_4_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span></span>
<span>      <span class="st">"mRNA at month 3 - differential expression by diabetes group"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_07"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_07.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-08" class="level3" data-number="5.6.2"><h3 data-number="5.6.2" class="anchored" data-anchor-id="fig-07-08">
<span class="header-section-number">5.6.2</span> Fig 07 08</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_4_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ENSG0+"</span>, <span class="st">""</span>, <span class="va">dds_4_est</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_4_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_4_gg</span> <span class="op">&lt;-</span> <span class="va">dds_4_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># All pval close to 1 disturbe the hex-density plots</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">padj</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">ctrs</span> <span class="op">==</span> <span class="st">"IGT vs NGT"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.991</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ctrs</span> <span class="op">!=</span> <span class="st">"IGT vs NGT"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_4_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"royalblue"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_4_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.001</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"royalblue"</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.8"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span><span class="st">        Expression among mRNA at Month 3"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_4_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_note</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"NOTE: all feature comparisons between IGT and NGT were characterised by</span></span>
<span><span class="st">    adjusted p.values greater than 0.99; to preserve the hexagonal-density</span></span>
<span><span class="st">    plot, this comparison was not represented."</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_08.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_08_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_08.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_08_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_5---de-exercise-intervention-all-micro-rna" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="dds_5---de-exercise-intervention-all-micro-rna">
<span class="header-section-number">5.7</span> <code>dds_5</code> - DE: Exercise intervention, all micro RNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"allmirna"</span></span>
<span></span>
<span><span class="va">filter_for_paired_visits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">subj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span></span>
<span>  <span class="va">subj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">subj</span><span class="op">[</span><span class="va">subj</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">mae</span> <span class="op">&lt;-</span> <span class="va">mae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">subj</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">chk_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">chk_df</span>, f <span class="op">=</span> <span class="va">chk_df</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Verify the selection:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">check</span>, subj <span class="op">=</span> <span class="va">subj</span>,\<span class="op">(</span><span class="va">x</span>, <span class="va">subj</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">subj</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">x</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mae</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dds_5_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_paired_visits</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># &lt;https://support.bioconductor.org/p/84241/#84296&gt;</span></span>
<span>    <span class="co"># Or:</span></span>
<span>    <span class="co"># vignette('DESeq2'),</span></span>
<span>    <span class="co"># &gt; Section: "Group-specific condition effects, individuals nested</span></span>
<span>    <span class="co"># &gt; within groups"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span>,</span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, <span class="st">"subjid"</span>, <span class="st">"avisit_"</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span></span>
<span>      <span class="va">rbind</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">coldata</span>,</span>
<span>        INDICES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">coldata</span><span class="op">$</span><span class="va">diabcd</span><span class="op">)</span>,</span>
<span>        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">subjid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span><span class="co"># nolint</span></span>
<span>          <span class="va">x</span><span class="op">$</span><span class="va">P.n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="co"># nolint</span></span>
<span>            <span class="va">subjid</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">subjid</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P."</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">subjid</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>          <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">subjid</span>, <span class="va">x</span><span class="op">$</span><span class="va">diabcd</span><span class="op">)</span>, <span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="va">coldata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="va">dsgn</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="va">diabcd</span> <span class="op">+</span> <span class="va">diabcd</span><span class="op">:</span><span class="va">P.n</span> <span class="op">+</span> <span class="va">diabcd</span><span class="op">:</span><span class="va">avisit_</span>,</span>
<span>      <span class="va">coldata</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">dsgn</span> <span class="op">&lt;-</span> <span class="va">dsgn</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dsgn</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>      countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>      design <span class="op">=</span> <span class="va">dsgn</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fitType <span class="op">=</span> <span class="st">"local"</span>,</span>
<span>    betaPrior <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>using supplied model matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">de_by_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>,</span>
<span>                       <span class="va">name</span>,</span>
<span>                       <span class="va">adj_meth</span> <span class="op">=</span> <span class="va">ctrl</span><span class="op">$</span><span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">name</span>,</span>
<span>    fit <span class="op">=</span> <span class="va">df</span>,</span>
<span>    adj_meth <span class="op">=</span> <span class="va">adj_meth</span>,</span>
<span>    FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">fit</span>, <span class="va">adj_meth</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/results.html">results</a></span><span class="op">(</span><span class="va">fit</span>, name <span class="op">=</span> <span class="va">x</span>, pAdjustMethod <span class="op">=</span> <span class="va">adj_meth</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">log_padj</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">padj</span><span class="op">)</span></span>
<span>      <span class="va">y</span><span class="op">$</span><span class="va">ctrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span></span>
<span>        pattern <span class="op">=</span> <span class="st">"^diabcd(...)\\.avisit.*$"</span>,</span>
<span>        x <span class="op">=</span> <span class="va">x</span>,</span>
<span>        replacement <span class="op">=</span> <span class="st">"chg \\1"</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dds_5_est</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_5_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_name</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      chg_ngt <span class="op">=</span> <span class="st">"diabcdNGT.avisit_Month_3"</span>,</span>
<span>      chg_igt <span class="op">=</span> <span class="st">"diabcdIGT.avisit_Month_3"</span>,</span>
<span>      chg_t2d <span class="op">=</span> <span class="st">"diabcdT2D.avisit_Month_3"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span></span>
<span>    <span class="va">ctrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ctrs</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"chg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NGT"</span>, <span class="st">"IGT"</span>, <span class="st">"T2D"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-09" class="level3" data-number="5.7.1"><h3 data-number="5.7.1" class="anchored" data-anchor-id="fig-07-09">
<span class="header-section-number">5.7.1</span> Fig 07 09</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_5_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_5_gg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_5_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.9"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span><span class="st">        Expression among micro RNA in response to the exercise</span></span>
<span><span class="st">        intervention (CHG)"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_5_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_09.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_09_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_09.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_09_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_09 <span class="op">=</span> <span class="va">dds_5_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>      <span class="st">"All miRNA Change from Baseline - differential expression by diabetes"</span>,</span>
<span>      <span class="st">"group"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_09"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_09.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-10" class="level3" data-number="5.7.2"><h3 data-number="5.7.2" class="anchored" data-anchor-id="fig-07-10">
<span class="header-section-number">5.7.2</span> Fig 07 10</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_5_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_5_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span></span>
<span>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span>  <span class="va">dds_5_est</span><span class="op">$</span><span class="va">feature</span>,</span>
<span>  replacement <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dds_5_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_5_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dds_5_est</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_5_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_5_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_5_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dds_5_est</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dds_5_txt</span>, size <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dds_5_txt</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.10"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span><span class="st">        Expression among micro RNA in response to the exercise</span></span>
<span><span class="st">        intervention (CHG)"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_5_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_10.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_10_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_10.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_10_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="dds_6---de-exercise-intervention-mrna" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="dds_6---de-exercise-intervention-mrna">
<span class="header-section-number">5.8</span> <code>dds_6</code> - DE: Exercise intervention, mRNA</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ctrl</span> <span class="op">&lt;-</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">rna</span></span>
<span><span class="va">ngs_assay</span> <span class="op">&lt;-</span> <span class="st">"mrna"</span></span>
<span></span>
<span><span class="va">filter_for_paired_visits</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">subj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span></span>
<span>  <span class="va">subj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">subj</span><span class="op">[</span><span class="va">subj</span> <span class="op">==</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">mae</span> <span class="op">&lt;-</span> <span class="va">mae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">subj</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">chk_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">chk_df</span>, f <span class="op">=</span> <span class="va">chk_df</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Verify the selection:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/assertthat/man/assert_that.html">assert_that</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">check</span>, subj <span class="op">=</span> <span class="va">subj</span>,\<span class="op">(</span><span class="va">x</span>, <span class="va">subj</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">subj</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">x</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mae</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dds_6_fit</span> <span class="op">&lt;-</span> <span class="va">besd_mae</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="va">mae</span><span class="op">[</span> , , <span class="va">ngs_assay</span><span class="op">]</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_depth</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">depth_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_paired_visits</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">filter_for_low_expr</span><span class="op">(</span><span class="va">ngs_assay</span>, <span class="va">ctrl</span><span class="op">$</span><span class="va">cpm_threshold</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="op">(</span>\<span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># &lt;https://support.bioconductor.org/p/84241/#84296&gt;</span></span>
<span>    <span class="co"># Or:</span></span>
<span>    <span class="co"># vignette('DESeq2'),</span></span>
<span>    <span class="co"># &gt; Section: "Group-specific condition effects, individuals nested</span></span>
<span>    <span class="co"># &gt; within groups"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span>,</span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">$</span><span class="va">avisit</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"diabcd"</span>, <span class="st">"subjid"</span>, <span class="st">"avisit_"</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span></span>
<span>      <span class="va">rbind</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">coldata</span>,</span>
<span>        INDICES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">coldata</span><span class="op">$</span><span class="va">diabcd</span><span class="op">)</span>,</span>
<span>        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">subjid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span><span class="co"># nolint</span></span>
<span>          <span class="va">x</span><span class="op">$</span><span class="va">P.n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="co"># nolint</span></span>
<span>            <span class="va">subjid</span>,</span>
<span>            levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">subjid</span><span class="op">)</span>,</span>
<span>            labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"P."</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nlevels.html">nlevels</a></span><span class="op">(</span><span class="va">subjid</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>          <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">subjid</span>, <span class="va">x</span><span class="op">$</span><span class="va">diabcd</span><span class="op">)</span>, <span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">coldata</span> <span class="op">&lt;-</span> <span class="va">coldata</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">mae</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="va">dsgn</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="va">diabcd</span> <span class="op">+</span> <span class="va">diabcd</span><span class="op">:</span><span class="va">P.n</span> <span class="op">+</span> <span class="va">diabcd</span><span class="op">:</span><span class="va">avisit_</span>,</span>
<span>      <span class="va">coldata</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="va">dsgn</span> <span class="op">&lt;-</span> <span class="va">dsgn</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">dsgn</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeqDataSet.html">DESeqDataSetFromMatrix</a></span><span class="op">(</span></span>
<span>      countData <span class="op">=</span> <span class="va">mae</span><span class="op">[[</span><span class="va">ngs_assay</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mae</span><span class="op">)</span>,</span>
<span>      design <span class="op">=</span> <span class="va">dsgn</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">DESeq2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DESeq2/man/DESeq.html">DESeq</a></span><span class="op">(</span></span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html">bpparam</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fitType <span class="op">=</span> <span class="st">"local"</span>,</span>
<span>    betaPrior <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: 'experiments' dropped; see 'metadata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>harmonizing input:
  removing 282 sampleMap rows not in names(experiments)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>using supplied model matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating size factors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>estimating dispersions</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>gene-wise dispersion estimates: 2 workers</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>mean-dispersion relationship</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>final dispersion estimates, fitting model and testing: 2 workers</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dds_6_est</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_6_fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">de_by_name</span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      chg_ngt <span class="op">=</span> <span class="st">"diabcdNGT.avisit_Month_3"</span>,</span>
<span>      chg_igt <span class="op">=</span> <span class="st">"diabcdIGT.avisit_Month_3"</span>,</span>
<span>      chg_t2d <span class="op">=</span> <span class="st">"diabcdT2D.avisit_Month_3"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span></span>
<span>    <span class="va">ctrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ctrs</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"chg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NGT"</span>, <span class="st">"IGT"</span>, <span class="st">"T2D"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html">within</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">lfcSE</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">ctrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Contrast"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span>    <span class="fu">label_xp</span><span class="op">(</span><span class="va">log_padj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="fig-07-11" class="level3" data-number="5.8.1"><h3 data-number="5.8.1" class="anchored" data-anchor-id="fig-07-11">
<span class="header-section-number">5.8.1</span> Fig 07 11</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_6_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_6_gg</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dds_6_est</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">log2FoldChange</span>, <span class="va">log_padj</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.11"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span><span class="st">        Expression among mRNA in response to the exercise</span></span>
<span><span class="st">        intervention (CHG)"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_6_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1646 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_11.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_11_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_11.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_11_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_xl</span><span class="op">(</span></span>
<span>  fig_07_11 <span class="op">=</span> <span class="va">dds_6_est</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>      <span class="st">"mRNA Change from Baseline - differential expression by diabetes"</span>,</span>
<span>      <span class="st">"group"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"UMB-BESD"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  dir <span class="op">=</span> <span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>,</span>
<span>  basenm <span class="op">=</span> <span class="st">"fig_07_11"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Excel output: ../tlg/graph/fig_07_11.xlsx</code></pre>
</div>
</div>
</section><section id="fig-07-12" class="level3" data-number="5.8.2"><h3 data-number="5.8.2" class="anchored" data-anchor-id="fig-07-12">
<span class="header-section-number">5.8.2</span> Fig 07 12</h3>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="va">log_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/pretty.html">pretty</a></span><span class="op">(</span><span class="va">dds_6_est</span><span class="op">$</span><span class="va">log_padj</span><span class="op">)</span></span>
<span><span class="va">brk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">log_adj</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"padj="</span>, <span class="va">pval</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_6_est</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"ENSG0+"</span>, <span class="st">""</span>, <span class="va">dds_6_est</span><span class="op">$</span><span class="va">feature</span><span class="op">)</span></span>
<span><span class="va">dds_6_est</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">dds_6_est</span><span class="op">$</span><span class="va">feature</span>, start <span class="op">=</span> <span class="fl">5</span>, stop <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_6_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dds_6_est</span>, <span class="va">padj</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">log2FoldChange</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dds_6_gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="va">dds_6_est</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log2FoldChange</span>, y <span class="op">=</span> <span class="va">log_padj</span>, col <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Log2-fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">padj</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html">stat_bin_hex</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dds_6_txt</span>, size <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dds_6_txt</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, high <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">brk</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">ctrs</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    title <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>    legend.text.align <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">clean_slate</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_header</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Confidential"</span>, <span class="st">"Draft"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_title</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Figure 7.12"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/strwrap.html">strwrap</a></span><span class="op">(</span></span>
<span>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span><span class="st">        Expression among mRNA in response to the exercise</span></span>
<span><span class="st">        intervention (CHG)"</span>, width <span class="op">=</span> <span class="fl">80</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_figure</span><span class="op">(</span><span class="va">dds_6_gg</span>, height <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, width <span class="op">=</span> <span class="fu">inches</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_footer</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">cfg_prog</span><span class="op">$</span><span class="va">version</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1646 rows containing non-finite values (stat_binhex).</code></pre>
</div>
<details><summary>Show the code</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">export_as</span><span class="op">(</span></span>
<span>  <span class="va">p</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_12.pdf"</span><span class="op">)</span>,</span>
<span>  file_graph_alone <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">cfg_prog</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">grh</span>, <span class="st">"fig_07_12_af.pdf"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_12.pdf</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[log] output saved as: ../tlg/graph/fig_07_12_af.pdf (annot. free)</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">show_slate</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">ctrl</span>, <span class="va">ngs_assay</span>, <span class="va">dds_6_fit</span>, <span class="va">pval</span>, <span class="va">log_adj</span>, <span class="va">brk</span>, <span class="va">dds_6_gg</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html">gc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="session-informations" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="session-informations">
<span class="header-section-number">5.9</span> Session Informations</h2>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Duendar2018" class="csl-entry" role="doc-biblioentry">
Dündar, Friederike, Luce Skrabanek, and Paul Zumbo. 2018. <span>“Introduction to Differential Gene Expression Analysis Using RNA-Seq.”</span> Internet.
</div>
<div id="ref-Love2014" class="csl-entry" role="doc-biblioentry">
Love, Michael I., Wolfgang Huber, and Simon Anders. 2014. <span>“Moderated Estimation of Fold Change and Dispersion for RNA-Seq Data with DESeq2.”</span> <em>Genome Biology</em> 15: 550. <a href="https://doi.org/10.1186/s13059-014-0550-8">https://doi.org/10.1186/s13059-014-0550-8</a>.
</div>
<div id="ref-RCT2022" class="csl-entry" role="doc-biblioentry">
R Core Team. 2022. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Ramos2017" class="csl-entry" role="doc-biblioentry">
Ramos, Marcel, Lucas Schiffer, Angela Re, Rimsha Azhar, Azfar Basunia, Carmen Rodriguez Cabrera, Tiffany Chan, et al. 2017. <span>“Software for the Integration of Multi-Omics Experiments in Bioconductor.”</span> <em>Cancer Research</em> 77(21); e39-42.
</div>
<div id="ref-Wickham2016" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./t2d_06_rna.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RNASeq - Refresher</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./t2d_11_wcn.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">WGCNA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb187" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "mRNA / micro RNA"</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Program 07</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Francois Collin"</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.time(), '%Y-%m-%d')`"</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="an">always_allow_html:</span><span class="co"> true</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## miRNA Seq - Differential expression analysis</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, cfg_prog}</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>cfg_prog <span class="ot">&lt;-</span> yaml<span class="sc">::</span><span class="fu">read_yaml</span>(<span class="st">"_prog.yml"</span>)</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>The variation in messenger RNA (mRNA) and micro-RNA (miRNA) abundance</span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a>measured by RNA-Seq associated either with the dysglycemia and/or the</span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a>3-month exercise intervention were investigated by a Differential</span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a>Expression analysis (DE). At baseline, the DE models included only the</span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>effect of the dysglycemia-constrast group, consistently with the Anova</span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>model applied for demographics and baseline anthropometrics.</span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>To do so, genetic features which were never found expressed were</span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>discarded. Then RNA-Seq libraries were included if reaching a read depth</span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a>threshold (total number of reads per sample) fixed by visual examination</span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>of the association between sample gene diversity and sample depth. For</span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>the remaining libraries, genetic features were included if the count per</span>
<span id="cb187-27"><a href="#cb187-27" aria-hidden="true" tabindex="-1"></a>million reads (CPM) was greater than</span>
<span id="cb187-28"><a href="#cb187-28" aria-hidden="true" tabindex="-1"></a><span class="in">`r cfg_prog$rna$cpm_threshold$allmirna`</span> in at least</span>
<span id="cb187-29"><a href="#cb187-29" aria-hidden="true" tabindex="-1"></a><span class="in">`r cfg_prog$rna$cpm_threshold$fraccol * 100`</span>% of the samples.</span>
<span id="cb187-30"><a href="#cb187-30" aria-hidden="true" tabindex="-1"></a>The DE analysis implementation proposed by @Love2014 with the R package</span>
<span id="cb187-31"><a href="#cb187-31" aria-hidden="true" tabindex="-1"></a><span class="in">`DESeq2`</span> was used to fit the models; it is based on a negative binomial</span>
<span id="cb187-32"><a href="#cb187-32" aria-hidden="true" tabindex="-1"></a>distribution accounting for read variability, dispersion corrected after</span>
<span id="cb187-33"><a href="#cb187-33" aria-hidden="true" tabindex="-1"></a>trends seen across all samples and genes <span class="co">[</span><span class="ot">@Duendar2018</span><span class="co">]</span>. In addition,</span>
<span id="cb187-34"><a href="#cb187-34" aria-hidden="true" tabindex="-1"></a>the number of tested genes being high, raw p.values were adjusted</span>
<span id="cb187-35"><a href="#cb187-35" aria-hidden="true" tabindex="-1"></a>according to Benjamini and Hochberg's method also known as</span>
<span id="cb187-36"><a href="#cb187-36" aria-hidden="true" tabindex="-1"></a>False-Discovery Rate (FDR).</span>
<span id="cb187-37"><a href="#cb187-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-38"><a href="#cb187-38" aria-hidden="true" tabindex="-1"></a>The analysis was realized with R <span class="co">[</span><span class="ot">v4.2.0, @RCT2022</span><span class="co">]</span>. Note the</span>
<span id="cb187-39"><a href="#cb187-39" aria-hidden="true" tabindex="-1"></a>use of the additional packages downloaded from the RStudio package manager</span>
<span id="cb187-40"><a href="#cb187-40" aria-hidden="true" tabindex="-1"></a>repository (freeze date 2022-05-04, <span class="co">[</span><span class="ot">repos</span><span class="co">]</span>(</span>
<span id="cb187-41"><a href="#cb187-41" aria-hidden="true" tabindex="-1"></a>https://packagemanager.rstudio.com/all/2022-05-04+Y3JhbiwyOjQ1MjYyMTU7NTVFQjhGODU)):</span>
<span id="cb187-42"><a href="#cb187-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-43"><a href="#cb187-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`DESeq2`</span> for differential expression analysis and</span>
<span id="cb187-44"><a href="#cb187-44" aria-hidden="true" tabindex="-1"></a>variance stabilizing transformation <span class="co">[</span><span class="ot">version 1.36.0, @Love2014</span><span class="co">]</span></span>
<span id="cb187-45"><a href="#cb187-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ggplot2`</span> for graphics <span class="co">[</span><span class="ot">version 3.3.6, @Wickham2016</span><span class="co">]</span></span>
<span id="cb187-46"><a href="#cb187-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`MultiAssayExperiment`</span> for management of multi-omics experiment objects</span>
<span id="cb187-47"><a href="#cb187-47" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">version 1.22.0, @Ramos2017</span><span class="co">]</span>.</span>
<span id="cb187-48"><a href="#cb187-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-49"><a href="#cb187-49" aria-hidden="true" tabindex="-1"></a>Target:</span>
<span id="cb187-50"><a href="#cb187-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-51"><a href="#cb187-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> miRNA DE at baseline without confounding factors.</span>
<span id="cb187-52"><a href="#cb187-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> mRNA DE at baseline without confounding factors.</span>
<span id="cb187-53"><a href="#cb187-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> miRNA DE at month 3 without confounding factors.</span>
<span id="cb187-54"><a href="#cb187-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> mRNA DE at month 3 without confounding factors.</span>
<span id="cb187-55"><a href="#cb187-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> miRNA DE variation induced by the exercise intervention.</span>
<span id="cb187-56"><a href="#cb187-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> mRNA DE variation induced by the exercise intervention.</span>
<span id="cb187-57"><a href="#cb187-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-58"><a href="#cb187-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, settings}</span></span>
<span id="cb187-59"><a href="#cb187-59" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/dbs.data"</span>)</span>
<span id="cb187-60"><a href="#cb187-60" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">"src/pkg/latarnia.utils"</span>)</span>
<span id="cb187-61"><a href="#cb187-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-62"><a href="#cb187-62" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">results =</span> cfg_prog<span class="sc">$</span>knitr<span class="sc">$</span>results)</span>
<span id="cb187-63"><a href="#cb187-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(assertthat)</span>
<span id="cb187-64"><a href="#cb187-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb187-65"><a href="#cb187-65" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/ngs.R"</span>)</span>
<span id="cb187-66"><a href="#cb187-66" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/inches.R"</span>)</span>
<span id="cb187-67"><a href="#cb187-67" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/export_xl.R"</span>)</span>
<span id="cb187-68"><a href="#cb187-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-69"><a href="#cb187-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-70"><a href="#cb187-70" aria-hidden="true" tabindex="-1"></a><span class="fu">### Materials and Methods</span></span>
<span id="cb187-71"><a href="#cb187-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-72"><a href="#cb187-72" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Helper functions</span></span>
<span id="cb187-73"><a href="#cb187-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-76"><a href="#cb187-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb187-77"><a href="#cb187-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Help for data pre-processing</span></span>
<span id="cb187-78"><a href="#cb187-78" aria-hidden="true" tabindex="-1"></a>filter_for_depth <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, assay, min_depth) {</span>
<span id="cb187-79"><a href="#cb187-79" aria-hidden="true" tabindex="-1"></a>  mae[, <span class="fu">colSums</span>(mae[[ngs_assay]]) <span class="sc">&gt;</span> min_depth, ]</span>
<span id="cb187-80"><a href="#cb187-80" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-81"><a href="#cb187-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-82"><a href="#cb187-82" aria-hidden="true" tabindex="-1"></a>filter_for_coldata <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, <span class="at">col =</span> <span class="st">"avisit"</span>, is) {</span>
<span id="cb187-83"><a href="#cb187-83" aria-hidden="true" tabindex="-1"></a>  mae[, <span class="fu">colData</span>(mae)[[col]] <span class="sc">%in%</span> is, ]</span>
<span id="cb187-84"><a href="#cb187-84" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-85"><a href="#cb187-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-86"><a href="#cb187-86" aria-hidden="true" tabindex="-1"></a>filter_for_low_expr <span class="ot">&lt;-</span> <span class="cf">function</span>(mae, assay, min_cpm,</span>
<span id="cb187-87"><a href="#cb187-87" aria-hidden="true" tabindex="-1"></a>                                <span class="at">frac_cols =</span> cfg_prog<span class="sc">$</span>rna<span class="sc">$</span>cpm_threshold<span class="sc">$</span>fraccol</span>
<span id="cb187-88"><a href="#cb187-88" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb187-89"><a href="#cb187-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Genes expressed at least cpm_threshold in frac_cols columns</span></span>
<span id="cb187-90"><a href="#cb187-90" aria-hidden="true" tabindex="-1"></a>  mae[</span>
<span id="cb187-91"><a href="#cb187-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowSums</span>(<span class="fu">cpm</span>(mae[[assay]]) <span class="sc">&gt;</span> min_cpm) <span class="sc">&gt;</span></span>
<span id="cb187-92"><a href="#cb187-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ncol</span>(mae[[assay]]) <span class="sc">*</span> frac_cols,</span>
<span id="cb187-93"><a href="#cb187-93" aria-hidden="true" tabindex="-1"></a>    ,</span>
<span id="cb187-94"><a href="#cb187-94" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb187-95"><a href="#cb187-95" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-96"><a href="#cb187-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-97"><a href="#cb187-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Differential expression helper functions:</span></span>
<span id="cb187-98"><a href="#cb187-98" aria-hidden="true" tabindex="-1"></a>de_by_ctrs <span class="ot">&lt;-</span> <span class="cf">function</span>(df,</span>
<span id="cb187-99"><a href="#cb187-99" aria-hidden="true" tabindex="-1"></a>                       ctrs,</span>
<span id="cb187-100"><a href="#cb187-100" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adj_meth =</span> ctrl<span class="sc">$</span>adj_meth) {</span>
<span id="cb187-101"><a href="#cb187-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(</span>
<span id="cb187-102"><a href="#cb187-102" aria-hidden="true" tabindex="-1"></a>    ctrs,</span>
<span id="cb187-103"><a href="#cb187-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> df,</span>
<span id="cb187-104"><a href="#cb187-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_meth =</span> adj_meth,</span>
<span id="cb187-105"><a href="#cb187-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> <span class="cf">function</span>(x, fit, adj_meth) {</span>
<span id="cb187-106"><a href="#cb187-106" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> DESeq2<span class="sc">::</span><span class="fu">results</span>(fit, <span class="at">contrast =</span> x, <span class="at">pAdjustMethod =</span> adj_meth)</span>
<span id="cb187-107"><a href="#cb187-107" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(y)</span>
<span id="cb187-108"><a href="#cb187-108" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>log_padj <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(y<span class="sc">$</span>padj)</span>
<span id="cb187-109"><a href="#cb187-109" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>ctrs <span class="ot">&lt;-</span> <span class="fu">paste</span>(x[<span class="st">"test"</span>], <span class="st">"vs"</span>, x[<span class="st">"ref"</span>])</span>
<span id="cb187-110"><a href="#cb187-110" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(y)</span>
<span id="cb187-111"><a href="#cb187-111" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb187-112"><a href="#cb187-112" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-113"><a href="#cb187-113" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-114"><a href="#cb187-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-115"><a href="#cb187-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-116"><a href="#cb187-116" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data preparation</span></span>
<span id="cb187-117"><a href="#cb187-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-118"><a href="#cb187-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, ads}</span></span>
<span id="cb187-119"><a href="#cb187-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb187-120"><a href="#cb187-120" aria-hidden="true" tabindex="-1"></a>adsl <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adsl</span>
<span id="cb187-121"><a href="#cb187-121" aria-hidden="true" tabindex="-1"></a>advs <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>advs</span>
<span id="cb187-122"><a href="#cb187-122" aria-hidden="true" tabindex="-1"></a>adlb <span class="ot">&lt;-</span> dbs.data<span class="sc">::</span>adlb</span>
<span id="cb187-123"><a href="#cb187-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-124"><a href="#cb187-124" aria-hidden="true" tabindex="-1"></a><span class="co">#' Subjid and Visit to Sample</span></span>
<span id="cb187-125"><a href="#cb187-125" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb187-126"><a href="#cb187-126" aria-hidden="true" tabindex="-1"></a>subjvis_to_spl <span class="ot">&lt;-</span> <span class="cf">function</span>(df) <span class="fu">paste0</span>(df<span class="sc">$</span>subjid, <span class="st">"v"</span>, df<span class="sc">$</span>avisitn)</span>
<span id="cb187-127"><a href="#cb187-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-128"><a href="#cb187-128" aria-hidden="true" tabindex="-1"></a>ads <span class="ot">&lt;-</span> adlb <span class="sc">|&gt;</span></span>
<span id="cb187-129"><a href="#cb187-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(advs) <span class="sc">|&gt;</span></span>
<span id="cb187-130"><a href="#cb187-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(ct, dtype, param, base, basetype, chg, pchg)) <span class="sc">|&gt;</span></span>
<span id="cb187-131"><a href="#cb187-131" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"paramcd"</span>, <span class="at">values_from =</span> <span class="st">"aval"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-132"><a href="#cb187-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(adsl, <span class="at">y =</span> _, <span class="at">by =</span> <span class="st">"subjid"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-133"><a href="#cb187-133" aria-hidden="true" tabindex="-1"></a>  (\(df) S4Vectors<span class="sc">::</span><span class="fu">DataFrame</span>(df, <span class="at">row.names =</span> <span class="fu">subjvis_to_spl</span>(df)))() <span class="sc">|&gt;</span></span>
<span id="cb187-134"><a href="#cb187-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(subjid, diabcd, diab, avisitn, avisit)) <span class="sc">|&gt;</span></span>
<span id="cb187-135"><a href="#cb187-135" aria-hidden="true" tabindex="-1"></a>  (\(df) {</span>
<span id="cb187-136"><a href="#cb187-136" aria-hidden="true" tabindex="-1"></a>    assertthat<span class="sc">::</span><span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">table</span>(<span class="fu">subjvis_to_spl</span>(df)) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb187-137"><a href="#cb187-137" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb187-138"><a href="#cb187-138" aria-hidden="true" tabindex="-1"></a>  })()</span>
<span id="cb187-139"><a href="#cb187-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-140"><a href="#cb187-140" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(adsl, advs, adlb)</span>
<span id="cb187-141"><a href="#cb187-141" aria-hidden="true" tabindex="-1"></a>ads</span>
<span id="cb187-142"><a href="#cb187-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-143"><a href="#cb187-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-144"><a href="#cb187-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, rna}</span></span>
<span id="cb187-145"><a href="#cb187-145" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb187-146"><a href="#cb187-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrna =</span> dbs.data<span class="sc">::</span>mrna_raw,</span>
<span id="cb187-147"><a href="#cb187-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">premirna =</span> dbs.data<span class="sc">::</span>premirna_raw,</span>
<span id="cb187-148"><a href="#cb187-148" aria-hidden="true" tabindex="-1"></a>  <span class="at">mirna =</span> dbs.data<span class="sc">::</span>mirna_raw</span>
<span id="cb187-149"><a href="#cb187-149" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-150"><a href="#cb187-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-151"><a href="#cb187-151" aria-hidden="true" tabindex="-1"></a>rna[<span class="fu">c</span>(<span class="st">"premirna"</span>, <span class="st">"mirna"</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb187-152"><a href="#cb187-152" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> rna[<span class="fu">c</span>(<span class="st">"premirna"</span>, <span class="st">"mirna"</span>)],</span>
<span id="cb187-153"><a href="#cb187-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> format_mirna</span>
<span id="cb187-154"><a href="#cb187-154" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-155"><a href="#cb187-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-156"><a href="#cb187-156" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows represent genes</span></span>
<span id="cb187-157"><a href="#cb187-157" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> rna, <span class="at">FUN =</span> <span class="cf">function</span>(x) y <span class="ot">&lt;-</span> x[<span class="fu">rowSums</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>, ])</span>
<span id="cb187-158"><a href="#cb187-158" aria-hidden="true" tabindex="-1"></a>rna <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> rna, as.matrix)</span>
<span id="cb187-159"><a href="#cb187-159" aria-hidden="true" tabindex="-1"></a>assertthat<span class="sc">::</span><span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(rna<span class="sc">$</span>premirna) <span class="sc">==</span> <span class="fu">colnames</span>(rna<span class="sc">$</span>mirna)))</span>
<span id="cb187-160"><a href="#cb187-160" aria-hidden="true" tabindex="-1"></a>rna<span class="sc">$</span>allmirna <span class="ot">&lt;-</span> <span class="fu">rbind</span>(rna<span class="sc">$</span>premirna, rna<span class="sc">$</span>mirna)</span>
<span id="cb187-161"><a href="#cb187-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-162"><a href="#cb187-162" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(testthat)</span>
<span id="cb187-163"><a href="#cb187-163" aria-hidden="true" tabindex="-1"></a><span class="fu">test_that</span>(<span class="st">"rna features discriminated in noexpr, expr"</span>, {</span>
<span id="cb187-164"><a href="#cb187-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="at">X =</span> rna, <span class="at">FUN =</span> \(x) <span class="fu">expect_true</span>(<span class="fu">all</span>(<span class="fu">rowSums</span>(x) <span class="sc">&gt;</span> <span class="dv">0</span>)))</span>
<span id="cb187-165"><a href="#cb187-165" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb187-166"><a href="#cb187-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-167"><a href="#cb187-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-168"><a href="#cb187-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, mae}</span></span>
<span id="cb187-169"><a href="#cb187-169" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MultiAssayExperiment)</span>
<span id="cb187-170"><a href="#cb187-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-171"><a href="#cb187-171" aria-hidden="true" tabindex="-1"></a><span class="co">#' (Sample-)Map Arrays</span></span>
<span id="cb187-172"><a href="#cb187-172" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb187-173"><a href="#cb187-173" aria-hidden="true" tabindex="-1"></a><span class="co">#' Use the column names of `x` to deduce the `primary` and `colnames`.</span></span>
<span id="cb187-174"><a href="#cb187-174" aria-hidden="true" tabindex="-1"></a><span class="co">#' This is used to generate the sample mapping between colData and Experiments.</span></span>
<span id="cb187-175"><a href="#cb187-175" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb187-176"><a href="#cb187-176" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param x (`dataframe`).</span></span>
<span id="cb187-177"><a href="#cb187-177" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb187-178"><a href="#cb187-178" aria-hidden="true" tabindex="-1"></a><span class="co">#' @note In our case, primary and colnames are equivalent, colnames could</span></span>
<span id="cb187-179"><a href="#cb187-179" aria-hidden="true" tabindex="-1"></a><span class="co">#' be different from primary names when a biological sample has different</span></span>
<span id="cb187-180"><a href="#cb187-180" aria-hidden="true" tabindex="-1"></a><span class="co">#' names in the biological assays (e.g. machine constraint, technical</span></span>
<span id="cb187-181"><a href="#cb187-181" aria-hidden="true" tabindex="-1"></a><span class="co">#' repetitions).</span></span>
<span id="cb187-182"><a href="#cb187-182" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb187-183"><a href="#cb187-183" aria-hidden="true" tabindex="-1"></a><span class="co">#' @seealso [MultiAssayExperiment::listToMap()]</span></span>
<span id="cb187-184"><a href="#cb187-184" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb187-185"><a href="#cb187-185" aria-hidden="true" tabindex="-1"></a><span class="co">#' \dontrun{</span></span>
<span id="cb187-186"><a href="#cb187-186" aria-hidden="true" tabindex="-1"></a><span class="co">#'   lapply(rna, map_arrays)</span></span>
<span id="cb187-187"><a href="#cb187-187" aria-hidden="true" tabindex="-1"></a><span class="co">#'   MultiAssayExperiment::listToMap(lapply(rna, map_arrays))</span></span>
<span id="cb187-188"><a href="#cb187-188" aria-hidden="true" tabindex="-1"></a><span class="co">#' }</span></span>
<span id="cb187-189"><a href="#cb187-189" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb187-190"><a href="#cb187-190" aria-hidden="true" tabindex="-1"></a>map_arrays <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb187-191"><a href="#cb187-191" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">colname =</span> <span class="fu">colnames</span>(x))</span>
<span id="cb187-192"><a href="#cb187-192" aria-hidden="true" tabindex="-1"></a>  y<span class="sc">$</span>primary <span class="ot">&lt;-</span> y<span class="sc">$</span>colname</span>
<span id="cb187-193"><a href="#cb187-193" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb187-194"><a href="#cb187-194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-195"><a href="#cb187-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-196"><a href="#cb187-196" aria-hidden="true" tabindex="-1"></a>besd_mae <span class="ot">&lt;-</span> <span class="fu">MultiAssayExperiment</span>(</span>
<span id="cb187-197"><a href="#cb187-197" aria-hidden="true" tabindex="-1"></a>  <span class="at">experiments =</span> <span class="fu">ExperimentList</span>(rna),</span>
<span id="cb187-198"><a href="#cb187-198" aria-hidden="true" tabindex="-1"></a>  <span class="at">colData =</span> ads,</span>
<span id="cb187-199"><a href="#cb187-199" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampleMap =</span> <span class="fu">listToMap</span>(<span class="fu">lapply</span>(rna, map_arrays))</span>
<span id="cb187-200"><a href="#cb187-200" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-201"><a href="#cb187-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-202"><a href="#cb187-202" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(rna, ads)</span>
<span id="cb187-203"><a href="#cb187-203" aria-hidden="true" tabindex="-1"></a>besd_mae</span>
<span id="cb187-204"><a href="#cb187-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-205"><a href="#cb187-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-206"><a href="#cb187-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample depth threshold determination</span></span>
<span id="cb187-207"><a href="#cb187-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-208"><a href="#cb187-208" aria-hidden="true" tabindex="-1"></a>A scatter plot representing sample gene diversity in relationship with sample</span>
<span id="cb187-209"><a href="#cb187-209" aria-hidden="true" tabindex="-1"></a>depth evidenced a threshold for miRNA reads at</span>
<span id="cb187-210"><a href="#cb187-210" aria-hidden="true" tabindex="-1"></a><span class="in">`r formatC(cfg_prog$rna$depth_threshold$allmirna, format = "e", digits = 0)`</span></span>
<span id="cb187-211"><a href="#cb187-211" aria-hidden="true" tabindex="-1"></a>reads for which approximately a million read increase was associated with more</span>
<span id="cb187-212"><a href="#cb187-212" aria-hidden="true" tabindex="-1"></a>than a 2-fold increase in gene diversity. The depth threshold for mRNA was</span>
<span id="cb187-213"><a href="#cb187-213" aria-hidden="true" tabindex="-1"></a>fixed at </span>
<span id="cb187-214"><a href="#cb187-214" aria-hidden="true" tabindex="-1"></a><span class="in">`r formatC(cfg_prog$rna$depth_threshold$allmrna, format = "e", digits = 0)`</span>,</span>
<span id="cb187-215"><a href="#cb187-215" aria-hidden="true" tabindex="-1"></a>although with a less important but still substantial drop in gene variety</span>
<span id="cb187-216"><a href="#cb187-216" aria-hidden="true" tabindex="-1"></a>below that threshold.</span>
<span id="cb187-217"><a href="#cb187-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-218"><a href="#cb187-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### miRNA</span></span>
<span id="cb187-219"><a href="#cb187-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-220"><a href="#cb187-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_mirna}</span></span>
<span id="cb187-221"><a href="#cb187-221" aria-hidden="true" tabindex="-1"></a>assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb187-222"><a href="#cb187-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-223"><a href="#cb187-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-224"><a href="#cb187-224" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb187-225"><a href="#cb187-225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Static figure</span></span>
<span id="cb187-226"><a href="#cb187-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-227"><a href="#cb187-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_gg, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-228"><a href="#cb187-228" aria-hidden="true" tabindex="-1"></a>vline <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna<span class="sc">$</span>depth_threshold[[assay]]</span>
<span id="cb187-229"><a href="#cb187-229" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">assays</span>(besd_mae)[[assay]]</span>
<span id="cb187-230"><a href="#cb187-230" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb187-231"><a href="#cb187-231" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_gene =</span> <span class="fu">colSums</span>(dtaplot <span class="sc">&gt;</span> <span class="dv">0</span>),</span>
<span id="cb187-232"><a href="#cb187-232" aria-hidden="true" tabindex="-1"></a>  <span class="at">depth  =</span> <span class="fu">colSums</span>(dtaplot)</span>
<span id="cb187-233"><a href="#cb187-233" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-234"><a href="#cb187-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-235"><a href="#cb187-235" aria-hidden="true" tabindex="-1"></a>dtaplot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb187-236"><a href="#cb187-236" aria-hidden="true" tabindex="-1"></a>  dtaplot,</span>
<span id="cb187-237"><a href="#cb187-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="fu">colData</span>(besd_mae)[<span class="fu">rownames</span>(dtaplot),])</span>
<span id="cb187-238"><a href="#cb187-238" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-239"><a href="#cb187-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-240"><a href="#cb187-240" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb187-241"><a href="#cb187-241" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dtaplot,</span>
<span id="cb187-242"><a href="#cb187-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> depth, <span class="at">y =</span> n_gene, <span class="at">colour =</span> diab)</span>
<span id="cb187-243"><a href="#cb187-243" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb187-244"><a href="#cb187-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb187-245"><a href="#cb187-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> vline) <span class="sc">+</span></span>
<span id="cb187-246"><a href="#cb187-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample depth"</span>) <span class="sc">+</span></span>
<span id="cb187-247"><a href="#cb187-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Gene diversity (number of genes with reads)"</span>) <span class="sc">+</span></span>
<span id="cb187-248"><a href="#cb187-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb187-249"><a href="#cb187-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-250"><a href="#cb187-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb187-251"><a href="#cb187-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-252"><a href="#cb187-252" aria-hidden="true" tabindex="-1"></a>gg</span>
<span id="cb187-253"><a href="#cb187-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-254"><a href="#cb187-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-255"><a href="#cb187-255" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interactive figure</span></span>
<span id="cb187-256"><a href="#cb187-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-257"><a href="#cb187-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_plotly, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-258"><a href="#cb187-258" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(gg)</span>
<span id="cb187-259"><a href="#cb187-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-260"><a href="#cb187-260" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb187-261"><a href="#cb187-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-264"><a href="#cb187-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb187-265"><a href="#cb187-265" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(vline, dtaplot, assay, gg)</span>
<span id="cb187-266"><a href="#cb187-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-267"><a href="#cb187-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-268"><a href="#cb187-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### mRNA</span></span>
<span id="cb187-269"><a href="#cb187-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-270"><a href="#cb187-270" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb187-271"><a href="#cb187-271" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Static figure</span></span>
<span id="cb187-272"><a href="#cb187-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-273"><a href="#cb187-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_mrna}</span></span>
<span id="cb187-274"><a href="#cb187-274" aria-hidden="true" tabindex="-1"></a>assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb187-275"><a href="#cb187-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-276"><a href="#cb187-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-277"><a href="#cb187-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_gg, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-278"><a href="#cb187-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-279"><a href="#cb187-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-280"><a href="#cb187-280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interactive figure</span></span>
<span id="cb187-281"><a href="#cb187-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-282"><a href="#cb187-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, depth_diversity_plotly, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-283"><a href="#cb187-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-284"><a href="#cb187-284" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb187-285"><a href="#cb187-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-286"><a href="#cb187-286" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb187-287"><a href="#cb187-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-288"><a href="#cb187-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_1` - DE: Baseline, all micro RNA</span></span>
<span id="cb187-289"><a href="#cb187-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-290"><a href="#cb187-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_dta}</span></span>
<span id="cb187-291"><a href="#cb187-291" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-292"><a href="#cb187-292" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb187-293"><a href="#cb187-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-294"><a href="#cb187-294" aria-hidden="true" tabindex="-1"></a>dds_1_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-295"><a href="#cb187-295" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-296"><a href="#cb187-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(</span>
<span id="cb187-297"><a href="#cb187-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-298"><a href="#cb187-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_depth =</span> ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]</span>
<span id="cb187-299"><a href="#cb187-299" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-300"><a href="#cb187-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_coldata</span>(<span class="at">col =</span> <span class="st">"avisit"</span>, <span class="at">is =</span> <span class="st">"Baseline"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-301"><a href="#cb187-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(</span>
<span id="cb187-302"><a href="#cb187-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-303"><a href="#cb187-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_cpm =</span> ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]],</span>
<span id="cb187-304"><a href="#cb187-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">frac_cols =</span> ctrl<span class="sc">$</span>cpm_threshold<span class="sc">$</span>fraccol</span>
<span id="cb187-305"><a href="#cb187-305" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-306"><a href="#cb187-306" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-307"><a href="#cb187-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-308"><a href="#cb187-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-309"><a href="#cb187-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb187-310"><a href="#cb187-310" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb187-311"><a href="#cb187-311" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-312"><a href="#cb187-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-313"><a href="#cb187-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb187-314"><a href="#cb187-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span></span>
<span id="cb187-315"><a href="#cb187-315" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-316"><a href="#cb187-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-317"><a href="#cb187-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-318"><a href="#cb187-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_est}</span></span>
<span id="cb187-319"><a href="#cb187-319" aria-hidden="true" tabindex="-1"></a>dds_1_est <span class="ot">&lt;-</span> dds_1_fit <span class="sc">|&gt;</span></span>
<span id="cb187-320"><a href="#cb187-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb187-321"><a href="#cb187-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb187-322"><a href="#cb187-322" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb187-323"><a href="#cb187-323" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb187-324"><a href="#cb187-324" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb187-325"><a href="#cb187-325" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-326"><a href="#cb187-326" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-327"><a href="#cb187-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-328"><a href="#cb187-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-329"><a href="#cb187-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-330"><a href="#cb187-330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-331"><a href="#cb187-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-332"><a href="#cb187-332" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-333"><a href="#cb187-333" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-334"><a href="#cb187-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-335"><a href="#cb187-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-336"><a href="#cb187-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-337"><a href="#cb187-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 01</span></span>
<span id="cb187-338"><a href="#cb187-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-339"><a href="#cb187-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_gg}</span></span>
<span id="cb187-340"><a href="#cb187-340" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-341"><a href="#cb187-341" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_1_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-342"><a href="#cb187-342" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-343"><a href="#cb187-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-344"><a href="#cb187-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-345"><a href="#cb187-345" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-346"><a href="#cb187-346" aria-hidden="true" tabindex="-1"></a>dds_1_gg <span class="ot">&lt;-</span></span>
<span id="cb187-347"><a href="#cb187-347" aria-hidden="true" tabindex="-1"></a>  dds_1_est <span class="sc">|&gt;</span></span>
<span id="cb187-348"><a href="#cb187-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-349"><a href="#cb187-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-350"><a href="#cb187-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-351"><a href="#cb187-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-352"><a href="#cb187-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-353"><a href="#cb187-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-354"><a href="#cb187-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-355"><a href="#cb187-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-356"><a href="#cb187-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-357"><a href="#cb187-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-358"><a href="#cb187-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-359"><a href="#cb187-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-360"><a href="#cb187-360" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-361"><a href="#cb187-361" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-362"><a href="#cb187-362" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-363"><a href="#cb187-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-364"><a href="#cb187-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-365"><a href="#cb187-365" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-366"><a href="#cb187-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-367"><a href="#cb187-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-368"><a href="#cb187-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_an}</span></span>
<span id="cb187-369"><a href="#cb187-369" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-370"><a href="#cb187-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-371"><a href="#cb187-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-372"><a href="#cb187-372" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-373"><a href="#cb187-373" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.1"</span>,</span>
<span id="cb187-374"><a href="#cb187-374" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-375"><a href="#cb187-375" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-376"><a href="#cb187-376" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-377"><a href="#cb187-377" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-378"><a href="#cb187-378" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-379"><a href="#cb187-379" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-380"><a href="#cb187-380" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-381"><a href="#cb187-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_1_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-382"><a href="#cb187-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-383"><a href="#cb187-383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-384"><a href="#cb187-384" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-385"><a href="#cb187-385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-386"><a href="#cb187-386" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-387"><a href="#cb187-387" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-388"><a href="#cb187-388" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-389"><a href="#cb187-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-390"><a href="#cb187-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-391"><a href="#cb187-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_1_xp}</span></span>
<span id="cb187-392"><a href="#cb187-392" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-393"><a href="#cb187-393" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-394"><a href="#cb187-394" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_01.pdf"</span>),</span>
<span id="cb187-395"><a href="#cb187-395" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_01_af.pdf"</span>)</span>
<span id="cb187-396"><a href="#cb187-396" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-397"><a href="#cb187-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-398"><a href="#cb187-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-399"><a href="#cb187-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_01_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-400"><a href="#cb187-400" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-401"><a href="#cb187-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-402"><a href="#cb187-402" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-403"><a href="#cb187-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-404"><a href="#cb187-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-405"><a href="#cb187-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_01_xlsx}</span></span>
<span id="cb187-406"><a href="#cb187-406" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-407"><a href="#cb187-407" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_01 =</span> dds_1_est,</span>
<span id="cb187-408"><a href="#cb187-408" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-409"><a href="#cb187-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb187-410"><a href="#cb187-410" aria-hidden="true" tabindex="-1"></a>      <span class="st">"miRNA at baseline - differential expression by diabetes group"</span>,</span>
<span id="cb187-411"><a href="#cb187-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-412"><a href="#cb187-412" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-413"><a href="#cb187-413" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-414"><a href="#cb187-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_01"</span></span>
<span id="cb187-415"><a href="#cb187-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-416"><a href="#cb187-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-417"><a href="#cb187-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-418"><a href="#cb187-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 02</span></span>
<span id="cb187-419"><a href="#cb187-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-420"><a href="#cb187-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_02}</span></span>
<span id="cb187-421"><a href="#cb187-421" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-422"><a href="#cb187-422" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_1_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-423"><a href="#cb187-423" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-424"><a href="#cb187-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-425"><a href="#cb187-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-426"><a href="#cb187-426" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-427"><a href="#cb187-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-428"><a href="#cb187-428" aria-hidden="true" tabindex="-1"></a>dds_1_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb187-429"><a href="#cb187-429" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span id="cb187-430"><a href="#cb187-430" aria-hidden="true" tabindex="-1"></a>  dds_1_est<span class="sc">$</span>feature,</span>
<span id="cb187-431"><a href="#cb187-431" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">""</span></span>
<span id="cb187-432"><a href="#cb187-432" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-433"><a href="#cb187-433" aria-hidden="true" tabindex="-1"></a>dds_1_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_1_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb187-434"><a href="#cb187-434" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_1_est)</span>
<span id="cb187-435"><a href="#cb187-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-436"><a href="#cb187-436" aria-hidden="true" tabindex="-1"></a>dds_1_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb187-437"><a href="#cb187-437" aria-hidden="true" tabindex="-1"></a>  dds_1_est,</span>
<span id="cb187-438"><a href="#cb187-438" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb187-439"><a href="#cb187-439" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb187-440"><a href="#cb187-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-441"><a href="#cb187-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-442"><a href="#cb187-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-443"><a href="#cb187-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-444"><a href="#cb187-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb187-445"><a href="#cb187-445" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_1_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb187-446"><a href="#cb187-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb187-447"><a href="#cb187-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span></span>
<span id="cb187-448"><a href="#cb187-448" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-449"><a href="#cb187-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-450"><a href="#cb187-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_1_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb187-451"><a href="#cb187-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-452"><a href="#cb187-452" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-453"><a href="#cb187-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-454"><a href="#cb187-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-455"><a href="#cb187-455" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-456"><a href="#cb187-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-457"><a href="#cb187-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-458"><a href="#cb187-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-459"><a href="#cb187-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-460"><a href="#cb187-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-461"><a href="#cb187-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-462"><a href="#cb187-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-463"><a href="#cb187-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-464"><a href="#cb187-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-465"><a href="#cb187-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-466"><a href="#cb187-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-467"><a href="#cb187-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-468"><a href="#cb187-468" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-469"><a href="#cb187-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-470"><a href="#cb187-470" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-471"><a href="#cb187-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-472"><a href="#cb187-472" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-473"><a href="#cb187-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-474"><a href="#cb187-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-475"><a href="#cb187-475" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-476"><a href="#cb187-476" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.2"</span>,</span>
<span id="cb187-477"><a href="#cb187-477" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-478"><a href="#cb187-478" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-479"><a href="#cb187-479" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-480"><a href="#cb187-480" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-481"><a href="#cb187-481" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-482"><a href="#cb187-482" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-483"><a href="#cb187-483" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-484"><a href="#cb187-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_1_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-485"><a href="#cb187-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-486"><a href="#cb187-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-487"><a href="#cb187-487" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-488"><a href="#cb187-488" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-489"><a href="#cb187-489" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-490"><a href="#cb187-490" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-491"><a href="#cb187-491" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-492"><a href="#cb187-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-493"><a href="#cb187-493" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-494"><a href="#cb187-494" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-495"><a href="#cb187-495" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_02.pdf"</span>),</span>
<span id="cb187-496"><a href="#cb187-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_02_af.pdf"</span>)</span>
<span id="cb187-497"><a href="#cb187-497" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-498"><a href="#cb187-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-499"><a href="#cb187-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-500"><a href="#cb187-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-501"><a href="#cb187-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_02_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-502"><a href="#cb187-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-503"><a href="#cb187-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-504"><a href="#cb187-504" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-505"><a href="#cb187-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-506"><a href="#cb187-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-507"><a href="#cb187-507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, clean_dds_1}</span></span>
<span id="cb187-508"><a href="#cb187-508" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ctrl, ngs_assay, dds_1_fit, pval, log_adj, brk, dds_1_gg, p)</span>
<span id="cb187-509"><a href="#cb187-509" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb187-510"><a href="#cb187-510" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb187-511"><a href="#cb187-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-512"><a href="#cb187-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-513"><a href="#cb187-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_2` - DE: Baseline, mRNA</span></span>
<span id="cb187-514"><a href="#cb187-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-515"><a href="#cb187-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_dta}</span></span>
<span id="cb187-516"><a href="#cb187-516" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-517"><a href="#cb187-517" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb187-518"><a href="#cb187-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-519"><a href="#cb187-519" aria-hidden="true" tabindex="-1"></a>dds_2_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-520"><a href="#cb187-520" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-521"><a href="#cb187-521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(</span>
<span id="cb187-522"><a href="#cb187-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-523"><a href="#cb187-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_depth =</span> ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]</span>
<span id="cb187-524"><a href="#cb187-524" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-525"><a href="#cb187-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_coldata</span>(<span class="at">col =</span> <span class="st">"avisit"</span>, <span class="at">is =</span> <span class="st">"Baseline"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-526"><a href="#cb187-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(</span>
<span id="cb187-527"><a href="#cb187-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-528"><a href="#cb187-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_cpm =</span> ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]</span>
<span id="cb187-529"><a href="#cb187-529" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-530"><a href="#cb187-530" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-531"><a href="#cb187-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-532"><a href="#cb187-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-533"><a href="#cb187-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb187-534"><a href="#cb187-534" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb187-535"><a href="#cb187-535" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-536"><a href="#cb187-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-537"><a href="#cb187-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>()</span>
<span id="cb187-538"><a href="#cb187-538" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-539"><a href="#cb187-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-540"><a href="#cb187-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-541"><a href="#cb187-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_est}</span></span>
<span id="cb187-542"><a href="#cb187-542" aria-hidden="true" tabindex="-1"></a>dds_2_est <span class="ot">&lt;-</span> dds_2_fit <span class="sc">|&gt;</span></span>
<span id="cb187-543"><a href="#cb187-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb187-544"><a href="#cb187-544" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb187-545"><a href="#cb187-545" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb187-546"><a href="#cb187-546" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb187-547"><a href="#cb187-547" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb187-548"><a href="#cb187-548" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-549"><a href="#cb187-549" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-550"><a href="#cb187-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-551"><a href="#cb187-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-552"><a href="#cb187-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-553"><a href="#cb187-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-554"><a href="#cb187-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-555"><a href="#cb187-555" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-556"><a href="#cb187-556" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-557"><a href="#cb187-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-558"><a href="#cb187-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-559"><a href="#cb187-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb187-560"><a href="#cb187-560" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_2_est)</span>
<span id="cb187-561"><a href="#cb187-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-562"><a href="#cb187-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-563"><a href="#cb187-563" aria-hidden="true" tabindex="-1"></a>ndegenes <span class="ot">&lt;-</span> dds_2_est <span class="sc">|&gt;</span></span>
<span id="cb187-564"><a href="#cb187-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="fu">round</span>(padj, <span class="dv">5</span>) <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-565"><a href="#cb187-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">unique</span>(feature)) <span class="sc">|&gt;</span></span>
<span id="cb187-566"><a href="#cb187-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>()</span>
<span id="cb187-567"><a href="#cb187-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-568"><a href="#cb187-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-569"><a href="#cb187-569" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">round</span>(ndegenes <span class="sc">/</span> ngenes <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb187-570"><a href="#cb187-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-571"><a href="#cb187-571" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span>(dds_2_est, dds_2_est<span class="sc">$</span>ctrs) <span class="sc">|&gt;</span></span>
<span id="cb187-572"><a href="#cb187-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(\(x) {</span>
<span id="cb187-573"><a href="#cb187-573" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dim</span>(x)</span>
<span id="cb187-574"><a href="#cb187-574" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(x)</span>
<span id="cb187-575"><a href="#cb187-575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(<span class="fu">cut</span>(x<span class="sc">$</span>padj, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="dv">1</span>)))</span>
<span id="cb187-576"><a href="#cb187-576" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-577"><a href="#cb187-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-578"><a href="#cb187-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-579"><a href="#cb187-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-580"><a href="#cb187-580" aria-hidden="true" tabindex="-1"></a>pct_de_genes <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, <span class="fu">round</span>(ndegenes <span class="sc">/</span> ngenes <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb187-581"><a href="#cb187-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-582"><a href="#cb187-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-583"><a href="#cb187-583" aria-hidden="true" tabindex="-1"></a>genes_nsub <span class="ot">&lt;-</span> <span class="fu">nrow</span>(besd_mae[[ngs_assay]])</span>
<span id="cb187-584"><a href="#cb187-584" aria-hidden="true" tabindex="-1"></a>genes_de_n <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb187-585"><a href="#cb187-585" aria-hidden="true" tabindex="-1"></a>  <span class="at">Overall =</span> dds_2_est <span class="sc">|&gt;</span></span>
<span id="cb187-586"><a href="#cb187-586" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(<span class="fu">round</span>(padj, <span class="dv">5</span>) <span class="sc">&lt;</span> <span class="fl">0.001</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-587"><a href="#cb187-587" aria-hidden="true" tabindex="-1"></a>      <span class="fu">with</span>(<span class="fu">unique</span>(feature)) <span class="sc">|&gt;</span></span>
<span id="cb187-588"><a href="#cb187-588" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>()</span>
<span id="cb187-589"><a href="#cb187-589" aria-hidden="true" tabindex="-1"></a>  ,</span>
<span id="cb187-590"><a href="#cb187-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(dds_2_est, dds_2_est<span class="sc">$</span>ctrs) <span class="sc">|&gt;</span></span>
<span id="cb187-591"><a href="#cb187-591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(\(x) {</span>
<span id="cb187-592"><a href="#cb187-592" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">subset</span>(x, <span class="fu">round</span>(padj, <span class="dv">5</span>) <span class="sc">&lt;</span> <span class="fl">0.001</span>)</span>
<span id="cb187-593"><a href="#cb187-593" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(<span class="fu">unique</span>(x<span class="sc">$</span>feature))</span>
<span id="cb187-594"><a href="#cb187-594" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb187-595"><a href="#cb187-595" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-596"><a href="#cb187-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-597"><a href="#cb187-597" aria-hidden="true" tabindex="-1"></a>genes_nsub</span>
<span id="cb187-598"><a href="#cb187-598" aria-hidden="true" tabindex="-1"></a>genes_de_n</span>
<span id="cb187-599"><a href="#cb187-599" aria-hidden="true" tabindex="-1"></a>genes_de_pct <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, genes_de_n <span class="sc">/</span> genes_nsub <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb187-600"><a href="#cb187-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-601"><a href="#cb187-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-602"><a href="#cb187-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-603"><a href="#cb187-603" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 03</span></span>
<span id="cb187-604"><a href="#cb187-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-605"><a href="#cb187-605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_gg}</span></span>
<span id="cb187-606"><a href="#cb187-606" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-607"><a href="#cb187-607" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_2_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-608"><a href="#cb187-608" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-609"><a href="#cb187-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-610"><a href="#cb187-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-611"><a href="#cb187-611" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-612"><a href="#cb187-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-613"><a href="#cb187-613" aria-hidden="true" tabindex="-1"></a>dds_2_gg <span class="ot">&lt;-</span></span>
<span id="cb187-614"><a href="#cb187-614" aria-hidden="true" tabindex="-1"></a>  dds_2_est <span class="sc">|&gt;</span></span>
<span id="cb187-615"><a href="#cb187-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-616"><a href="#cb187-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-617"><a href="#cb187-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-618"><a href="#cb187-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-619"><a href="#cb187-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-620"><a href="#cb187-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-621"><a href="#cb187-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-622"><a href="#cb187-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-623"><a href="#cb187-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-624"><a href="#cb187-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-625"><a href="#cb187-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-626"><a href="#cb187-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-627"><a href="#cb187-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-628"><a href="#cb187-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-629"><a href="#cb187-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-630"><a href="#cb187-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-631"><a href="#cb187-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-632"><a href="#cb187-632" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-633"><a href="#cb187-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-634"><a href="#cb187-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-635"><a href="#cb187-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_an}</span></span>
<span id="cb187-636"><a href="#cb187-636" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-637"><a href="#cb187-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-638"><a href="#cb187-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-639"><a href="#cb187-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-640"><a href="#cb187-640" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.3"</span>,</span>
<span id="cb187-641"><a href="#cb187-641" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-642"><a href="#cb187-642" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-643"><a href="#cb187-643" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among mRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-644"><a href="#cb187-644" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-645"><a href="#cb187-645" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-646"><a href="#cb187-646" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-647"><a href="#cb187-647" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-648"><a href="#cb187-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_2_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-649"><a href="#cb187-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-650"><a href="#cb187-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-651"><a href="#cb187-651" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-652"><a href="#cb187-652" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-653"><a href="#cb187-653" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-654"><a href="#cb187-654" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-655"><a href="#cb187-655" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-656"><a href="#cb187-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-657"><a href="#cb187-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-658"><a href="#cb187-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_2_xp}</span></span>
<span id="cb187-659"><a href="#cb187-659" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-660"><a href="#cb187-660" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-661"><a href="#cb187-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_03.pdf"</span>),</span>
<span id="cb187-662"><a href="#cb187-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_03_af.pdf"</span>)</span>
<span id="cb187-663"><a href="#cb187-663" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-664"><a href="#cb187-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-665"><a href="#cb187-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-666"><a href="#cb187-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_03_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-667"><a href="#cb187-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-668"><a href="#cb187-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-669"><a href="#cb187-669" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-670"><a href="#cb187-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-671"><a href="#cb187-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-672"><a href="#cb187-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_03_xlsx}</span></span>
<span id="cb187-673"><a href="#cb187-673" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-674"><a href="#cb187-674" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_03 =</span> dds_2_est,</span>
<span id="cb187-675"><a href="#cb187-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-676"><a href="#cb187-676" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb187-677"><a href="#cb187-677" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mRNA at baseline - differential expression by diabetes group"</span>,</span>
<span id="cb187-678"><a href="#cb187-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-679"><a href="#cb187-679" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-680"><a href="#cb187-680" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-681"><a href="#cb187-681" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_03"</span></span>
<span id="cb187-682"><a href="#cb187-682" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-683"><a href="#cb187-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-684"><a href="#cb187-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-685"><a href="#cb187-685" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 04</span></span>
<span id="cb187-686"><a href="#cb187-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-687"><a href="#cb187-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_04}</span></span>
<span id="cb187-688"><a href="#cb187-688" aria-hidden="true" tabindex="-1"></a>dds_2_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENSG0+"</span>, <span class="st">""</span>, dds_2_est<span class="sc">$</span>feature)</span>
<span id="cb187-689"><a href="#cb187-689" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_2_est)</span>
<span id="cb187-690"><a href="#cb187-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-691"><a href="#cb187-691" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-692"><a href="#cb187-692" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_2_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-693"><a href="#cb187-693" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-694"><a href="#cb187-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-695"><a href="#cb187-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-696"><a href="#cb187-696" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-697"><a href="#cb187-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-698"><a href="#cb187-698" aria-hidden="true" tabindex="-1"></a>dds_2_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dds_2_est, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj)) <span class="sc">+</span></span>
<span id="cb187-699"><a href="#cb187-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-700"><a href="#cb187-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-701"><a href="#cb187-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-702"><a href="#cb187-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-703"><a href="#cb187-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb187-704"><a href="#cb187-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_2_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb187-705"><a href="#cb187-705" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb187-706"><a href="#cb187-706" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span>,</span>
<span id="cb187-707"><a href="#cb187-707" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span></span>
<span id="cb187-708"><a href="#cb187-708" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-709"><a href="#cb187-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-710"><a href="#cb187-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_2_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb187-711"><a href="#cb187-711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-712"><a href="#cb187-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-713"><a href="#cb187-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-714"><a href="#cb187-714" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb187-715"><a href="#cb187-715" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-716"><a href="#cb187-716" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-717"><a href="#cb187-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-718"><a href="#cb187-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-719"><a href="#cb187-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-720"><a href="#cb187-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-721"><a href="#cb187-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-722"><a href="#cb187-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-723"><a href="#cb187-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-724"><a href="#cb187-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-725"><a href="#cb187-725" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-726"><a href="#cb187-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-727"><a href="#cb187-727" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-728"><a href="#cb187-728" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-729"><a href="#cb187-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-730"><a href="#cb187-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-731"><a href="#cb187-731" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-732"><a href="#cb187-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-733"><a href="#cb187-733" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-734"><a href="#cb187-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-735"><a href="#cb187-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-736"><a href="#cb187-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-737"><a href="#cb187-737" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.4"</span>,</span>
<span id="cb187-738"><a href="#cb187-738" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-739"><a href="#cb187-739" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-740"><a href="#cb187-740" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Baseline"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-741"><a href="#cb187-741" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-742"><a href="#cb187-742" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-743"><a href="#cb187-743" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-744"><a href="#cb187-744" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-745"><a href="#cb187-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_2_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-746"><a href="#cb187-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-747"><a href="#cb187-747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-748"><a href="#cb187-748" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-749"><a href="#cb187-749" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-750"><a href="#cb187-750" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-751"><a href="#cb187-751" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-752"><a href="#cb187-752" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-753"><a href="#cb187-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-754"><a href="#cb187-754" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-755"><a href="#cb187-755" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-756"><a href="#cb187-756" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_04.pdf"</span>),</span>
<span id="cb187-757"><a href="#cb187-757" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_04_af.pdf"</span>)</span>
<span id="cb187-758"><a href="#cb187-758" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-759"><a href="#cb187-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-760"><a href="#cb187-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-761"><a href="#cb187-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-762"><a href="#cb187-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_04_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-763"><a href="#cb187-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-764"><a href="#cb187-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-765"><a href="#cb187-765" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-766"><a href="#cb187-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-767"><a href="#cb187-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-768"><a href="#cb187-768" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_3` - DE: Month 3, all micro RNA</span></span>
<span id="cb187-769"><a href="#cb187-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-770"><a href="#cb187-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_3_dta}</span></span>
<span id="cb187-771"><a href="#cb187-771" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-772"><a href="#cb187-772" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb187-773"><a href="#cb187-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-774"><a href="#cb187-774" aria-hidden="true" tabindex="-1"></a>dds_3_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-775"><a href="#cb187-775" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-776"><a href="#cb187-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(</span>
<span id="cb187-777"><a href="#cb187-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-778"><a href="#cb187-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_depth =</span> ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]</span>
<span id="cb187-779"><a href="#cb187-779" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-780"><a href="#cb187-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_coldata</span>(<span class="at">col =</span> <span class="st">"avisit"</span>, <span class="at">is =</span> <span class="st">"Month 3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-781"><a href="#cb187-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(</span>
<span id="cb187-782"><a href="#cb187-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-783"><a href="#cb187-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_cpm =</span> ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]</span>
<span id="cb187-784"><a href="#cb187-784" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-785"><a href="#cb187-785" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-786"><a href="#cb187-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-787"><a href="#cb187-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-788"><a href="#cb187-788" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb187-789"><a href="#cb187-789" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb187-790"><a href="#cb187-790" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-791"><a href="#cb187-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-792"><a href="#cb187-792" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb187-793"><a href="#cb187-793" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span></span>
<span id="cb187-794"><a href="#cb187-794" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-795"><a href="#cb187-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-796"><a href="#cb187-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-797"><a href="#cb187-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_3_est}</span></span>
<span id="cb187-798"><a href="#cb187-798" aria-hidden="true" tabindex="-1"></a>dds_3_est <span class="ot">&lt;-</span></span>
<span id="cb187-799"><a href="#cb187-799" aria-hidden="true" tabindex="-1"></a>  dds_3_fit <span class="sc">|&gt;</span></span>
<span id="cb187-800"><a href="#cb187-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb187-801"><a href="#cb187-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb187-802"><a href="#cb187-802" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb187-803"><a href="#cb187-803" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb187-804"><a href="#cb187-804" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb187-805"><a href="#cb187-805" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-806"><a href="#cb187-806" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-807"><a href="#cb187-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-808"><a href="#cb187-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-809"><a href="#cb187-809" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-810"><a href="#cb187-810" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-811"><a href="#cb187-811" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-812"><a href="#cb187-812" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-813"><a href="#cb187-813" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-814"><a href="#cb187-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-815"><a href="#cb187-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-816"><a href="#cb187-816" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 05</span></span>
<span id="cb187-817"><a href="#cb187-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-818"><a href="#cb187-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_05}</span></span>
<span id="cb187-819"><a href="#cb187-819" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-820"><a href="#cb187-820" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_3_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-821"><a href="#cb187-821" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-822"><a href="#cb187-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-823"><a href="#cb187-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-824"><a href="#cb187-824" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-825"><a href="#cb187-825" aria-hidden="true" tabindex="-1"></a>dds_3_gg <span class="ot">&lt;-</span></span>
<span id="cb187-826"><a href="#cb187-826" aria-hidden="true" tabindex="-1"></a>  dds_3_est <span class="sc">|&gt;</span></span>
<span id="cb187-827"><a href="#cb187-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-828"><a href="#cb187-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-829"><a href="#cb187-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-830"><a href="#cb187-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-831"><a href="#cb187-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-832"><a href="#cb187-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-833"><a href="#cb187-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-834"><a href="#cb187-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-835"><a href="#cb187-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-836"><a href="#cb187-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-837"><a href="#cb187-837" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-838"><a href="#cb187-838" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-839"><a href="#cb187-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-840"><a href="#cb187-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-841"><a href="#cb187-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-842"><a href="#cb187-842" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-843"><a href="#cb187-843" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-844"><a href="#cb187-844" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-845"><a href="#cb187-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-846"><a href="#cb187-846" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-847"><a href="#cb187-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-848"><a href="#cb187-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-849"><a href="#cb187-849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-850"><a href="#cb187-850" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.5"</span>,</span>
<span id="cb187-851"><a href="#cb187-851" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-852"><a href="#cb187-852" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-853"><a href="#cb187-853" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-854"><a href="#cb187-854" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-855"><a href="#cb187-855" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-856"><a href="#cb187-856" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-857"><a href="#cb187-857" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-858"><a href="#cb187-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_3_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-859"><a href="#cb187-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-860"><a href="#cb187-860" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-861"><a href="#cb187-861" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-862"><a href="#cb187-862" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-863"><a href="#cb187-863" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-864"><a href="#cb187-864" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-865"><a href="#cb187-865" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-866"><a href="#cb187-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-867"><a href="#cb187-867" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-868"><a href="#cb187-868" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-869"><a href="#cb187-869" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_05.pdf"</span>),</span>
<span id="cb187-870"><a href="#cb187-870" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_05_af.pdf"</span>)</span>
<span id="cb187-871"><a href="#cb187-871" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-872"><a href="#cb187-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-873"><a href="#cb187-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-874"><a href="#cb187-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_05_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-875"><a href="#cb187-875" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-876"><a href="#cb187-876" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-877"><a href="#cb187-877" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-878"><a href="#cb187-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-879"><a href="#cb187-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-880"><a href="#cb187-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_05_xlsx}</span></span>
<span id="cb187-881"><a href="#cb187-881" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-882"><a href="#cb187-882" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_05 =</span> dds_3_est,</span>
<span id="cb187-883"><a href="#cb187-883" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-884"><a href="#cb187-884" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb187-885"><a href="#cb187-885" aria-hidden="true" tabindex="-1"></a>      <span class="st">"All miRNA at month 3 - differential expression by diabetes group"</span>,</span>
<span id="cb187-886"><a href="#cb187-886" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-887"><a href="#cb187-887" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-888"><a href="#cb187-888" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-889"><a href="#cb187-889" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_05"</span></span>
<span id="cb187-890"><a href="#cb187-890" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-891"><a href="#cb187-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-892"><a href="#cb187-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-893"><a href="#cb187-893" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 06</span></span>
<span id="cb187-894"><a href="#cb187-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-895"><a href="#cb187-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_06}</span></span>
<span id="cb187-896"><a href="#cb187-896" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-897"><a href="#cb187-897" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_3_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-898"><a href="#cb187-898" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-899"><a href="#cb187-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-900"><a href="#cb187-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-901"><a href="#cb187-901" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-902"><a href="#cb187-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-903"><a href="#cb187-903" aria-hidden="true" tabindex="-1"></a>dds_3_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb187-904"><a href="#cb187-904" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span id="cb187-905"><a href="#cb187-905" aria-hidden="true" tabindex="-1"></a>  dds_3_est<span class="sc">$</span>feature,</span>
<span id="cb187-906"><a href="#cb187-906" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">""</span></span>
<span id="cb187-907"><a href="#cb187-907" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-908"><a href="#cb187-908" aria-hidden="true" tabindex="-1"></a>dds_3_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_3_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb187-909"><a href="#cb187-909" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_3_est)</span>
<span id="cb187-910"><a href="#cb187-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-911"><a href="#cb187-911" aria-hidden="true" tabindex="-1"></a>dds_3_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb187-912"><a href="#cb187-912" aria-hidden="true" tabindex="-1"></a>  dds_3_est,</span>
<span id="cb187-913"><a href="#cb187-913" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb187-914"><a href="#cb187-914" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb187-915"><a href="#cb187-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-916"><a href="#cb187-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-917"><a href="#cb187-917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-918"><a href="#cb187-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-919"><a href="#cb187-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb187-920"><a href="#cb187-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_3_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb187-921"><a href="#cb187-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb187-922"><a href="#cb187-922" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span></span>
<span id="cb187-923"><a href="#cb187-923" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-924"><a href="#cb187-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-925"><a href="#cb187-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_3_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>),</span>
<span id="cb187-926"><a href="#cb187-926" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-927"><a href="#cb187-927" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-928"><a href="#cb187-928" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-929"><a href="#cb187-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-930"><a href="#cb187-930" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-931"><a href="#cb187-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-932"><a href="#cb187-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-933"><a href="#cb187-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-934"><a href="#cb187-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-935"><a href="#cb187-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-936"><a href="#cb187-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-937"><a href="#cb187-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-938"><a href="#cb187-938" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-939"><a href="#cb187-939" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-940"><a href="#cb187-940" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-941"><a href="#cb187-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-942"><a href="#cb187-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-943"><a href="#cb187-943" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-944"><a href="#cb187-944" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-945"><a href="#cb187-945" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-946"><a href="#cb187-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-947"><a href="#cb187-947" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-948"><a href="#cb187-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-949"><a href="#cb187-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-950"><a href="#cb187-950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-951"><a href="#cb187-951" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.6"</span>,</span>
<span id="cb187-952"><a href="#cb187-952" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-953"><a href="#cb187-953" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-954"><a href="#cb187-954" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all miRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-955"><a href="#cb187-955" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-956"><a href="#cb187-956" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-957"><a href="#cb187-957" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-958"><a href="#cb187-958" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-959"><a href="#cb187-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_3_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-960"><a href="#cb187-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-961"><a href="#cb187-961" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-962"><a href="#cb187-962" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-963"><a href="#cb187-963" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-964"><a href="#cb187-964" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-965"><a href="#cb187-965" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-966"><a href="#cb187-966" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-967"><a href="#cb187-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-968"><a href="#cb187-968" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-969"><a href="#cb187-969" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-970"><a href="#cb187-970" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_06.pdf"</span>),</span>
<span id="cb187-971"><a href="#cb187-971" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_06_af.pdf"</span>)</span>
<span id="cb187-972"><a href="#cb187-972" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-973"><a href="#cb187-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-974"><a href="#cb187-974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-975"><a href="#cb187-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-976"><a href="#cb187-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_06_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-977"><a href="#cb187-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-978"><a href="#cb187-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-979"><a href="#cb187-979" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-980"><a href="#cb187-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-981"><a href="#cb187-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-982"><a href="#cb187-982" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_4` - DE: Month 3, mRNA</span></span>
<span id="cb187-983"><a href="#cb187-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-984"><a href="#cb187-984" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_4_dta}</span></span>
<span id="cb187-985"><a href="#cb187-985" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-986"><a href="#cb187-986" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb187-987"><a href="#cb187-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-988"><a href="#cb187-988" aria-hidden="true" tabindex="-1"></a>dds_4_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-989"><a href="#cb187-989" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-990"><a href="#cb187-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(</span>
<span id="cb187-991"><a href="#cb187-991" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-992"><a href="#cb187-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_depth =</span> ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]</span>
<span id="cb187-993"><a href="#cb187-993" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-994"><a href="#cb187-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_coldata</span>(<span class="at">col =</span> <span class="st">"avisit"</span>, <span class="at">is =</span> <span class="st">"Month 3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-995"><a href="#cb187-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(</span>
<span id="cb187-996"><a href="#cb187-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay =</span> ngs_assay,</span>
<span id="cb187-997"><a href="#cb187-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_cpm =</span> ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]</span>
<span id="cb187-998"><a href="#cb187-998" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-999"><a href="#cb187-999" aria-hidden="true" tabindex="-1"></a>  (\(mae) DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-1000"><a href="#cb187-1000" aria-hidden="true" tabindex="-1"></a>    <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-1001"><a href="#cb187-1001" aria-hidden="true" tabindex="-1"></a>    <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-1002"><a href="#cb187-1002" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> stats<span class="sc">::</span><span class="fu">formula</span>(<span class="sc">~</span> diabcd)</span>
<span id="cb187-1003"><a href="#cb187-1003" aria-hidden="true" tabindex="-1"></a>  ) )() <span class="sc">|&gt;</span></span>
<span id="cb187-1004"><a href="#cb187-1004" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-1005"><a href="#cb187-1005" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-1006"><a href="#cb187-1006" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>()</span>
<span id="cb187-1007"><a href="#cb187-1007" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1008"><a href="#cb187-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1009"><a href="#cb187-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1010"><a href="#cb187-1010" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_4_est}</span></span>
<span id="cb187-1011"><a href="#cb187-1011" aria-hidden="true" tabindex="-1"></a>dds_4_est <span class="ot">&lt;-</span></span>
<span id="cb187-1012"><a href="#cb187-1012" aria-hidden="true" tabindex="-1"></a>  dds_4_fit <span class="sc">|&gt;</span></span>
<span id="cb187-1013"><a href="#cb187-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_ctrs</span>(</span>
<span id="cb187-1014"><a href="#cb187-1014" aria-hidden="true" tabindex="-1"></a>    <span class="at">ctrs =</span> <span class="fu">list</span>(</span>
<span id="cb187-1015"><a href="#cb187-1015" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>),</span>
<span id="cb187-1016"><a href="#cb187-1016" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"T2D"</span>, <span class="at">ref =</span> <span class="st">"IGT"</span>),</span>
<span id="cb187-1017"><a href="#cb187-1017" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="at">test =</span> <span class="st">"IGT"</span>, <span class="at">ref =</span> <span class="st">"NGT"</span>)</span>
<span id="cb187-1018"><a href="#cb187-1018" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1019"><a href="#cb187-1019" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1020"><a href="#cb187-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-1021"><a href="#cb187-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-1022"><a href="#cb187-1022" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-1023"><a href="#cb187-1023" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-1024"><a href="#cb187-1024" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-1025"><a href="#cb187-1025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-1026"><a href="#cb187-1026" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-1027"><a href="#cb187-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1028"><a href="#cb187-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1029"><a href="#cb187-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 07</span></span>
<span id="cb187-1030"><a href="#cb187-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1031"><a href="#cb187-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_07}</span></span>
<span id="cb187-1032"><a href="#cb187-1032" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1033"><a href="#cb187-1033" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_4_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1034"><a href="#cb187-1034" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1035"><a href="#cb187-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1036"><a href="#cb187-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1037"><a href="#cb187-1037" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1038"><a href="#cb187-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1039"><a href="#cb187-1039" aria-hidden="true" tabindex="-1"></a>dds_4_gg <span class="ot">&lt;-</span> dds_4_est <span class="sc">|&gt;</span></span>
<span id="cb187-1040"><a href="#cb187-1040" aria-hidden="true" tabindex="-1"></a>  <span class="co"># All pval close to 1 disturbe the hex-density plots</span></span>
<span id="cb187-1041"><a href="#cb187-1041" aria-hidden="true" tabindex="-1"></a>  (\(df) {</span>
<span id="cb187-1042"><a href="#cb187-1042" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assert_that</span>(<span class="fu">all</span>(df<span class="sc">$</span>padj[df<span class="sc">$</span>ctrs <span class="sc">==</span> <span class="st">"IGT vs NGT"</span>] <span class="sc">&gt;</span> <span class="fl">0.991</span>))</span>
<span id="cb187-1043"><a href="#cb187-1043" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb187-1044"><a href="#cb187-1044" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span></span>
<span id="cb187-1045"><a href="#cb187-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(ctrs <span class="sc">!=</span> <span class="st">"IGT vs NGT"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-1046"><a href="#cb187-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-1047"><a href="#cb187-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1048"><a href="#cb187-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1049"><a href="#cb187-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1050"><a href="#cb187-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-1051"><a href="#cb187-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1052"><a href="#cb187-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1053"><a href="#cb187-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-1054"><a href="#cb187-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1055"><a href="#cb187-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1056"><a href="#cb187-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1057"><a href="#cb187-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1058"><a href="#cb187-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1059"><a href="#cb187-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1060"><a href="#cb187-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1061"><a href="#cb187-1061" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1062"><a href="#cb187-1062" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1063"><a href="#cb187-1063" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1064"><a href="#cb187-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1065"><a href="#cb187-1065" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1066"><a href="#cb187-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1067"><a href="#cb187-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1068"><a href="#cb187-1068" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1069"><a href="#cb187-1069" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.7"</span>,</span>
<span id="cb187-1070"><a href="#cb187-1070" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1071"><a href="#cb187-1071" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-1072"><a href="#cb187-1072" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among all mRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1073"><a href="#cb187-1073" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1074"><a href="#cb187-1074" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1075"><a href="#cb187-1075" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1076"><a href="#cb187-1076" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1077"><a href="#cb187-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_4_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1078"><a href="#cb187-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_note</span>(<span class="fu">c</span>(</span>
<span id="cb187-1079"><a href="#cb187-1079" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NOTE: all feature comparisons between IGT and NGT were characterised by</span></span>
<span id="cb187-1080"><a href="#cb187-1080" aria-hidden="true" tabindex="-1"></a><span class="st">    adjusted p.values greater than 0.99; to preserve the hexagonal-density</span></span>
<span id="cb187-1081"><a href="#cb187-1081" aria-hidden="true" tabindex="-1"></a><span class="st">    plot, this comparison was not represented."</span></span>
<span id="cb187-1082"><a href="#cb187-1082" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb187-1083"><a href="#cb187-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1084"><a href="#cb187-1084" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1085"><a href="#cb187-1085" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1086"><a href="#cb187-1086" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1087"><a href="#cb187-1087" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1088"><a href="#cb187-1088" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1089"><a href="#cb187-1089" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1090"><a href="#cb187-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1091"><a href="#cb187-1091" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1092"><a href="#cb187-1092" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1093"><a href="#cb187-1093" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_07.pdf"</span>),</span>
<span id="cb187-1094"><a href="#cb187-1094" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_07_af.pdf"</span>)</span>
<span id="cb187-1095"><a href="#cb187-1095" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1096"><a href="#cb187-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1097"><a href="#cb187-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1098"><a href="#cb187-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_07_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1099"><a href="#cb187-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1100"><a href="#cb187-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1101"><a href="#cb187-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1102"><a href="#cb187-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1103"><a href="#cb187-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1104"><a href="#cb187-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_07_xlsx}</span></span>
<span id="cb187-1105"><a href="#cb187-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-1106"><a href="#cb187-1106" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_07 =</span> dds_4_est,</span>
<span id="cb187-1107"><a href="#cb187-1107" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-1108"><a href="#cb187-1108" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span></span>
<span id="cb187-1109"><a href="#cb187-1109" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mRNA at month 3 - differential expression by diabetes group"</span>,</span>
<span id="cb187-1110"><a href="#cb187-1110" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-1111"><a href="#cb187-1111" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-1112"><a href="#cb187-1112" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-1113"><a href="#cb187-1113" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_07"</span></span>
<span id="cb187-1114"><a href="#cb187-1114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1115"><a href="#cb187-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1116"><a href="#cb187-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1117"><a href="#cb187-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 08</span></span>
<span id="cb187-1118"><a href="#cb187-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1119"><a href="#cb187-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_08}</span></span>
<span id="cb187-1120"><a href="#cb187-1120" aria-hidden="true" tabindex="-1"></a>dds_4_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENSG0+"</span>, <span class="st">""</span>, dds_4_est<span class="sc">$</span>feature)</span>
<span id="cb187-1121"><a href="#cb187-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_4_est)</span>
<span id="cb187-1122"><a href="#cb187-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1123"><a href="#cb187-1123" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1124"><a href="#cb187-1124" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_4_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1125"><a href="#cb187-1125" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1126"><a href="#cb187-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1127"><a href="#cb187-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1128"><a href="#cb187-1128" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1129"><a href="#cb187-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1130"><a href="#cb187-1130" aria-hidden="true" tabindex="-1"></a>dds_4_gg <span class="ot">&lt;-</span> dds_4_est <span class="sc">|&gt;</span></span>
<span id="cb187-1131"><a href="#cb187-1131" aria-hidden="true" tabindex="-1"></a>  <span class="co"># All pval close to 1 disturbe the hex-density plots</span></span>
<span id="cb187-1132"><a href="#cb187-1132" aria-hidden="true" tabindex="-1"></a>  (\(df) {</span>
<span id="cb187-1133"><a href="#cb187-1133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assert_that</span>(<span class="fu">all</span>(df<span class="sc">$</span>padj[df<span class="sc">$</span>ctrs <span class="sc">==</span> <span class="st">"IGT vs NGT"</span>] <span class="sc">&gt;</span> <span class="fl">0.991</span>))</span>
<span id="cb187-1134"><a href="#cb187-1134" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb187-1135"><a href="#cb187-1135" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span></span>
<span id="cb187-1136"><a href="#cb187-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(ctrs <span class="sc">!=</span> <span class="st">"IGT vs NGT"</span>) <span class="sc">|&gt;</span></span>
<span id="cb187-1137"><a href="#cb187-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj)) <span class="sc">+</span></span>
<span id="cb187-1138"><a href="#cb187-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1139"><a href="#cb187-1139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1140"><a href="#cb187-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1141"><a href="#cb187-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-1142"><a href="#cb187-1142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb187-1143"><a href="#cb187-1143" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_4_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb187-1144"><a href="#cb187-1144" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb187-1145"><a href="#cb187-1145" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">3</span>,</span>
<span id="cb187-1146"><a href="#cb187-1146" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span></span>
<span id="cb187-1147"><a href="#cb187-1147" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-1148"><a href="#cb187-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-1149"><a href="#cb187-1149" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(dds_4_est, padj <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">2</span>),</span>
<span id="cb187-1150"><a href="#cb187-1150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-1151"><a href="#cb187-1151" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-1152"><a href="#cb187-1152" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-1153"><a href="#cb187-1153" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"royalblue"</span>,</span>
<span id="cb187-1154"><a href="#cb187-1154" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-1155"><a href="#cb187-1155" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-1156"><a href="#cb187-1156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1157"><a href="#cb187-1157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-1158"><a href="#cb187-1158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1159"><a href="#cb187-1159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-1160"><a href="#cb187-1160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-1161"><a href="#cb187-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1162"><a href="#cb187-1162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1163"><a href="#cb187-1163" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1164"><a href="#cb187-1164" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1165"><a href="#cb187-1165" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1166"><a href="#cb187-1166" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1167"><a href="#cb187-1167" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1168"><a href="#cb187-1168" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1169"><a href="#cb187-1169" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1170"><a href="#cb187-1170" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1171"><a href="#cb187-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1172"><a href="#cb187-1172" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1173"><a href="#cb187-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1174"><a href="#cb187-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1175"><a href="#cb187-1175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1176"><a href="#cb187-1176" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.8"</span>,</span>
<span id="cb187-1177"><a href="#cb187-1177" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1178"><a href="#cb187-1178" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Response Size and Significance of Differential</span></span>
<span id="cb187-1179"><a href="#cb187-1179" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among mRNA at Month 3"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1180"><a href="#cb187-1180" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1181"><a href="#cb187-1181" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1182"><a href="#cb187-1182" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1183"><a href="#cb187-1183" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1184"><a href="#cb187-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_4_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1185"><a href="#cb187-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_note</span>(<span class="fu">c</span>(</span>
<span id="cb187-1186"><a href="#cb187-1186" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NOTE: all feature comparisons between IGT and NGT were characterised by</span></span>
<span id="cb187-1187"><a href="#cb187-1187" aria-hidden="true" tabindex="-1"></a><span class="st">    adjusted p.values greater than 0.99; to preserve the hexagonal-density</span></span>
<span id="cb187-1188"><a href="#cb187-1188" aria-hidden="true" tabindex="-1"></a><span class="st">    plot, this comparison was not represented."</span></span>
<span id="cb187-1189"><a href="#cb187-1189" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb187-1190"><a href="#cb187-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1191"><a href="#cb187-1191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1192"><a href="#cb187-1192" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1193"><a href="#cb187-1193" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1194"><a href="#cb187-1194" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1195"><a href="#cb187-1195" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1196"><a href="#cb187-1196" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1197"><a href="#cb187-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1198"><a href="#cb187-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1199"><a href="#cb187-1199" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1200"><a href="#cb187-1200" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_08.pdf"</span>),</span>
<span id="cb187-1201"><a href="#cb187-1201" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_08_af.pdf"</span>)</span>
<span id="cb187-1202"><a href="#cb187-1202" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1203"><a href="#cb187-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1204"><a href="#cb187-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1205"><a href="#cb187-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1206"><a href="#cb187-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_08_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1207"><a href="#cb187-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1208"><a href="#cb187-1208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1209"><a href="#cb187-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1210"><a href="#cb187-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1211"><a href="#cb187-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1212"><a href="#cb187-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_5` - DE: Exercise intervention, all micro RNA</span></span>
<span id="cb187-1213"><a href="#cb187-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1214"><a href="#cb187-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_5_dta}</span></span>
<span id="cb187-1215"><a href="#cb187-1215" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-1216"><a href="#cb187-1216" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"allmirna"</span></span>
<span id="cb187-1217"><a href="#cb187-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1218"><a href="#cb187-1218" aria-hidden="true" tabindex="-1"></a>filter_for_paired_visits <span class="ot">&lt;-</span> <span class="cf">function</span>(mae) {</span>
<span id="cb187-1219"><a href="#cb187-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">table</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid) <span class="sc">&lt;=</span> <span class="dv">2</span>))</span>
<span id="cb187-1220"><a href="#cb187-1220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1221"><a href="#cb187-1221" aria-hidden="true" tabindex="-1"></a>  subj <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid)</span>
<span id="cb187-1222"><a href="#cb187-1222" aria-hidden="true" tabindex="-1"></a>  subj <span class="ot">&lt;-</span> <span class="fu">names</span>(subj[subj <span class="sc">==</span> <span class="dv">2</span>])</span>
<span id="cb187-1223"><a href="#cb187-1223" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> mae[, <span class="fu">colData</span>(mae)<span class="sc">$</span>subjid <span class="sc">%in%</span> subj, ]</span>
<span id="cb187-1224"><a href="#cb187-1224" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1225"><a href="#cb187-1225" aria-hidden="true" tabindex="-1"></a>  chk_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">colData</span>(mae))</span>
<span id="cb187-1226"><a href="#cb187-1226" aria-hidden="true" tabindex="-1"></a>  check <span class="ot">&lt;-</span> <span class="fu">split</span>(chk_df, <span class="at">f =</span> chk_df<span class="sc">$</span>avisit)</span>
<span id="cb187-1227"><a href="#cb187-1227" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1228"><a href="#cb187-1228" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Verify the selection:</span></span>
<span id="cb187-1229"><a href="#cb187-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assert_that</span>(<span class="fu">all</span>(</span>
<span id="cb187-1230"><a href="#cb187-1230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(check, <span class="at">subj =</span> subj,\(x, subj) <span class="fu">all</span>(subj <span class="sc">%in%</span> x<span class="sc">$</span>subjid))</span>
<span id="cb187-1231"><a href="#cb187-1231" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb187-1232"><a href="#cb187-1232" aria-hidden="true" tabindex="-1"></a>  mae</span>
<span id="cb187-1233"><a href="#cb187-1233" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-1234"><a href="#cb187-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1235"><a href="#cb187-1235" aria-hidden="true" tabindex="-1"></a>dds_5_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-1236"><a href="#cb187-1236" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-1237"><a href="#cb187-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb187-1238"><a href="#cb187-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_paired_visits</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1239"><a href="#cb187-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb187-1240"><a href="#cb187-1240" aria-hidden="true" tabindex="-1"></a>  (\(mae) {</span>
<span id="cb187-1241"><a href="#cb187-1241" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &lt;https://support.bioconductor.org/p/84241/#84296&gt;</span></span>
<span id="cb187-1242"><a href="#cb187-1242" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Or:</span></span>
<span id="cb187-1243"><a href="#cb187-1243" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vignette('DESeq2'),</span></span>
<span id="cb187-1244"><a href="#cb187-1244" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &gt; Section: "Group-specific condition effects, individuals nested</span></span>
<span id="cb187-1245"><a href="#cb187-1245" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &gt; within groups"</span></span>
<span id="cb187-1246"><a href="#cb187-1246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae) <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(<span class="fu">colData</span>(mae))</span>
<span id="cb187-1247"><a href="#cb187-1247" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae)<span class="sc">$</span>subjid <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid)</span>
<span id="cb187-1248"><a href="#cb187-1248" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae)<span class="sc">$</span>avisit_ <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb187-1249"><a href="#cb187-1249" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colData</span>(mae)<span class="sc">$</span>avisit,</span>
<span id="cb187-1250"><a href="#cb187-1250" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">levels</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>avisit),</span>
<span id="cb187-1251"><a href="#cb187-1251" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">sub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">levels</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>avisit))</span>
<span id="cb187-1252"><a href="#cb187-1252" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1253"><a href="#cb187-1253" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> <span class="fu">colData</span>(mae)[<span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="st">"subjid"</span>, <span class="st">"avisit_"</span>)]</span>
<span id="cb187-1254"><a href="#cb187-1254" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1255"><a href="#cb187-1255" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> <span class="fu">do.call</span>(</span>
<span id="cb187-1256"><a href="#cb187-1256" aria-hidden="true" tabindex="-1"></a>      rbind,</span>
<span id="cb187-1257"><a href="#cb187-1257" aria-hidden="true" tabindex="-1"></a>      <span class="fu">by</span>(</span>
<span id="cb187-1258"><a href="#cb187-1258" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> coldata,</span>
<span id="cb187-1259"><a href="#cb187-1259" aria-hidden="true" tabindex="-1"></a>        <span class="at">INDICES =</span> <span class="fu">list</span>(coldata<span class="sc">$</span>diabcd),</span>
<span id="cb187-1260"><a href="#cb187-1260" aria-hidden="true" tabindex="-1"></a>        <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb187-1261"><a href="#cb187-1261" aria-hidden="true" tabindex="-1"></a>          subjid <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x<span class="sc">$</span>subjid)<span class="co"># nolint</span></span>
<span id="cb187-1262"><a href="#cb187-1262" aria-hidden="true" tabindex="-1"></a>          x<span class="sc">$</span>P.n <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="co"># nolint</span></span>
<span id="cb187-1263"><a href="#cb187-1263" aria-hidden="true" tabindex="-1"></a>            subjid,</span>
<span id="cb187-1264"><a href="#cb187-1264" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">levels</span>(subjid),</span>
<span id="cb187-1265"><a href="#cb187-1265" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"P."</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(subjid))</span>
<span id="cb187-1266"><a href="#cb187-1266" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb187-1267"><a href="#cb187-1267" aria-hidden="true" tabindex="-1"></a>          x[<span class="fu">order</span>(x<span class="sc">$</span>subjid, x<span class="sc">$</span>diabcd), ]</span>
<span id="cb187-1268"><a href="#cb187-1268" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb187-1269"><a href="#cb187-1269" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb187-1270"><a href="#cb187-1270" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1271"><a href="#cb187-1271" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1272"><a href="#cb187-1272" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> coldata[<span class="fu">rownames</span>(<span class="fu">colData</span>(mae)), ]</span>
<span id="cb187-1273"><a href="#cb187-1273" aria-hidden="true" tabindex="-1"></a>    dsgn <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(</span>
<span id="cb187-1274"><a href="#cb187-1274" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>diabcd <span class="sc">+</span> diabcd<span class="sc">:</span>P.n <span class="sc">+</span> diabcd<span class="sc">:</span>avisit_,</span>
<span id="cb187-1275"><a href="#cb187-1275" aria-hidden="true" tabindex="-1"></a>      coldata</span>
<span id="cb187-1276"><a href="#cb187-1276" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1277"><a href="#cb187-1277" aria-hidden="true" tabindex="-1"></a>    dsgn <span class="ot">&lt;-</span> dsgn[, <span class="fu">colSums</span>(dsgn) <span class="sc">!=</span> <span class="dv">0</span>]</span>
<span id="cb187-1278"><a href="#cb187-1278" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1279"><a href="#cb187-1279" aria-hidden="true" tabindex="-1"></a>    DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-1280"><a href="#cb187-1280" aria-hidden="true" tabindex="-1"></a>      <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-1281"><a href="#cb187-1281" aria-hidden="true" tabindex="-1"></a>      <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-1282"><a href="#cb187-1282" aria-hidden="true" tabindex="-1"></a>      <span class="at">design =</span> dsgn</span>
<span id="cb187-1283"><a href="#cb187-1283" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1284"><a href="#cb187-1284" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span></span>
<span id="cb187-1285"><a href="#cb187-1285" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-1286"><a href="#cb187-1286" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-1287"><a href="#cb187-1287" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb187-1288"><a href="#cb187-1288" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span>,</span>
<span id="cb187-1289"><a href="#cb187-1289" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaPrior =</span> <span class="cn">FALSE</span></span>
<span id="cb187-1290"><a href="#cb187-1290" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1291"><a href="#cb187-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1292"><a href="#cb187-1292" aria-hidden="true" tabindex="-1"></a>de_by_name <span class="ot">&lt;-</span> <span class="cf">function</span>(df,</span>
<span id="cb187-1293"><a href="#cb187-1293" aria-hidden="true" tabindex="-1"></a>                       name,</span>
<span id="cb187-1294"><a href="#cb187-1294" aria-hidden="true" tabindex="-1"></a>                       <span class="at">adj_meth =</span> ctrl<span class="sc">$</span>adj_meth) {</span>
<span id="cb187-1295"><a href="#cb187-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(</span>
<span id="cb187-1296"><a href="#cb187-1296" aria-hidden="true" tabindex="-1"></a>    name,</span>
<span id="cb187-1297"><a href="#cb187-1297" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> df,</span>
<span id="cb187-1298"><a href="#cb187-1298" aria-hidden="true" tabindex="-1"></a>    <span class="at">adj_meth =</span> adj_meth,</span>
<span id="cb187-1299"><a href="#cb187-1299" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> <span class="cf">function</span>(x, fit, adj_meth) {</span>
<span id="cb187-1300"><a href="#cb187-1300" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> DESeq2<span class="sc">::</span><span class="fu">results</span>(fit, <span class="at">name =</span> x, <span class="at">pAdjustMethod =</span> adj_meth)</span>
<span id="cb187-1301"><a href="#cb187-1301" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(y)</span>
<span id="cb187-1302"><a href="#cb187-1302" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>log_padj <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(y<span class="sc">$</span>padj)</span>
<span id="cb187-1303"><a href="#cb187-1303" aria-hidden="true" tabindex="-1"></a>      y<span class="sc">$</span>ctrs <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb187-1304"><a href="#cb187-1304" aria-hidden="true" tabindex="-1"></a>        <span class="at">pattern =</span> <span class="st">"^diabcd(...)</span><span class="sc">\\</span><span class="st">.avisit.*$"</span>,</span>
<span id="cb187-1305"><a href="#cb187-1305" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> x,</span>
<span id="cb187-1306"><a href="#cb187-1306" aria-hidden="true" tabindex="-1"></a>        <span class="at">replacement =</span> <span class="st">"chg </span><span class="sc">\\</span><span class="st">1"</span></span>
<span id="cb187-1307"><a href="#cb187-1307" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb187-1308"><a href="#cb187-1308" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>(y)</span>
<span id="cb187-1309"><a href="#cb187-1309" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb187-1310"><a href="#cb187-1310" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1311"><a href="#cb187-1311" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-1312"><a href="#cb187-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1313"><a href="#cb187-1313" aria-hidden="true" tabindex="-1"></a>dds_5_est <span class="ot">&lt;-</span></span>
<span id="cb187-1314"><a href="#cb187-1314" aria-hidden="true" tabindex="-1"></a>  dds_5_fit <span class="sc">|&gt;</span></span>
<span id="cb187-1315"><a href="#cb187-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_name</span>(</span>
<span id="cb187-1316"><a href="#cb187-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb187-1317"><a href="#cb187-1317" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_ngt =</span> <span class="st">"diabcdNGT.avisit_Month_3"</span>,</span>
<span id="cb187-1318"><a href="#cb187-1318" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_igt =</span> <span class="st">"diabcdIGT.avisit_Month_3"</span>,</span>
<span id="cb187-1319"><a href="#cb187-1319" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_t2d =</span> <span class="st">"diabcdT2D.avisit_Month_3"</span></span>
<span id="cb187-1320"><a href="#cb187-1320" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1321"><a href="#cb187-1321" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1322"><a href="#cb187-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-1323"><a href="#cb187-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>(</span>
<span id="cb187-1324"><a href="#cb187-1324" aria-hidden="true" tabindex="-1"></a>    ctrs <span class="ot">&lt;-</span> <span class="fu">factor</span>(ctrs, <span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">"chg"</span>, <span class="fu">c</span>(<span class="st">"NGT"</span>, <span class="st">"IGT"</span>, <span class="st">"T2D"</span>)))</span>
<span id="cb187-1325"><a href="#cb187-1325" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1326"><a href="#cb187-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-1327"><a href="#cb187-1327" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-1328"><a href="#cb187-1328" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-1329"><a href="#cb187-1329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-1330"><a href="#cb187-1330" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-1331"><a href="#cb187-1331" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-1332"><a href="#cb187-1332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1333"><a href="#cb187-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1334"><a href="#cb187-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 09</span></span>
<span id="cb187-1335"><a href="#cb187-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1336"><a href="#cb187-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_09}</span></span>
<span id="cb187-1337"><a href="#cb187-1337" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1338"><a href="#cb187-1338" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_5_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1339"><a href="#cb187-1339" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1340"><a href="#cb187-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1341"><a href="#cb187-1341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1342"><a href="#cb187-1342" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1343"><a href="#cb187-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1344"><a href="#cb187-1344" aria-hidden="true" tabindex="-1"></a>dds_5_gg <span class="ot">&lt;-</span></span>
<span id="cb187-1345"><a href="#cb187-1345" aria-hidden="true" tabindex="-1"></a>  dds_5_est <span class="sc">|&gt;</span></span>
<span id="cb187-1346"><a href="#cb187-1346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-1347"><a href="#cb187-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1348"><a href="#cb187-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1349"><a href="#cb187-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1350"><a href="#cb187-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-1351"><a href="#cb187-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1352"><a href="#cb187-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1353"><a href="#cb187-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-1354"><a href="#cb187-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1355"><a href="#cb187-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1356"><a href="#cb187-1356" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1357"><a href="#cb187-1357" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1358"><a href="#cb187-1358" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1359"><a href="#cb187-1359" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1360"><a href="#cb187-1360" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1361"><a href="#cb187-1361" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1362"><a href="#cb187-1362" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1363"><a href="#cb187-1363" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1364"><a href="#cb187-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1365"><a href="#cb187-1365" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1366"><a href="#cb187-1366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1367"><a href="#cb187-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1368"><a href="#cb187-1368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1369"><a href="#cb187-1369" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.9"</span>,</span>
<span id="cb187-1370"><a href="#cb187-1370" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1371"><a href="#cb187-1371" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span id="cb187-1372"><a href="#cb187-1372" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among micro RNA in response to the exercise</span></span>
<span id="cb187-1373"><a href="#cb187-1373" aria-hidden="true" tabindex="-1"></a><span class="st">        intervention (CHG)"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1374"><a href="#cb187-1374" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1375"><a href="#cb187-1375" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1376"><a href="#cb187-1376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1377"><a href="#cb187-1377" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1378"><a href="#cb187-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_5_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1379"><a href="#cb187-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1380"><a href="#cb187-1380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1381"><a href="#cb187-1381" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1382"><a href="#cb187-1382" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1383"><a href="#cb187-1383" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1384"><a href="#cb187-1384" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1385"><a href="#cb187-1385" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1386"><a href="#cb187-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1387"><a href="#cb187-1387" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1388"><a href="#cb187-1388" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1389"><a href="#cb187-1389" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_09.pdf"</span>),</span>
<span id="cb187-1390"><a href="#cb187-1390" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_09_af.pdf"</span>)</span>
<span id="cb187-1391"><a href="#cb187-1391" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1392"><a href="#cb187-1392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1393"><a href="#cb187-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1394"><a href="#cb187-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_09_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1395"><a href="#cb187-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1396"><a href="#cb187-1396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1397"><a href="#cb187-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1398"><a href="#cb187-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1399"><a href="#cb187-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1400"><a href="#cb187-1400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_09_xlsx}</span></span>
<span id="cb187-1401"><a href="#cb187-1401" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-1402"><a href="#cb187-1402" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_09 =</span> dds_5_est,</span>
<span id="cb187-1403"><a href="#cb187-1403" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-1404"><a href="#cb187-1404" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(</span>
<span id="cb187-1405"><a href="#cb187-1405" aria-hidden="true" tabindex="-1"></a>      <span class="st">"All miRNA Change from Baseline - differential expression by diabetes"</span>,</span>
<span id="cb187-1406"><a href="#cb187-1406" aria-hidden="true" tabindex="-1"></a>      <span class="st">"group"</span></span>
<span id="cb187-1407"><a href="#cb187-1407" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1408"><a href="#cb187-1408" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-1409"><a href="#cb187-1409" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-1410"><a href="#cb187-1410" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-1411"><a href="#cb187-1411" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_09"</span></span>
<span id="cb187-1412"><a href="#cb187-1412" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1413"><a href="#cb187-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1414"><a href="#cb187-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1415"><a href="#cb187-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 10</span></span>
<span id="cb187-1416"><a href="#cb187-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1417"><a href="#cb187-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_10}</span></span>
<span id="cb187-1418"><a href="#cb187-1418" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1419"><a href="#cb187-1419" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_5_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1420"><a href="#cb187-1420" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1421"><a href="#cb187-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1422"><a href="#cb187-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1423"><a href="#cb187-1423" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1424"><a href="#cb187-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1425"><a href="#cb187-1425" aria-hidden="true" tabindex="-1"></a>dds_5_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(</span>
<span id="cb187-1426"><a href="#cb187-1426" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hsa-(mir|miR|let)-"</span>,</span>
<span id="cb187-1427"><a href="#cb187-1427" aria-hidden="true" tabindex="-1"></a>  dds_5_est<span class="sc">$</span>feature,</span>
<span id="cb187-1428"><a href="#cb187-1428" aria-hidden="true" tabindex="-1"></a>  <span class="at">replacement =</span> <span class="st">""</span></span>
<span id="cb187-1429"><a href="#cb187-1429" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1430"><a href="#cb187-1430" aria-hidden="true" tabindex="-1"></a>dds_5_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_5_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb187-1431"><a href="#cb187-1431" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dds_5_est)</span>
<span id="cb187-1432"><a href="#cb187-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1433"><a href="#cb187-1433" aria-hidden="true" tabindex="-1"></a>dds_5_txt <span class="ot">&lt;-</span> <span class="fu">subset</span>(dds_5_est, padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> .<span class="dv">5</span>)</span>
<span id="cb187-1434"><a href="#cb187-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1435"><a href="#cb187-1435" aria-hidden="true" tabindex="-1"></a>dds_5_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb187-1436"><a href="#cb187-1436" aria-hidden="true" tabindex="-1"></a>  dds_5_est,</span>
<span id="cb187-1437"><a href="#cb187-1437" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb187-1438"><a href="#cb187-1438" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb187-1439"><a href="#cb187-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1440"><a href="#cb187-1440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1441"><a href="#cb187-1441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1442"><a href="#cb187-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-1443"><a href="#cb187-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dds_5_txt, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-1444"><a href="#cb187-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-1445"><a href="#cb187-1445" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dds_5_txt,</span>
<span id="cb187-1446"><a href="#cb187-1446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-1447"><a href="#cb187-1447" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-1448"><a href="#cb187-1448" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-1449"><a href="#cb187-1449" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-1450"><a href="#cb187-1450" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-1451"><a href="#cb187-1451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1452"><a href="#cb187-1452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-1453"><a href="#cb187-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1454"><a href="#cb187-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-1455"><a href="#cb187-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-1456"><a href="#cb187-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1457"><a href="#cb187-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1458"><a href="#cb187-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1459"><a href="#cb187-1459" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1460"><a href="#cb187-1460" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1461"><a href="#cb187-1461" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1462"><a href="#cb187-1462" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1463"><a href="#cb187-1463" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1464"><a href="#cb187-1464" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1465"><a href="#cb187-1465" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1466"><a href="#cb187-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1467"><a href="#cb187-1467" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1468"><a href="#cb187-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1469"><a href="#cb187-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1470"><a href="#cb187-1470" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1471"><a href="#cb187-1471" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.10"</span>,</span>
<span id="cb187-1472"><a href="#cb187-1472" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1473"><a href="#cb187-1473" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span id="cb187-1474"><a href="#cb187-1474" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among micro RNA in response to the exercise</span></span>
<span id="cb187-1475"><a href="#cb187-1475" aria-hidden="true" tabindex="-1"></a><span class="st">        intervention (CHG)"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1476"><a href="#cb187-1476" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1477"><a href="#cb187-1477" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1478"><a href="#cb187-1478" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1479"><a href="#cb187-1479" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1480"><a href="#cb187-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_5_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1481"><a href="#cb187-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1482"><a href="#cb187-1482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1483"><a href="#cb187-1483" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1484"><a href="#cb187-1484" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1485"><a href="#cb187-1485" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1486"><a href="#cb187-1486" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1487"><a href="#cb187-1487" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1488"><a href="#cb187-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1489"><a href="#cb187-1489" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1490"><a href="#cb187-1490" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1491"><a href="#cb187-1491" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_10.pdf"</span>),</span>
<span id="cb187-1492"><a href="#cb187-1492" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_10_af.pdf"</span>)</span>
<span id="cb187-1493"><a href="#cb187-1493" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1494"><a href="#cb187-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1495"><a href="#cb187-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1496"><a href="#cb187-1496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_10_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1497"><a href="#cb187-1497" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1498"><a href="#cb187-1498" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1499"><a href="#cb187-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1500"><a href="#cb187-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1501"><a href="#cb187-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1502"><a href="#cb187-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">## `dds_6` - DE: Exercise intervention, mRNA</span></span>
<span id="cb187-1503"><a href="#cb187-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1504"><a href="#cb187-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, dds_6_dta}</span></span>
<span id="cb187-1505"><a href="#cb187-1505" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> cfg_prog<span class="sc">$</span>rna</span>
<span id="cb187-1506"><a href="#cb187-1506" aria-hidden="true" tabindex="-1"></a>ngs_assay <span class="ot">&lt;-</span> <span class="st">"mrna"</span></span>
<span id="cb187-1507"><a href="#cb187-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1508"><a href="#cb187-1508" aria-hidden="true" tabindex="-1"></a>filter_for_paired_visits <span class="ot">&lt;-</span> <span class="cf">function</span>(mae) {</span>
<span id="cb187-1509"><a href="#cb187-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assert_that</span>(<span class="fu">all</span>(<span class="fu">table</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid) <span class="sc">&lt;=</span> <span class="dv">2</span>))</span>
<span id="cb187-1510"><a href="#cb187-1510" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1511"><a href="#cb187-1511" aria-hidden="true" tabindex="-1"></a>  subj <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid)</span>
<span id="cb187-1512"><a href="#cb187-1512" aria-hidden="true" tabindex="-1"></a>  subj <span class="ot">&lt;-</span> <span class="fu">names</span>(subj[subj <span class="sc">==</span> <span class="dv">2</span>])</span>
<span id="cb187-1513"><a href="#cb187-1513" aria-hidden="true" tabindex="-1"></a>  mae <span class="ot">&lt;-</span> mae[, <span class="fu">colData</span>(mae)<span class="sc">$</span>subjid <span class="sc">%in%</span> subj, ]</span>
<span id="cb187-1514"><a href="#cb187-1514" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1515"><a href="#cb187-1515" aria-hidden="true" tabindex="-1"></a>  chk_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">colData</span>(mae))</span>
<span id="cb187-1516"><a href="#cb187-1516" aria-hidden="true" tabindex="-1"></a>  check <span class="ot">&lt;-</span> <span class="fu">split</span>(chk_df, <span class="at">f =</span> chk_df<span class="sc">$</span>avisit)</span>
<span id="cb187-1517"><a href="#cb187-1517" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb187-1518"><a href="#cb187-1518" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Verify the selection:</span></span>
<span id="cb187-1519"><a href="#cb187-1519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assert_that</span>(<span class="fu">all</span>(</span>
<span id="cb187-1520"><a href="#cb187-1520" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(check, <span class="at">subj =</span> subj,\(x, subj) <span class="fu">all</span>(subj <span class="sc">%in%</span> x<span class="sc">$</span>subjid))</span>
<span id="cb187-1521"><a href="#cb187-1521" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb187-1522"><a href="#cb187-1522" aria-hidden="true" tabindex="-1"></a>  mae</span>
<span id="cb187-1523"><a href="#cb187-1523" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-1524"><a href="#cb187-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1525"><a href="#cb187-1525" aria-hidden="true" tabindex="-1"></a>dds_6_fit <span class="ot">&lt;-</span> besd_mae <span class="sc">|&gt;</span></span>
<span id="cb187-1526"><a href="#cb187-1526" aria-hidden="true" tabindex="-1"></a>  (\(mae) mae[ , , ngs_assay])() <span class="sc">|&gt;</span></span>
<span id="cb187-1527"><a href="#cb187-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_depth</span>(ngs_assay, ctrl<span class="sc">$</span>depth_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb187-1528"><a href="#cb187-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_paired_visits</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1529"><a href="#cb187-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_for_low_expr</span>(ngs_assay, ctrl<span class="sc">$</span>cpm_threshold[[ngs_assay]]) <span class="sc">|&gt;</span></span>
<span id="cb187-1530"><a href="#cb187-1530" aria-hidden="true" tabindex="-1"></a>  (\(mae) {</span>
<span id="cb187-1531"><a href="#cb187-1531" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &lt;https://support.bioconductor.org/p/84241/#84296&gt;</span></span>
<span id="cb187-1532"><a href="#cb187-1532" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Or:</span></span>
<span id="cb187-1533"><a href="#cb187-1533" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vignette('DESeq2'),</span></span>
<span id="cb187-1534"><a href="#cb187-1534" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &gt; Section: "Group-specific condition effects, individuals nested</span></span>
<span id="cb187-1535"><a href="#cb187-1535" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &gt; within groups"</span></span>
<span id="cb187-1536"><a href="#cb187-1536" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae) <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(<span class="fu">colData</span>(mae))</span>
<span id="cb187-1537"><a href="#cb187-1537" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae)<span class="sc">$</span>subjid <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>subjid)</span>
<span id="cb187-1538"><a href="#cb187-1538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colData</span>(mae)<span class="sc">$</span>avisit_ <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb187-1539"><a href="#cb187-1539" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colData</span>(mae)<span class="sc">$</span>avisit,</span>
<span id="cb187-1540"><a href="#cb187-1540" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">levels</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>avisit),</span>
<span id="cb187-1541"><a href="#cb187-1541" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">sub</span>(<span class="st">" "</span>, <span class="st">"_"</span>, <span class="fu">levels</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>avisit))</span>
<span id="cb187-1542"><a href="#cb187-1542" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1543"><a href="#cb187-1543" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> <span class="fu">colData</span>(mae)[<span class="fu">c</span>(<span class="st">"diabcd"</span>, <span class="st">"subjid"</span>, <span class="st">"avisit_"</span>)]</span>
<span id="cb187-1544"><a href="#cb187-1544" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1545"><a href="#cb187-1545" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> <span class="fu">do.call</span>(</span>
<span id="cb187-1546"><a href="#cb187-1546" aria-hidden="true" tabindex="-1"></a>      rbind,</span>
<span id="cb187-1547"><a href="#cb187-1547" aria-hidden="true" tabindex="-1"></a>      <span class="fu">by</span>(</span>
<span id="cb187-1548"><a href="#cb187-1548" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> coldata,</span>
<span id="cb187-1549"><a href="#cb187-1549" aria-hidden="true" tabindex="-1"></a>        <span class="at">INDICES =</span> <span class="fu">list</span>(coldata<span class="sc">$</span>diabcd),</span>
<span id="cb187-1550"><a href="#cb187-1550" aria-hidden="true" tabindex="-1"></a>        <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb187-1551"><a href="#cb187-1551" aria-hidden="true" tabindex="-1"></a>          subjid <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x<span class="sc">$</span>subjid)<span class="co"># nolint</span></span>
<span id="cb187-1552"><a href="#cb187-1552" aria-hidden="true" tabindex="-1"></a>          x<span class="sc">$</span>P.n <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="co"># nolint</span></span>
<span id="cb187-1553"><a href="#cb187-1553" aria-hidden="true" tabindex="-1"></a>            subjid,</span>
<span id="cb187-1554"><a href="#cb187-1554" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">levels</span>(subjid),</span>
<span id="cb187-1555"><a href="#cb187-1555" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">"P."</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(subjid))</span>
<span id="cb187-1556"><a href="#cb187-1556" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb187-1557"><a href="#cb187-1557" aria-hidden="true" tabindex="-1"></a>          x[<span class="fu">order</span>(x<span class="sc">$</span>subjid, x<span class="sc">$</span>diabcd), ]</span>
<span id="cb187-1558"><a href="#cb187-1558" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb187-1559"><a href="#cb187-1559" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb187-1560"><a href="#cb187-1560" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1561"><a href="#cb187-1561" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1562"><a href="#cb187-1562" aria-hidden="true" tabindex="-1"></a>    coldata <span class="ot">&lt;-</span> coldata[<span class="fu">rownames</span>(<span class="fu">colData</span>(mae)), ]</span>
<span id="cb187-1563"><a href="#cb187-1563" aria-hidden="true" tabindex="-1"></a>    dsgn <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">model.matrix</span>(</span>
<span id="cb187-1564"><a href="#cb187-1564" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>diabcd <span class="sc">+</span> diabcd<span class="sc">:</span>P.n <span class="sc">+</span> diabcd<span class="sc">:</span>avisit_,</span>
<span id="cb187-1565"><a href="#cb187-1565" aria-hidden="true" tabindex="-1"></a>      coldata</span>
<span id="cb187-1566"><a href="#cb187-1566" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1567"><a href="#cb187-1567" aria-hidden="true" tabindex="-1"></a>    dsgn <span class="ot">&lt;-</span> dsgn[, <span class="fu">colSums</span>(dsgn) <span class="sc">!=</span> <span class="dv">0</span>]</span>
<span id="cb187-1568"><a href="#cb187-1568" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb187-1569"><a href="#cb187-1569" aria-hidden="true" tabindex="-1"></a>    DESeq2<span class="sc">::</span><span class="fu">DESeqDataSetFromMatrix</span>(</span>
<span id="cb187-1570"><a href="#cb187-1570" aria-hidden="true" tabindex="-1"></a>      <span class="at">countData =</span> mae[[ngs_assay]],</span>
<span id="cb187-1571"><a href="#cb187-1571" aria-hidden="true" tabindex="-1"></a>      <span class="at">colData =</span> <span class="fu">colData</span>(<span class="at">x =</span> mae),</span>
<span id="cb187-1572"><a href="#cb187-1572" aria-hidden="true" tabindex="-1"></a>      <span class="at">design =</span> dsgn</span>
<span id="cb187-1573"><a href="#cb187-1573" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1574"><a href="#cb187-1574" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span></span>
<span id="cb187-1575"><a href="#cb187-1575" aria-hidden="true" tabindex="-1"></a>  DESeq2<span class="sc">::</span><span class="fu">DESeq</span>(</span>
<span id="cb187-1576"><a href="#cb187-1576" aria-hidden="true" tabindex="-1"></a>    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb187-1577"><a href="#cb187-1577" aria-hidden="true" tabindex="-1"></a>    <span class="at">BPPARAM =</span> BiocParallel<span class="sc">::</span><span class="fu">bpparam</span>(),</span>
<span id="cb187-1578"><a href="#cb187-1578" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitType =</span> <span class="st">"local"</span>,</span>
<span id="cb187-1579"><a href="#cb187-1579" aria-hidden="true" tabindex="-1"></a>    <span class="at">betaPrior =</span> <span class="cn">FALSE</span></span>
<span id="cb187-1580"><a href="#cb187-1580" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1581"><a href="#cb187-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1582"><a href="#cb187-1582" aria-hidden="true" tabindex="-1"></a>dds_6_est <span class="ot">&lt;-</span></span>
<span id="cb187-1583"><a href="#cb187-1583" aria-hidden="true" tabindex="-1"></a>  dds_6_fit <span class="sc">|&gt;</span></span>
<span id="cb187-1584"><a href="#cb187-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">de_by_name</span>(</span>
<span id="cb187-1585"><a href="#cb187-1585" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb187-1586"><a href="#cb187-1586" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_ngt =</span> <span class="st">"diabcdNGT.avisit_Month_3"</span>,</span>
<span id="cb187-1587"><a href="#cb187-1587" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_igt =</span> <span class="st">"diabcdIGT.avisit_Month_3"</span>,</span>
<span id="cb187-1588"><a href="#cb187-1588" aria-hidden="true" tabindex="-1"></a>      <span class="at">chg_t2d =</span> <span class="st">"diabcdT2D.avisit_Month_3"</span></span>
<span id="cb187-1589"><a href="#cb187-1589" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1590"><a href="#cb187-1590" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1591"><a href="#cb187-1591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(rbind, <span class="at">x =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb187-1592"><a href="#cb187-1592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>(</span>
<span id="cb187-1593"><a href="#cb187-1593" aria-hidden="true" tabindex="-1"></a>    ctrs <span class="ot">&lt;-</span> <span class="fu">factor</span>(ctrs, <span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">"chg"</span>, <span class="fu">c</span>(<span class="st">"NGT"</span>, <span class="st">"IGT"</span>, <span class="st">"T2D"</span>)))</span>
<span id="cb187-1594"><a href="#cb187-1594" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1595"><a href="#cb187-1595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">within</span>({</span>
<span id="cb187-1596"><a href="#cb187-1596" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(lfcSE) <span class="ot">&lt;-</span> <span class="st">"Log Fold Change Standard Error"</span></span>
<span id="cb187-1597"><a href="#cb187-1597" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(ctrs) <span class="ot">&lt;-</span> <span class="st">"Contrast"</span></span>
<span id="cb187-1598"><a href="#cb187-1598" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(padj) <span class="ot">&lt;-</span> <span class="st">"Adjusted p.value (False-Discovery Rate)"</span></span>
<span id="cb187-1599"><a href="#cb187-1599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">label_xp</span>(log_padj) <span class="ot">&lt;-</span> <span class="st">"-1 * log10(padj)"</span></span>
<span id="cb187-1600"><a href="#cb187-1600" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb187-1601"><a href="#cb187-1601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1602"><a href="#cb187-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1603"><a href="#cb187-1603" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 11</span></span>
<span id="cb187-1604"><a href="#cb187-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1605"><a href="#cb187-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_11}</span></span>
<span id="cb187-1606"><a href="#cb187-1606" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1607"><a href="#cb187-1607" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_6_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1608"><a href="#cb187-1608" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1609"><a href="#cb187-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1610"><a href="#cb187-1610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1611"><a href="#cb187-1611" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1612"><a href="#cb187-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1613"><a href="#cb187-1613" aria-hidden="true" tabindex="-1"></a>dds_6_gg <span class="ot">&lt;-</span></span>
<span id="cb187-1614"><a href="#cb187-1614" aria-hidden="true" tabindex="-1"></a>  dds_6_est <span class="sc">|&gt;</span></span>
<span id="cb187-1615"><a href="#cb187-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(log2FoldChange, log_padj, <span class="at">fill =</span> <span class="fu">log10</span>(..count..))) <span class="sc">+</span></span>
<span id="cb187-1616"><a href="#cb187-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1617"><a href="#cb187-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1618"><a href="#cb187-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1619"><a href="#cb187-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>() <span class="sc">+</span></span>
<span id="cb187-1620"><a href="#cb187-1620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1621"><a href="#cb187-1621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1622"><a href="#cb187-1622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> ctrs) <span class="sc">+</span></span>
<span id="cb187-1623"><a href="#cb187-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1624"><a href="#cb187-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1625"><a href="#cb187-1625" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1626"><a href="#cb187-1626" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1627"><a href="#cb187-1627" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1628"><a href="#cb187-1628" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1629"><a href="#cb187-1629" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1630"><a href="#cb187-1630" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1631"><a href="#cb187-1631" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1632"><a href="#cb187-1632" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1633"><a href="#cb187-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1634"><a href="#cb187-1634" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1635"><a href="#cb187-1635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1636"><a href="#cb187-1636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1637"><a href="#cb187-1637" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1638"><a href="#cb187-1638" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.11"</span>,</span>
<span id="cb187-1639"><a href="#cb187-1639" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1640"><a href="#cb187-1640" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span id="cb187-1641"><a href="#cb187-1641" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among mRNA in response to the exercise</span></span>
<span id="cb187-1642"><a href="#cb187-1642" aria-hidden="true" tabindex="-1"></a><span class="st">        intervention (CHG)"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1643"><a href="#cb187-1643" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1644"><a href="#cb187-1644" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1645"><a href="#cb187-1645" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1646"><a href="#cb187-1646" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1647"><a href="#cb187-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_6_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1648"><a href="#cb187-1648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1649"><a href="#cb187-1649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1650"><a href="#cb187-1650" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1651"><a href="#cb187-1651" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1652"><a href="#cb187-1652" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1653"><a href="#cb187-1653" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1654"><a href="#cb187-1654" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1655"><a href="#cb187-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1656"><a href="#cb187-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1657"><a href="#cb187-1657" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1658"><a href="#cb187-1658" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_11.pdf"</span>),</span>
<span id="cb187-1659"><a href="#cb187-1659" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_11_af.pdf"</span>)</span>
<span id="cb187-1660"><a href="#cb187-1660" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1661"><a href="#cb187-1661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1662"><a href="#cb187-1662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1663"><a href="#cb187-1663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_11_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1664"><a href="#cb187-1664" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1665"><a href="#cb187-1665" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1666"><a href="#cb187-1666" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1667"><a href="#cb187-1667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1668"><a href="#cb187-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1669"><a href="#cb187-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_11_xlsx}</span></span>
<span id="cb187-1670"><a href="#cb187-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">export_xl</span>(</span>
<span id="cb187-1671"><a href="#cb187-1671" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_07_11 =</span> dds_6_est,</span>
<span id="cb187-1672"><a href="#cb187-1672" aria-hidden="true" tabindex="-1"></a>  <span class="at">info =</span> <span class="fu">c</span>(</span>
<span id="cb187-1673"><a href="#cb187-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(</span>
<span id="cb187-1674"><a href="#cb187-1674" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mRNA Change from Baseline - differential expression by diabetes"</span>,</span>
<span id="cb187-1675"><a href="#cb187-1675" aria-hidden="true" tabindex="-1"></a>      <span class="st">"group"</span></span>
<span id="cb187-1676"><a href="#cb187-1676" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1677"><a href="#cb187-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="st">"UMB-BESD"</span></span>
<span id="cb187-1678"><a href="#cb187-1678" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb187-1679"><a href="#cb187-1679" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir =</span> cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh,</span>
<span id="cb187-1680"><a href="#cb187-1680" aria-hidden="true" tabindex="-1"></a>  <span class="at">basenm =</span> <span class="st">"fig_07_11"</span></span>
<span id="cb187-1681"><a href="#cb187-1681" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1682"><a href="#cb187-1682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1683"><a href="#cb187-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1684"><a href="#cb187-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fig 07 12</span></span>
<span id="cb187-1685"><a href="#cb187-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1686"><a href="#cb187-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_12}</span></span>
<span id="cb187-1687"><a href="#cb187-1687" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.001</span>)</span>
<span id="cb187-1688"><a href="#cb187-1688" aria-hidden="true" tabindex="-1"></a>log_adj <span class="ot">&lt;-</span> <span class="fu">pretty</span>(dds_6_est<span class="sc">$</span>log_padj)</span>
<span id="cb187-1689"><a href="#cb187-1689" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="fu">setNames</span>(</span>
<span id="cb187-1690"><a href="#cb187-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">log10</span>(pval)),</span>
<span id="cb187-1691"><a href="#cb187-1691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(log_adj, <span class="fu">paste0</span>(<span class="st">"padj="</span>, pval))</span>
<span id="cb187-1692"><a href="#cb187-1692" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1693"><a href="#cb187-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1694"><a href="#cb187-1694" aria-hidden="true" tabindex="-1"></a>dds_6_est<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ENSG0+"</span>, <span class="st">""</span>, dds_6_est<span class="sc">$</span>feature)</span>
<span id="cb187-1695"><a href="#cb187-1695" aria-hidden="true" tabindex="-1"></a>dds_6_est<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">substr</span>(dds_6_est<span class="sc">$</span>feature, <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="dv">7</span>)</span>
<span id="cb187-1696"><a href="#cb187-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1697"><a href="#cb187-1697" aria-hidden="true" tabindex="-1"></a>dds_6_txt <span class="ot">&lt;-</span> <span class="fu">subset</span>(dds_6_est, padj <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(log2FoldChange) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb187-1698"><a href="#cb187-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1699"><a href="#cb187-1699" aria-hidden="true" tabindex="-1"></a>dds_6_gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb187-1700"><a href="#cb187-1700" aria-hidden="true" tabindex="-1"></a>  dds_6_est,</span>
<span id="cb187-1701"><a href="#cb187-1701" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> log2FoldChange, <span class="at">y =</span> log_padj, <span class="at">col =</span> type)</span>
<span id="cb187-1702"><a href="#cb187-1702" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb187-1703"><a href="#cb187-1703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb187-1704"><a href="#cb187-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2-fold-change"</span>) <span class="sc">+</span></span>
<span id="cb187-1705"><a href="#cb187-1705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">%*%</span> <span class="fu">log10</span>(padj))) <span class="sc">+</span></span>
<span id="cb187-1706"><a href="#cb187-1706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_bin_hex</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">log10</span>(..count..)), <span class="at">color =</span> <span class="st">"transparent"</span>) <span class="sc">+</span></span>
<span id="cb187-1707"><a href="#cb187-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dds_6_txt, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">shape =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-1708"><a href="#cb187-1708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb187-1709"><a href="#cb187-1709" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dds_6_txt,</span>
<span id="cb187-1710"><a href="#cb187-1710" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb187-1711"><a href="#cb187-1711" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb187-1712"><a href="#cb187-1712" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb187-1713"><a href="#cb187-1713" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb187-1714"><a href="#cb187-1714" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb187-1715"><a href="#cb187-1715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"black"</span>, <span class="at">high =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb187-1716"><a href="#cb187-1716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF5003"</span>, <span class="st">"#003F7D"</span>)) <span class="sc">+</span></span>
<span id="cb187-1717"><a href="#cb187-1717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> brk) <span class="sc">+</span></span>
<span id="cb187-1718"><a href="#cb187-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> ctrs, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-1719"><a href="#cb187-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb187-1720"><a href="#cb187-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-1721"><a href="#cb187-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-1722"><a href="#cb187-1722" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1723"><a href="#cb187-1723" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb187-1724"><a href="#cb187-1724" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb187-1725"><a href="#cb187-1725" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1726"><a href="#cb187-1726" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb187-1727"><a href="#cb187-1727" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb187-1728"><a href="#cb187-1728" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-1729"><a href="#cb187-1729" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1730"><a href="#cb187-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1731"><a href="#cb187-1731" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">clean_slate</span>() <span class="sc">|&gt;</span></span>
<span id="cb187-1732"><a href="#cb187-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header</span>(<span class="fu">c</span>(<span class="st">"FCA Collin"</span>, <span class="st">"UMB BESD"</span>), <span class="fu">c</span>(<span class="st">"Confidential"</span>, <span class="st">"Draft"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1733"><a href="#cb187-1733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_title</span>(</span>
<span id="cb187-1734"><a href="#cb187-1734" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1735"><a href="#cb187-1735" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Figure 7.12"</span>,</span>
<span id="cb187-1736"><a href="#cb187-1736" aria-hidden="true" tabindex="-1"></a>      <span class="fu">strwrap</span>(</span>
<span id="cb187-1737"><a href="#cb187-1737" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Volcano plot - Size and Significance of Differential</span></span>
<span id="cb187-1738"><a href="#cb187-1738" aria-hidden="true" tabindex="-1"></a><span class="st">        Expression among mRNA in response to the exercise</span></span>
<span id="cb187-1739"><a href="#cb187-1739" aria-hidden="true" tabindex="-1"></a><span class="st">        intervention (CHG)"</span>, <span class="at">width =</span> <span class="dv">80</span></span>
<span id="cb187-1740"><a href="#cb187-1740" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb187-1741"><a href="#cb187-1741" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Analysis Set: Full Analysis Set"</span></span>
<span id="cb187-1742"><a href="#cb187-1742" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb187-1743"><a href="#cb187-1743" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb187-1744"><a href="#cb187-1744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_figure</span>(dds_6_gg, <span class="at">height =</span> <span class="fu">inches</span>(<span class="dv">3</span>), <span class="at">width =</span> <span class="fu">inches</span>(<span class="dv">6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb187-1745"><a href="#cb187-1745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer</span>(</span>
<span id="cb187-1746"><a href="#cb187-1746" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb187-1747"><a href="#cb187-1747" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Program t2d_07_mir / Env ayup_dbs:v0.1.0-alpha"</span>,</span>
<span id="cb187-1748"><a href="#cb187-1748" aria-hidden="true" tabindex="-1"></a>      <span class="fu">format</span>(<span class="fu">Sys.time</span>(), <span class="at">format =</span> <span class="st">"%Y-%m-%d %H:%M (%Z)"</span>)</span>
<span id="cb187-1749"><a href="#cb187-1749" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb187-1750"><a href="#cb187-1750" aria-hidden="true" tabindex="-1"></a>    cfg_prog<span class="sc">$</span>version</span>
<span id="cb187-1751"><a href="#cb187-1751" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb187-1752"><a href="#cb187-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1753"><a href="#cb187-1753" aria-hidden="true" tabindex="-1"></a><span class="fu">export_as</span>(</span>
<span id="cb187-1754"><a href="#cb187-1754" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb187-1755"><a href="#cb187-1755" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_12.pdf"</span>),</span>
<span id="cb187-1756"><a href="#cb187-1756" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_graph_alone =</span> <span class="fu">file.path</span>(cfg_prog<span class="sc">$</span>paths<span class="sc">$</span>grh, <span class="st">"fig_07_12_af.pdf"</span>)</span>
<span id="cb187-1757"><a href="#cb187-1757" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb187-1758"><a href="#cb187-1758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1759"><a href="#cb187-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1760"><a href="#cb187-1760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f07_12_sh, eval=cfg_prog$knitr$results!="hide"}</span></span>
<span id="cb187-1761"><a href="#cb187-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8.3</span></span>
<span id="cb187-1762"><a href="#cb187-1762" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 11.7</span></span>
<span id="cb187-1763"><a href="#cb187-1763" aria-hidden="true" tabindex="-1"></a><span class="fu">show_slate</span>(p)</span>
<span id="cb187-1764"><a href="#cb187-1764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1765"><a href="#cb187-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1766"><a href="#cb187-1766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, clean_dds_6}</span></span>
<span id="cb187-1767"><a href="#cb187-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(ctrl, ngs_assay, dds_6_fit, pval, log_adj, brk, dds_6_gg, p)</span>
<span id="cb187-1768"><a href="#cb187-1768" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb187-1769"><a href="#cb187-1769" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb187-1770"><a href="#cb187-1770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb187-1771"><a href="#cb187-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1772"><a href="#cb187-1772" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Informations</span></span>
<span id="cb187-1773"><a href="#cb187-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-1776"><a href="#cb187-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb187-1777"><a href="#cb187-1777" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb187-1778"><a href="#cb187-1778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
      <div class="nav-footer-center">Copyright 2022, FCA Collin, Ph.D.</div>
  </div>
</footer>


</body></html>